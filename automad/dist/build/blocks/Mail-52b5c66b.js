/* Automad, (c) Marc Anton Dahmen, MIT license */
var u=(s,e=[],t={},r=null,o=null,n=!1)=>{let a=document.createElement(s);e.forEach(l=>{a.classList.add(l)});for(let[l,d]of Object.entries(t))typeof d<"u"&&a.setAttribute(l,d);return r&&(n?r.prepend(a):r.appendChild(a)),o&&(a.innerHTML=o),a};var i=(s,e=document)=>e.querySelector(s),m=(s,e=document)=>Array.from(e.querySelectorAll(s));var p={message:"am-message",validate:"am-validate"},g=s=>{let e=!0;return s.forEach(t=>{t.checkValidity()||(e=!1)}),e},h=s=>{s.forEach(e=>{e.value=""})},c=class{element;constructor(e){this.element=e,setTimeout(this.init.bind(this),2e3)}init(){let e=i("button",this.element),t=m("[name]",this.element);e.addEventListener("click",async()=>{if(this.element.classList.add(p.validate),!!g(t))try{let r=await fetch(window.location.href,{method:"POST",body:this.getData(t)}),{data:o}=await r.json();if(o.status){let n=i("p",this.element)??u("p",[p.message],{},this.element,"",!0);n.textContent=o.status,h(t),this.element.classList.remove(p.validate)}}catch{}})}getData(e){let t=new FormData;return e.forEach(r=>{t.append(r.name,r.value)}),t.append("id",this.element.id),t}};export{c as default};

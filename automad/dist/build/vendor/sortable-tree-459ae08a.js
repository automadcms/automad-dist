/* This file is part of Automad. Copyright and license info at the end. */
var ee=Object.create;var I=Object.defineProperty;var te=Object.getOwnPropertyDescriptor;var ne=Object.getOwnPropertyNames;var oe=Object.getPrototypeOf,se=Object.prototype.hasOwnProperty;var re=(u,d)=>()=>(d||u((d={exports:{}}).exports,d),d.exports);var ie=(u,d,g,T)=>{if(d&&typeof d=="object"||typeof d=="function")for(let m of ne(d))!se.call(u,m)&&m!==g&&I(u,m,{get:()=>d[m],enumerable:!(T=te(d,m))||T.enumerable});return u};var ae=(u,d,g)=>(g=u!=null?ee(oe(u)):{},ie(d||!u||!u.__esModule?I(g,"default",{value:u,enumerable:!0}):g,u));var j=re((N,w)=>{(function(u,d){typeof N=="object"&&typeof w=="object"?w.exports=d():typeof define=="function"&&define.amd?define([],d):typeof N=="object"?N.SortableTree=d():u.SortableTree=d()})(self,(()=>(()=>{"use strict";var u={d:(n,e)=>{for(var t in e)u.o(e,t)&&!u.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},o:(n,e)=>Object.prototype.hasOwnProperty.call(n,e)},d={};u.d(d,{default:()=>Q});var g=function(n,e,t,o){return new(t||(t=Promise))((function(s,i){function a(r){try{c(o.next(r))}catch(l){i(l)}}function h(r){try{c(o.throw(r))}catch(l){i(l)}}function c(r){var l;r.done?s(r.value):(l=r.value,l instanceof t?l:new t((function(v){v(l)}))).then(a,h)}c((o=o.apply(n,e||[])).next())}))};let T=n=>`<span>${n.title}</span>`,m={collapsed:`
		<svg
		xmlns="http://www.w3.org/2000/svg" 
		width="1em" 
		height="1em" 
		fill="currentColor" 
		class="bi bi-caret-right-fill" 
		viewBox="0 0 16 16">
			<path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/>
		</svg>`,open:`
		<svg 
		xmlns="http://www.w3.org/2000/svg" 
		width="1em" 
		height="1em" 
		fill="currentColor" 
		class="bi bi-caret-down-fill" 
		viewBox="0 0 16 16">
			<path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
		</svg>
	`},k={tree:"tree",node:"tree__node",nodeHover:"tree__node--hover",nodeDragging:"tree__node--dragging",nodeDropBefore:"tree__node--drop-before",nodeDropInside:"tree__node--drop-inside",nodeDropAfter:"tree__node--drop-after",label:"tree__label",subnodes:"tree__subnodes",collapse:"tree__collapse"},P=({nodes:n,movedNode:e,srcParentNode:t,targetParentNode:o})=>g(void 0,void 0,void 0,(function*(){})),G=(n,e)=>g(void 0,void 0,void 0,(function*(){})),H=(n,e)=>g(void 0,void 0,void 0,(function*(){return!0})),_=(n,e=[],t=null)=>{let o=document.createElement(n);return e.forEach((s=>{o.classList.add(s)})),t&&t.appendChild(o),o},V=()=>((n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))();class p extends HTMLElement{static create({data:e,renderLabel:t,icons:o,styles:s,parent:i,onClick:a,draggable:h,eventBus:c}){let r=_(p.TAG_NAME,[s.node],i),l=_("div",[s.label],r),v=_("div",[s.subnodes],r),E=_("span",[s.collapse],r);return l.innerHTML=t(e),E.innerHTML=o.collapsed,c.listen(E,"click",r.toggle.bind(r)),c.listen(l,"click",(S=>{a(S,r)})),h&&r.setAttribute("draggable","true"),r._data=e,r._icons=o,r._label=l,r._nodes=v,r._collapseButton=E,r}get data(){return this._data}get label(){return this._label}get subnodes(){return this._nodes}get subnodesData(){let e=[];return Array.from(this._nodes.children).forEach((t=>{e.push(t.data)})),e}get id(){return this._id}constructor(){super(),this._id=V()}collapse(e){e?(this.removeAttribute("open"),this._collapseButton.innerHTML=this._icons.collapsed):(this.setAttribute("open","true"),this._collapseButton.innerHTML=this._icons.open)}toggle(){this.collapse(this.hasAttribute("open"))}reveal(){((e,t)=>{let o=[],s=t.closest(e);for(;s!==null;)o.push(s),s=s.parentNode.closest(e);return o})(p.TAG_NAME,this).forEach((e=>{e.collapse(!1)}))}}p.TAG_NAME="sortable-tree-node";var $=function(n,e,t,o){return new(t||(t=Promise))((function(s,i){function a(r){try{c(o.next(r))}catch(l){i(l)}}function h(r){try{c(o.throw(r))}catch(l){i(l)}}function c(r){var l;r.done?s(r.value):(l=r.value,l instanceof t?l:new t((function(v){v(l)}))).then(a,h)}c((o=o.apply(n,e||[])).next())}))},f;(function(n){n.BEFORE="BEFORE",n.INSIDE="INSIDE",n.AFTER="AFTER"})(f||(f={}));let B=n=>{let e=n.clientY,t=y(n).label.getBoundingClientRect(),o=Math.round(t.height/4);return t.top+o>e?f.BEFORE:t.bottom-o<e?f.AFTER:f.INSIDE},y=n=>n.target.closest(p.TAG_NAME),O=n=>{let e=n?.parentElement.parentElement;return e?.tagName.toLowerCase()!==p.TAG_NAME?null:e},L=(n,e)=>{y(n).classList.remove(e.styles.nodeDropAfter,e.styles.nodeDropBefore,e.styles.nodeDropInside)},z=(n,e)=>{n.stopPropagation();let t=n.target;t.tagName.toLowerCase()===p.TAG_NAME&&(n.dataTransfer.setData("text",t.id),n.dataTransfer.effectAllowed="move",t.classList.add(e.styles.nodeDragging))},J=(n,e)=>$(void 0,void 0,void 0,(function*(){n.stopPropagation(),n.preventDefault(),L(n,e);let t=y(n);if(!t)return!1;let o=O(t),s=n.dataTransfer.getData("text"),i=B(n),a=e.getNode(s);if(!a||a?.contains(t))return!1;let h=O(a);if(e.lockRootLevel&&!t?.parentElement.closest(p.TAG_NAME)&&(i===f.BEFORE||i===f.AFTER))return!1;if(i===f.BEFORE)return!!(yield e.confirm(a,o))&&(t.parentNode.insertBefore(a,t),e.onDrop(a,h,o),!1);if(i===f.AFTER){if(!(yield e.confirm(a,o)))return!1;let c=t.nextElementSibling;return c?(t.parentNode.insertBefore(a,c),e.onDrop(a,h,o)):(t.parentNode.appendChild(a),e.onDrop(a,h,o)),!1}return!!(yield e.confirm(a,t))&&(t.subnodes.appendChild(a),e.onDrop(a,h,t),!1)})),U=(n,e)=>{n.preventDefault(),n.dataTransfer.dropEffect="move",((t,o)=>{let s=y(t),i=B(t);s.classList.toggle(o.styles.nodeDropBefore,i===f.BEFORE),s.classList.toggle(o.styles.nodeDropInside,i===f.INSIDE),s.classList.toggle(o.styles.nodeDropAfter,i===f.AFTER)})(n,e)},q=(n,e)=>{L(n,e)},K=(n,e)=>{n.target.classList.remove(e.styles.nodeDragging),L(n,e)};class Y{constructor(){this.listeners=[]}listen(e,t,o){e.addEventListener(t,o,!1),this.listeners.push({element:e,eventName:t,handler:o})}clear(){this.listeners.forEach((({element:e,eventName:t,handler:o})=>{e.removeEventListener(t,o)})),this.listeners=[]}}let R=n=>`sortableTreeState-${n.replace(/[^\w]+/,"-")}`,Q=class{constructor({nodes:n,element:e,renderLabel:t,icons:o,styles:s,lockRootLevel:i,onChange:a,onClick:h,initCollapseLevel:c,confirm:r,disableSorting:l,stateId:v}){this.nodeCollection={},n&&(e?(this.defineElements(),this.eventBus=new Y,this.root=e,this.icons=Object.assign(Object.assign({},m),o),this.styles=Object.assign(Object.assign({},k),s),this.renderLabel=t||T,this.lockRootLevel=i===void 0||i,this.onChange=a||P,this.onClick=h||G,this.confirm=r||H,this.initCollapseLevel=c===void 0?2:c,this.disableSorting=l||!1,e.classList.add(this.styles.tree),this.render({nodes:n,element:e}),v&&(((E,S)=>{let M=sessionStorage.getItem(R(E));if(!M)return;let W=JSON.parse(M),F=(A,D)=>{let[X,C]=D;A.element.collapse(X===0),C&&A.subnodes.forEach(((Z,x)=>{C[x]!==void 0&&F(Z,C[x])}))};S.forEach(((A,D)=>{F(A,W[D])}))})(v,this.parseTree(this.root)),this.initStateObserver(v))):console.error('Error: "element" is not a valid HTML element!'))}getNode(n){return this.nodeCollection[n]}findNode(n,e){let t=Object.values(this.nodeCollection);for(let o=0;o<t.length;o++){let s=t[o],i=s.data;if(n in i&&i[n]==e)return s}return null}onDrop(n,e,t){let o={nodes:this.parseTree(this.root),movedNode:n,srcParentNode:e,targetParentNode:t};t?.collapse(!1),this.onChange(o)}destroy(){var n;this.eventBus.clear(),(n=this.observer)===null||n===void 0||n.disconnect(),this.observer=null}initStateObserver(n){this.observer=new MutationObserver((()=>{((e,t)=>{let o=[],s=i=>{let a=[],h=[i.element.getAttribute("open")?1:0,a];return i.subnodes.forEach((c=>{a.push(s(c))})),h};t.forEach((i=>{o.push(s(i))})),sessionStorage.setItem(R(e),JSON.stringify(o))})(n,this.parseTree(this.root))})),this.observer.observe(this.root,{childList:!0,attributes:!0,subtree:!0})}defineElements(){try{customElements.define(p.TAG_NAME,p)}catch{}}render({nodes:n,element:e},t=0){t++,n.forEach((o=>{let s=p.create({icons:this.icons,styles:this.styles,parent:e,renderLabel:this.renderLabel,data:o.data,onClick:this.onClick,draggable:!this.disableSorting,eventBus:this.eventBus});this.disableSorting||((i,a)=>{let h={dragstart:z,drop:J,dragover:U,dragend:K,dragleave:q};for(let[c,r]of Object.entries(h))a.eventBus.listen(i,c,(l=>{r(l,a)}))})(s,this),s.collapse(t>this.initCollapseLevel),this.nodeCollection[s.id]=s,o.nodes&&this.render({nodes:o.nodes,element:s.subnodes},t)}))}parseTree(n){let e=Array.from(n.querySelectorAll(`:scope > ${p.TAG_NAME}`)),t=[];return e.forEach((o=>{t.push({element:o,id:o.id,subnodes:this.parseTree(o.subnodes)})})),t}};return d=d.default})()))});var b=ae(j(),1);var export_SortableTree=b.default;var export_SortableTreeConfirmFunction=b.SortableTreeConfirmFunction;var export_SortableTreeDropResultData=b.SortableTreeDropResultData;var export_SortableTreeKeyValue=b.SortableTreeKeyValue;var export_SortableTreeNodeComponent=b.SortableTreeNodeComponent;var export_SortableTreeNodeData=b.SortableTreeNodeData;var export_SortableTreeOnChangeFunction=b.SortableTreeOnChangeFunction;var export_SortableTreeRenderLabelFunction=b.SortableTreeRenderLabelFunction;var export_SortableTreeStyles=b.SortableTreeStyles;export{export_SortableTree as SortableTree,export_SortableTreeConfirmFunction as SortableTreeConfirmFunction,export_SortableTreeDropResultData as SortableTreeDropResultData,export_SortableTreeKeyValue as SortableTreeKeyValue,export_SortableTreeNodeComponent as SortableTreeNodeComponent,export_SortableTreeNodeData as SortableTreeNodeData,export_SortableTreeOnChangeFunction as SortableTreeOnChangeFunction,export_SortableTreeRenderLabelFunction as SortableTreeRenderLabelFunction,export_SortableTreeStyles as SortableTreeStyles};
/*! Bundled license information:

sortable-tree/dist/sortable-tree.js:
  (*! Sortable Tree 0.7.4, (c) 2025 Marc Anton Dahmen, MIT license *)
*/

/* Automad 2.0.0-alpha.47, (c) 2025 Marc Anton Dahmen, MIT license */
import{G as A,I as k,M as u,S as y,a as c,e as v,ea as h,k as C}from"./chunk.ETUXSY6N.js";import{a,d as $,f as g}from"./chunk.TNS2LIBN.js";import"./chunk.44XCHEAG.js";import"./chunk.EPACJLJA.js";var E=o=>o.reduce((t,e)=>u`${t} <div class="${"am-c-card__list-item"} ${"am-u-flex"} ${"am-u-flex--column"} ${"am-u-flex--gap"}" ><span><span class="${"am-e-badge"}"> ${A(e.field)}</span></span><span>${e.context}</span></div>`,""),H=o=>{let{path:t,fieldResultsArray:e,url:s}=o,l=e.reduce((r,n)=>r.concat([n.field]),[]);return u`<div class="${"am-c-card"}"><div class="${"am-c-card__list"}"><div class="${"am-c-card__list-item"} ${"am-c-card__list-item--faded"} ${"am-u-flex"} ${"am-u-flex--between"} ${"am-u-flex--align-center"}" ><am-link ${"am-target"}="${t?`page?url=${s}`:"shared"}" class="${"am-c-icon-text"} ${"am-u-text-link"}" ><i class="bi bi-file-earmark-text"></i><span>${s||c.text("sharedTitle")}</span></am-link><am-checkbox name="${t}" value="${l.join()}" ></am-checkbox></div>${E(e)}</div></div>`},m=class o extends C{static{this.SEARCH_PARAM="search"}get api(){return"SearchController::searchReplace"}connectedCallback(){this.classList.add("am-u-flex","am-u-flex--gap-large","am-u-flex--column");let t=a("section",["am-u-flex","am-u-flex--column","am-u-flex--gap"],{},this),{searchBar:e,search:s,isRegex:l,isCaseSensitive:r,replace:n}=this.createForm(t),{replaceButton:S,checkAll:L,unCheckAll:M}=this.createButtons(t),d=a("section",["am-u-flex","am-u-flex--column","am-u-flex--gap-large"],{},this),x=async(i={})=>{let p=Object.assign({searchValue:s.value,isRegex:l.checked,isCaseSensitive:r.checked},i),F=await y(this.api,p);this.createResults(F,d)},f=$(async()=>{let i=new URL(window.location.href);i.searchParams.set(o.SEARCH_PARAM,s.value),window.history.replaceState(null,null,i),x()},200),b=()=>{let i=JSON.stringify(k(d));x({replaceValue:n.value,replaceSelected:!0,files:i})};this.listen(e,"input",f,"input"),this.listen(S,"click",b);let R=i=>{g("input",d).forEach(p=>{p.checked=i,v("input",p)})};this.listen(L,"click",()=>{R(!0)}),this.listen(M,"click",()=>{R(!1)}),f()}createResults(t,e){let s=t.data;if(s.length){e.innerHTML=s.reduce((l,r)=>u`${l} ${H(r)}`,"");return}e.innerHTML=h(o.SEARCH_PARAM)?u`<am-alert ${"am-icon"}="slash-circle" ${"am-text"}="searchNoResults" ></am-alert>`:""}createForm(t){let e=a("div",["am-u-flex","am-u-flex--gap"],{},t),s=a("input",["am-f-input"],{type:"text",name:"searchValue",value:h(o.SEARCH_PARAM),placeholder:c.text("searchPlaceholder")},e),l=a("am-custom-icon-checkbox",[],{name:"isRegex","am-icon":"regex","am-tooltip":c.text("searchIsRegex")},e),r=a("am-custom-icon-checkbox",[],{name:"isCaseSensitive","am-icon":"type","am-tooltip":c.text("searchIsCaseSensitive")},e),n=a("input",["am-f-input"],{type:"text",name:"replaceValue",placeholder:c.text("searchReplacePlaceholder")},t);return{searchBar:e,search:s,isRegex:l,isCaseSensitive:r,replace:n}}createButtons(t){let e=a("div",["am-u-flex","am-u-flex--between"],{},t),s=a("span",["am-e-button","am-e-button--primary"],{},e);s.textContent=c.text("searchReplaceSelected");let l=a("div",["am-f-group"],{},e),r=a("span",["am-e-button","am-f-group__item"],{},l);r.textContent=c.text("searchReplaceCheckAll");let n=a("span",["am-e-button","am-f-group__item"],{},l);return n.textContent=c.text("searchReplaceUncheckAll"),{replaceButton:s,checkAll:r,unCheckAll:n}}};customElements.define("am-search-form",m);export{m as SearchFormComponent};

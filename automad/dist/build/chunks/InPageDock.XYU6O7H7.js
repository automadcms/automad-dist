/* Automad, (c) Marc Anton Dahmen, MIT license */
import{b as H,c as w,d as W,e as A}from"./chunk.GF54AINL.js";import{a as M}from"./chunk.AY5SKHU3.js";import{a as P}from"./chunk.SQMRGQ3J.js";import{a as D,c as Y}from"./chunk.2NNYUVDG.js";var I=D((F,S)=>{(function(g,h){typeof S=="object"&&S.exports?S.exports=h():g.getSize=h()})(window,function(){function h(r){let s=parseFloat(r);return r.indexOf("%")==-1&&!isNaN(s)&&s}let a=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],l=a.length;function e(){let r={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0};return a.forEach(s=>{r[s]=0}),r}function c(r){if(typeof r=="string"&&(r=document.querySelector(r)),!(r&&typeof r=="object"&&r.nodeType))return;let E=getComputedStyle(r);if(E.display=="none")return e();let t={};t.width=r.offsetWidth,t.height=r.offsetHeight;let n=t.isBorderBox=E.boxSizing=="border-box";a.forEach(y=>{let v=E[y],x=parseFloat(v);t[y]=isNaN(x)?0:x});let d=t.paddingLeft+t.paddingRight,b=t.paddingTop+t.paddingBottom,i=t.marginLeft+t.marginRight,o=t.marginTop+t.marginBottom,u=t.borderLeftWidth+t.borderRightWidth,f=t.borderTopWidth+t.borderBottomWidth,p=h(E.width);p!==!1&&(t.width=p+(n?0:d+u));let m=h(E.height);return m!==!1&&(t.height=m+(n?0:b+f)),t.innerWidth=t.width-(d+u),t.innerHeight=t.height-(b+f),t.outerWidth=t.width+i,t.outerHeight=t.height+o,t}return c})});var R=D((U,_)=>{(function(g,h){typeof _=="object"&&_.exports?_.exports=h():g.EvEmitter=h()})(typeof window<"u"?window:U,function(){function g(){}let h=g.prototype;return h.on=function(a,l){if(!a||!l)return this;let e=this._events=this._events||{},c=e[a]=e[a]||[];return c.includes(l)||c.push(l),this},h.once=function(a,l){if(!a||!l)return this;this.on(a,l);let e=this._onceEvents=this._onceEvents||{},c=e[a]=e[a]||{};return c[l]=!0,this},h.off=function(a,l){let e=this._events&&this._events[a];if(!e||!e.length)return this;let c=e.indexOf(l);return c!=-1&&e.splice(c,1),this},h.emitEvent=function(a,l){let e=this._events&&this._events[a];if(!e||!e.length)return this;e=e.slice(0),l=l||[];let c=this._onceEvents&&this._onceEvents[a];for(let r of e)c&&c[r]&&(this.off(a,r),delete c[r]),r.apply(this,l);return this},h.allOff=function(){return delete this._events,delete this._onceEvents,this},g})});var B=D(($,T)=>{(function(g,h){typeof T=="object"&&T.exports?T.exports=h(g,R()):g.Unidragger=h(g,g.EvEmitter)})(typeof window<"u"?window:$,function(h,a){function l(){}let e=l.prototype=Object.create(a.prototype);e.handleEvent=function(t){let n="on"+t.type;this[n]&&this[n](t)};let c,r;"ontouchstart"in h?(c="touchstart",r=["touchmove","touchend","touchcancel"]):h.PointerEvent?(c="pointerdown",r=["pointermove","pointerup","pointercancel"]):(c="mousedown",r=["mousemove","mouseup"]),e.touchActionValue="none",e.bindHandles=function(){this._bindHandles("addEventListener",this.touchActionValue)},e.unbindHandles=function(){this._bindHandles("removeEventListener","")},e._bindHandles=function(t,n){this.handles.forEach(d=>{d[t](c,this),d[t]("click",this),h.PointerEvent&&(d.style.touchAction=n)})},e.bindActivePointerEvents=function(){r.forEach(t=>{h.addEventListener(t,this)})},e.unbindActivePointerEvents=function(){r.forEach(t=>{h.removeEventListener(t,this)})},e.withPointer=function(t,n){n.pointerId===this.pointerIdentifier&&this[t](n,n)},e.withTouch=function(t,n){let d;for(let b of n.changedTouches)b.identifier===this.pointerIdentifier&&(d=b);d&&this[t](n,d)},e.onmousedown=function(t){this.pointerDown(t,t)},e.ontouchstart=function(t){this.pointerDown(t,t.changedTouches[0])},e.onpointerdown=function(t){this.pointerDown(t,t)};let s=["TEXTAREA","INPUT","SELECT","OPTION"],E=["radio","checkbox","button","submit","image","file"];return e.pointerDown=function(t,n){let d=s.includes(t.target.nodeName),b=E.includes(t.target.type),i=!d||b;!this.isPointerDown&&!t.button&&i&&(this.isPointerDown=!0,this.pointerIdentifier=n.pointerId!==void 0?n.pointerId:n.identifier,this.pointerDownPointer={pageX:n.pageX,pageY:n.pageY},this.bindActivePointerEvents(),this.emitEvent("pointerDown",[t,n]))},e.onmousemove=function(t){this.pointerMove(t,t)},e.onpointermove=function(t){this.withPointer("pointerMove",t)},e.ontouchmove=function(t){this.withTouch("pointerMove",t)},e.pointerMove=function(t,n){let d={x:n.pageX-this.pointerDownPointer.pageX,y:n.pageY-this.pointerDownPointer.pageY};this.emitEvent("pointerMove",[t,n,d]),!this.isDragging&&this.hasDragStarted(d)&&this.dragStart(t,n),this.isDragging&&this.dragMove(t,n,d)},e.hasDragStarted=function(t){return Math.abs(t.x)>3||Math.abs(t.y)>3},e.dragStart=function(t,n){this.isDragging=!0,this.isPreventingClicks=!0,this.emitEvent("dragStart",[t,n])},e.dragMove=function(t,n,d){this.emitEvent("dragMove",[t,n,d])},e.onmouseup=function(t){this.pointerUp(t,t)},e.onpointerup=function(t){this.withPointer("pointerUp",t)},e.ontouchend=function(t){this.withTouch("pointerUp",t)},e.pointerUp=function(t,n){this.pointerDone(),this.emitEvent("pointerUp",[t,n]),this.isDragging?this.dragEnd(t,n):this.staticClick(t,n)},e.dragEnd=function(t,n){this.isDragging=!1,setTimeout(()=>delete this.isPreventingClicks),this.emitEvent("dragEnd",[t,n])},e.pointerDone=function(){this.isPointerDown=!1,delete this.pointerIdentifier,this.unbindActivePointerEvents(),this.emitEvent("pointerDone")},e.onpointercancel=function(t){this.withPointer("pointerCancel",t)},e.ontouchcancel=function(t){this.withTouch("pointerCancel",t)},e.pointerCancel=function(t,n){this.pointerDone(),this.emitEvent("pointerCancel",[t,n])},e.onclick=function(t){this.isPreventingClicks&&t.preventDefault()},e.staticClick=function(t,n){let d=t.type==="mouseup";d&&this.isIgnoringMouseUp||(this.emitEvent("staticClick",[t,n]),d&&(this.isIgnoringMouseUp=!0,setTimeout(()=>{delete this.isIgnoringMouseUp},400)))},l})});var z=D((j,C)=>{(function(g,h){typeof C=="object"&&C.exports?C.exports=h(g,I(),B()):g.Draggabilly=h(g,g.getSize,g.Unidragger)})(typeof window<"u"?window:j,function(h,a,l){function e(){}let c=h.jQuery;function r(i,o){this.element=typeof i=="string"?document.querySelector(i):i,c&&(this.$element=c(this.element)),this.options={},this.option(o),this._create()}let s=r.prototype=Object.create(l.prototype);s.option=function(i){this.options={...this.options,...i}};let E=["relative","absolute","fixed"];s._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition={...this.position};let i=getComputedStyle(this.element);E.includes(i.position)||(this.element.style.position="relative"),this.on("pointerDown",this.handlePointerDown),this.on("pointerUp",this.handlePointerUp),this.on("dragStart",this.handleDragStart),this.on("dragMove",this.handleDragMove),this.on("dragEnd",this.handleDragEnd),this.setHandles(),this.enable()},s.setHandles=function(){let{handle:i}=this.options;typeof i=="string"?this.handles=this.element.querySelectorAll(i):typeof i=="object"&&i.length?this.handles=i:i instanceof HTMLElement?this.handles=[i]:this.handles=[this.element]};let t=["dragStart","dragMove","dragEnd"],n=s.emitEvent;s.emitEvent=function(i,o){if(!this.isEnabled&&t.includes(i))return;n.call(this,i,o);let f=h.jQuery;if(!f||!this.$element)return;let p,m=o;o&&o[0]instanceof Event&&([p,...m]=o);let v=f.Event(p);v.type=i,this.$element.trigger(v,m)},s._getPosition=function(){let i=getComputedStyle(this.element),o=this._getPositionCoord(i.left,"width"),u=this._getPositionCoord(i.top,"height");this.position.x=isNaN(o)?0:o,this.position.y=isNaN(u)?0:u,this._addTransformPosition(i)},s._getPositionCoord=function(i,o){if(i.includes("%")){let u=a(this.element.parentNode);return u?parseFloat(i)/100*u[o]:0}return parseInt(i,10)},s._addTransformPosition=function(i){let o=i.transform;if(!o.startsWith("matrix"))return;let u=o.split(","),f=o.startsWith("matrix3d")?12:4,p=parseInt(u[f],10),m=parseInt(u[f+1],10);this.position.x+=p,this.position.y+=m},s.handlePointerDown=function(i,o){this.isEnabled&&(this.pointerDownPointer={pageX:o.pageX,pageY:o.pageY},i.preventDefault(),document.activeElement.blur(),this.bindActivePointerEvents(i),this.element.classList.add("is-pointer-down"))},s.handleDragStart=function(){this.isEnabled&&(this._getPosition(),this.measureContainment(),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this.element.classList.add("is-dragging"),this.animate())},s.measureContainment=function(){let i=this.getContainer();if(!i)return;let o=a(this.element),u=a(i),{borderLeftWidth:f,borderRightWidth:p,borderTopWidth:m,borderBottomWidth:y}=u,v=this.element.getBoundingClientRect(),x=i.getBoundingClientRect(),X=f+p,q=m+y,k=this.relativeStartPosition={x:v.left-(x.left+f),y:v.top-(x.top+m)};this.containSize={width:u.width-X-k.x-o.width,height:u.height-q-k.y-o.height}},s.getContainer=function(){let i=this.options.containment;return i?i instanceof HTMLElement?i:typeof i=="string"?document.querySelector(i):this.element.parentNode:void 0},s.handleDragMove=function(i,o,u){if(!this.isEnabled)return;let f=u.x,p=u.y,m=this.options.grid,y=m&&m[0],v=m&&m[1];f=d(f,y),p=d(p,v),f=this.containDrag("x",f,y),p=this.containDrag("y",p,v),f=this.options.axis=="y"?0:f,p=this.options.axis=="x"?0:p,this.position.x=this.startPosition.x+f,this.position.y=this.startPosition.y+p,this.dragPoint.x=f,this.dragPoint.y=p};function d(i,o,u){return o?(u=u||"round",Math[u](i/o)*o):i}s.containDrag=function(i,o,u){if(!this.options.containment)return o;let f=i=="x"?"width":"height",p=this.relativeStartPosition[i],m=d(-p,u,"ceil"),y=this.containSize[f];return y=d(y,u,"floor"),Math.max(m,Math.min(y,o))},s.handlePointerUp=function(){this.element.classList.remove("is-pointer-down")},s.handleDragEnd=function(){this.isEnabled&&(this.element.style.transform="",this.setLeftTop(),this.element.classList.remove("is-dragging"))},s.animate=function(){this.isDragging&&(this.positionDrag(),requestAnimationFrame(()=>this.animate()))},s.setLeftTop=function(){let{x:i,y:o}=this.position;this.element.style.left=`${i}px`,this.element.style.top=`${o}px`},s.positionDrag=function(){let{x:i,y:o}=this.dragPoint;this.element.style.transform=`translate3d(${i}px, ${o}px, 0)`},s.setPosition=function(i,o){this.position.x=i,this.position.y=o,this.setLeftTop()},s.enable=function(){this.isEnabled||(this.isEnabled=!0,this.bindHandles())},s.disable=function(){this.isEnabled&&(this.isEnabled=!1,this.isDragging&&this.dragEnd(),this.unbindHandles())};let b=["transform","left","top","position"];return s.destroy=function(){this.disable(),b.forEach(i=>{this.element.style[i]=""}),this.unbindHandles(),this.$element&&this.$element.removeData("draggabilly")},s._init=e,c&&c.bridget&&c.bridget("draggabilly",r),r})});var O=Y(z(),1),L=class extends A{connectedCallback(){this.classList.add("am-inpage-dock"),H();let h=this.getAttr("csrf"),a=this.getAttr("api"),l=this.getAttr("dashboard"),e=this.getAttr("url"),c=this.getAttr("state"),r=JSON.parse(decodeURIComponent(this.getAttr("labels"))),s=P("div",["am-inpage-dock__container"],{},this),E=P("span",["am-inpage-dock__handle"],{},s,'<i class="bi bi-grip-vertical"></i>');this.initDrag(s,E),P("div",["am-inpage-dock__logo"],{},P("a",["am-inpage-dock__item"],{href:l},s),M);let t=(n,d,b)=>{P("i",["bi",`bi-${n}`],{},P("a",["am-inpage-dock__item"],{href:`${l}/page?url=${encodeURIComponent(e)}&section=${d}`,"data-tooltip":b},s))};t("ui-checks","settings",r.fieldsSettings),t("body-text","text",r.fieldsContent),t("grid","files",r.uploadedFiles),P("am-inpage-publish",[],{state:c,url:e,api:a,csrf:h,label:r.publish},s)}initDrag(h,a){let l=new O.default(h,{handle:a});W(l),l.on("dragEnd",()=>{w(l)}),a.addEventListener("dblclick",()=>{l.setPosition(0,0),w(l)})}};customElements.define("am-inpage-dock",L);export{L as InPageDockComponent};
/*! Bundled license information:

get-size/get-size.js:
  (*!
   * Infinite Scroll v2.0.4
   * measure size of elements
   * MIT license
   *)

unidragger/unidragger.js:
  (*!
   * Unidragger v3.0.1
   * Draggable base class
   * MIT license
   *)

draggabilly/draggabilly.js:
  (*!
   * Draggabilly v3.0.0
   * Make that shiz draggable
   * https://draggabilly.desandro.com
   * MIT license
   *)
*/

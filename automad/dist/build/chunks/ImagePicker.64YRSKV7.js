/* Automad 2.0.0-alpha.47, (c) 2025 Marc Anton Dahmen, MIT license */
import{M as d,S as p,a as l,c as o,k as m}from"./chunk.ETUXSY6N.js";import{a as e}from"./chunk.TNS2LIBN.js";import"./chunk.44XCHEAG.js";import"./chunk.EPACJLJA.js";var r=class extends m{constructor(){super(...arguments);this.binding=null}static get observedAttributes(){return["am-page","am-label","am-binding-name"]}connectedCallback(){this.binding=o.get(this.elementAttributes["am-binding-name"]),this.init(),this.listen(window,"AutomadFilesChangeOnServer",this.init.bind(this))}async init(){this.classList.add("am-c-field"),this.elementAttributes["am-label"]&&(e("label",["am-c-field__label"],{},this).textContent=this.elementAttributes["am-label"],this.removeAttribute("am-label")),this.wrapper=this.wrapper??e("div",[],{},this,"<am-spinner></am-spinner>");let{data:i}=await p("ImageCollectionController::list",{url:this.elementAttributes["am-page"]||""});this.wrapper.innerHTML="";let{images:t}=i;if(!t.length){this.wrapper.innerHTML=d`<am-icon-text ${"am-icon"}="folder-x" ${"am-text"}="${l.text("noImagesFound")}" ></am-icon-text>`;return}this.renderGrid(t,this.wrapper)}renderGrid(i,t){let h=e("div",["am-c-image-picker"],{},t),c=this.elementAttributes["am-page"]?"":"/shared/",s=this.closest("am-modal")||null;i.forEach(n=>{let a=e("img",["am-c-image-picker__image"],{src:n.thumbnail,value:`${c}${n.name}`,"am-tooltip":n.name},h);this.listen(a,"click",()=>{this.binding.value=a.getAttribute("value"),s&&s.close()})})}};customElements.define("am-image-picker",r);

/* Automad 2.0.0-alpha.48, (c) 2025 Marc Anton Dahmen, MIT license */
import{a as j}from"./chunk.DFXEN6GE.js";import{a as X}from"./chunk.KC7M4D2V.js";var Z=X((S,O)=>{(function(f,p){typeof S=="object"&&typeof O=="object"?O.exports=p():typeof define=="function"&&define.amd?define([],p):typeof S=="object"?S.SortableTree=p():f.SortableTree=p()})(self,(()=>(()=>{"use strict";var f={d:(n,e)=>{for(var t in e)f.o(e,t)&&!f.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},o:(n,e)=>Object.prototype.hasOwnProperty.call(n,e)},p={};f.d(p,{default:()=>q});var g=function(n,e,t,o){return new(t||(t=Promise))((function(r,a){function i(s){try{d(o.next(s))}catch(l){a(l)}}function c(s){try{d(o.throw(s))}catch(l){a(l)}}function d(s){var l;s.done?r(s.value):(l=s.value,l instanceof t?l:new t((function(b){b(l)}))).then(i,c)}d((o=o.apply(n,e||[])).next())}))};let v=n=>`<span>${n.title}</span>`,y={collapsed:`
		<svg
		xmlns="http://www.w3.org/2000/svg" 
		width="1em" 
		height="1em" 
		fill="currentColor" 
		class="bi bi-caret-right-fill" 
		viewBox="0 0 16 16">
			<path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/>
		</svg>`,open:`
		<svg 
		xmlns="http://www.w3.org/2000/svg" 
		width="1em" 
		height="1em" 
		fill="currentColor" 
		class="bi bi-caret-down-fill" 
		viewBox="0 0 16 16">
			<path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
		</svg>
	`},T={tree:"tree",node:"tree__node",nodeHover:"tree__node--hover",nodeDragging:"tree__node--dragging",nodeDropBefore:"tree__node--drop-before",nodeDropInside:"tree__node--drop-inside",nodeDropAfter:"tree__node--drop-after",label:"tree__label",subnodes:"tree__subnodes",collapse:"tree__collapse"},D=({nodes:n,movedNode:e,srcParentNode:t,targetParentNode:o})=>g(void 0,void 0,void 0,(function*(){})),L=(n,e)=>g(void 0,void 0,void 0,(function*(){})),_=(n,e)=>g(void 0,void 0,void 0,(function*(){return!0})),m=(n,e=[],t=null)=>{let o=document.createElement(n);return e.forEach((r=>{o.classList.add(r)})),t&&t.appendChild(o),o},G=()=>((n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))();class u extends HTMLElement{static create({data:e,renderLabel:t,icons:o,styles:r,parent:a,onClick:i,draggable:c,eventBus:d}){let s=m(u.TAG_NAME,[r.node],a),l=m("div",[r.label],s),b=m("div",[r.subnodes],s),E=m("span",[r.collapse],s);return l.innerHTML=t(e),E.innerHTML=o.collapsed,d.listen(E,"click",s.toggle.bind(s)),d.listen(l,"click",(w=>{i(w,s)})),c&&s.setAttribute("draggable","true"),s._data=e,s._icons=o,s._label=l,s._nodes=b,s._collapseButton=E,s}get data(){return this._data}get label(){return this._label}get subnodes(){return this._nodes}get subnodesData(){let e=[];return Array.from(this._nodes.children).forEach((t=>{e.push(t.data)})),e}get id(){return this._id}constructor(){super(),this._id=G()}collapse(e){e?(this.removeAttribute("open"),this._collapseButton.innerHTML=this._icons.collapsed):(this.setAttribute("open","true"),this._collapseButton.innerHTML=this._icons.open)}toggle(){this.collapse(this.hasAttribute("open"))}reveal(){((e,t)=>{let o=[],r=t.closest(e);for(;r!==null;)o.push(r),r=r.parentNode.closest(e);return o})(u.TAG_NAME,this).forEach((e=>{e.collapse(!1)}))}}u.TAG_NAME="sortable-tree-node";var H=function(n,e,t,o){return new(t||(t=Promise))((function(r,a){function i(s){try{d(o.next(s))}catch(l){a(l)}}function c(s){try{d(o.throw(s))}catch(l){a(l)}}function d(s){var l;s.done?r(s.value):(l=s.value,l instanceof t?l:new t((function(b){b(l)}))).then(i,c)}d((o=o.apply(n,e||[])).next())}))},h;(function(n){n.BEFORE="BEFORE",n.INSIDE="INSIDE",n.AFTER="AFTER"})(h||(h={}));let x=n=>{let e=n.clientY,t=A(n).label.getBoundingClientRect(),o=Math.round(t.height/4);return t.top+o>e?h.BEFORE:t.bottom-o<e?h.AFTER:h.INSIDE},A=n=>n.target.closest(u.TAG_NAME),P=n=>{let e=n?.parentElement.parentElement;return e?.tagName.toLowerCase()!==u.TAG_NAME?null:e},M=(n,e)=>{A(n).classList.remove(e.styles.nodeDropAfter,e.styles.nodeDropBefore,e.styles.nodeDropInside)},V=(n,e)=>{n.stopPropagation();let t=n.target;t.tagName.toLowerCase()===u.TAG_NAME&&(n.dataTransfer.setData("text",t.id),n.dataTransfer.effectAllowed="move",t.classList.add(e.styles.nodeDragging))},K=(n,e)=>H(void 0,void 0,void 0,(function*(){n.stopPropagation(),n.preventDefault(),M(n,e);let t=A(n);if(!t)return!1;let o=P(t),r=n.dataTransfer.getData("text"),a=x(n),i=e.getNode(r);if(!i||i?.contains(t))return!1;let c=P(i);if(e.lockRootLevel&&!t?.parentElement.closest(u.TAG_NAME)&&(a===h.BEFORE||a===h.AFTER))return!1;if(a===h.BEFORE)return!!(yield e.confirm(i,o))&&(t.parentNode.insertBefore(i,t),e.onDrop(i,c,o),!1);if(a===h.AFTER){if(!(yield e.confirm(i,o)))return!1;let d=t.nextElementSibling;return d?(t.parentNode.insertBefore(i,d),e.onDrop(i,c,o)):(t.parentNode.appendChild(i),e.onDrop(i,c,o)),!1}return!!(yield e.confirm(i,t))&&(t.subnodes.appendChild(i),e.onDrop(i,c,t),!1)})),U=(n,e)=>{n.preventDefault(),n.dataTransfer.dropEffect="move",((t,o)=>{let r=A(t),a=x(t);r.classList.toggle(o.styles.nodeDropBefore,a===h.BEFORE),r.classList.toggle(o.styles.nodeDropInside,a===h.INSIDE),r.classList.toggle(o.styles.nodeDropAfter,a===h.AFTER)})(n,e)},$=(n,e)=>{M(n,e)},z=(n,e)=>{n.target.classList.remove(e.styles.nodeDragging),M(n,e)};class J{constructor(){this.listeners=[]}listen(e,t,o){e.addEventListener(t,o,!1),this.listeners.push({element:e,eventName:t,handler:o})}clear(){this.listeners.forEach((({element:e,eventName:t,handler:o})=>{e.removeEventListener(t,o)})),this.listeners=[]}}let R=n=>`sortableTreeState-${n.replace(/[^\w]+/,"-")}`,q=class{constructor({nodes:n,element:e,renderLabel:t,icons:o,styles:r,lockRootLevel:a,onChange:i,onClick:c,initCollapseLevel:d,confirm:s,disableSorting:l,stateId:b}){this.nodeCollection={},n&&(e&&(this.defineElements(),this.eventBus=new J,this.root=e,this.icons=Object.assign(Object.assign({},y),o),this.styles=Object.assign(Object.assign({},T),r),this.renderLabel=t||v,this.lockRootLevel=a===void 0||a,this.onChange=i||D,this.onClick=c||L,this.confirm=s||_,this.initCollapseLevel=d===void 0?2:d,this.disableSorting=l||!1,e.classList.add(this.styles.tree),this.render({nodes:n,element:e}),b&&(((E,w)=>{let I=sessionStorage.getItem(R(E));if(!I)return;let Y=JSON.parse(I),k=(N,C)=>{let[Q,B]=C;N.element.collapse(Q===0),B&&N.subnodes.forEach(((W,F)=>{B[F]!==void 0&&k(W,B[F])}))};w.forEach(((N,C)=>{k(N,Y[C])}))})(b,this.parseTree(this.root)),this.initStateObserver(b))))}getNode(n){return this.nodeCollection[n]}findNode(n,e){let t=Object.values(this.nodeCollection);for(let o=0;o<t.length;o++){let r=t[o],a=r.data;if(n in a&&a[n]==e)return r}return null}onDrop(n,e,t){let o={nodes:this.parseTree(this.root),movedNode:n,srcParentNode:e,targetParentNode:t};t?.collapse(!1),this.onChange(o)}destroy(){var n;this.eventBus.clear(),(n=this.observer)===null||n===void 0||n.disconnect(),this.observer=null}initStateObserver(n){this.observer=new MutationObserver((()=>{((e,t)=>{let o=[],r=a=>{let i=[],c=[a.element.getAttribute("open")?1:0,i];return a.subnodes.forEach((d=>{i.push(r(d))})),c};t.forEach((a=>{o.push(r(a))})),sessionStorage.setItem(R(e),JSON.stringify(o))})(n,this.parseTree(this.root))})),this.observer.observe(this.root,{childList:!0,attributes:!0,subtree:!0})}defineElements(){try{customElements.define(u.TAG_NAME,u)}catch{}}render({nodes:n,element:e},t=0){t++,n.forEach((o=>{let r=u.create({icons:this.icons,styles:this.styles,parent:e,renderLabel:this.renderLabel,data:o.data,onClick:this.onClick,draggable:!this.disableSorting,eventBus:this.eventBus});this.disableSorting||((a,i)=>{let c={dragstart:V,drop:K,dragover:U,dragend:z,dragleave:$};for(let[d,s]of Object.entries(c))i.eventBus.listen(a,d,(l=>{s(l,i)}))})(r,this),r.collapse(t>this.initCollapseLevel),this.nodeCollection[r.id]=r,o.nodes&&this.render({nodes:o.nodes,element:r.subnodes},t)}))}parseTree(n){let e=Array.from(n.querySelectorAll(`:scope > ${u.TAG_NAME}`)),t=[];return e.forEach((o=>{t.push({element:o,id:o.id,subnodes:this.parseTree(o.subnodes)})})),t}};return p=p.default})()))});var oe=f=>{let p=ee(f),g=(v,y)=>{let T=p[v.url]||[],D=[],L=v;return T.sort((_,m)=>_.index>m.index?1:m.index>_.index?-1:0),T.forEach(_=>{g(_,D)}),y.push({data:L,nodes:D}),y};return g(j.pages["/"],[])},ee=f=>{let p={};return f.forEach(g=>{let v=g.parentUrl;v&&(typeof p[v]>"u"&&(p[v]=[]),p[v].push(g))}),p},re={tree:"am-c-tree",node:"am-c-tree__node",nodeHover:"am-c-tree__node--hover",nodeDragging:"am-c-tree__node--dragging",nodeDropBefore:"am-c-tree__node--drop-before",nodeDropInside:"am-c-tree__node--drop-inside",nodeDropAfter:"am-c-tree__node--drop-after",label:"am-c-tree__label",subnodes:"am-c-tree__subnodes",collapse:"am-c-tree__collapse"};export{Z as a,oe as b,re as c};
/*! Bundled license information:

sortable-tree/dist/sortable-tree.js:
  (*! Sortable Tree 0.7.4, (c) 2025 Marc Anton Dahmen, MIT license *)
*/

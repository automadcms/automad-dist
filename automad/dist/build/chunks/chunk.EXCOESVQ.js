/* Automad, (c) Marc Anton Dahmen, MIT license */
import{C as f,M as u,S as y,a as t,d,da as m,k as p,l as c}from"./chunk.URMIVSL7.js";import{a as n,e as l}from"./chunk.SQMRGQ3J.js";var s=class $ extends p{static MODAL_ID="am-history-modal";connectedCallback(){let e="";m()=="/"&&(e=`am-confirm="${t.text("pageHistoryRestoreHomeConfirm")}"`);let o=n(c.TAG_NAME,[],{id:$.MODAL_ID},this,u`<am-form class="${"am-c-modal__dialog"}" ${"am-api"}="${"HistoryController::restore"}" ${e} ><am-modal-header>${t.text("pageHistory")}</am-modal-header><am-modal-body class="${"am-u-flex--gap-large"}"></am-modal-body><am-modal-footer><am-modal-close class="${"am-e-button"}" >${t.text("cancel")}</am-modal-close ><am-submit class="${"am-e-button"} ${"am-e-button--primary"}"> ${t.text("pageHistoryRestore")}</am-submit></am-modal-footer></am-form>`),a=l("am-modal-body",o);this.listen(o,"AutomadModalOpen",()=>{this.init(a)})}async init(e){e.innerHTML="<am-spinner></am-spinner>";let{data:o}=await y("HistoryController::log",{url:m()});if(!o){e.innerHTML=t.text("pageHistoryNoRevision");return}e.innerHTML=`<span>${m()=="/"?t.text("pageHistoryRestoreHomeText"):t.text("pageHistoryRestoreText")}</span>`;let a=o.reduce((r,i)=>{let g=d(i.time);return r.push({text:g,value:i.hash}),r},[]);f(a,a[0].value,e,"revision")}};customElements.define("am-history-modal-form",s);export{s as a};

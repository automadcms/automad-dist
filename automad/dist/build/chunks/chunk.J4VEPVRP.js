/* Automad 2.0.0-alpha.48, (c) 2025 Marc Anton Dahmen, MIT license */
import{S as n,a as e,aa as m,b as a,d as o,k as l}from"./chunk.DFXEN6GE.js";import{a as s}from"./chunk.G4EF3EQN.js";import{c as b}from"./chunk.KC7M4D2V.js";var u=b(m(),1);var d=t=>{t.hasAttribute("disabled")&&t.removeAttribute("disabled"),t.classList.remove("am-u-text-muted")},r=t=>{t.setAttribute("disabled",""),t.classList.add("am-u-text-muted")},h=class extends l{static TAG_NAME="am-publish-form";tooltip;discardButton;publishButton;lastPublished;stateBinding;connectedCallback(){this.stateBinding=new a("publicationState",{initial:this.initialState()}),this.classList.add("am-c-navbar__group");let i=s("am-form",["am-u-display-small-none"],{"am-watch":"","am-confirm":e.text("discardDraftConfirm"),"am-api":this.controllers().discard,"am-event":"AutomadContentPublished"},this);this.discardButton=s("am-submit",["am-c-navbar__item","am-c-navbar__item--glyph","am-u-text-muted"],{disabled:"","am-tooltip":e.text("discardDraftTooltip")},i,"\u21BA");let p=s("am-form",[],{"am-watch":"","am-api":this.controllers().publish,"am-event":"AutomadContentPublished"},this);this.publishButton=s("am-submit",["am-e-button"],{disabled:""},p,e.text("publish")),this.tooltip=new u.default,this.listen(this.publishButton,"mouseover",()=>{this.tooltip&&this.lastPublished&&this.tooltip.show(this.publishButton,s("span",[],{},null,`${e.text("lastPublished")}:<br>${o(this.lastPublished)}`),{})}),this.listen(this.publishButton,"mouseleave",()=>{this.tooltip.hide()}),this.listen(window,"AutomadContentSaved AutomadContentPublished",this.update.bind(this)),setTimeout(()=>{this.update()},0)}async update(){let{data:i}=await n(this.controllers().state,this.additionalRequestData());if(this.lastPublished=i?.lastPublished,this.stateBinding.value=i?.isPublished?"published":"draft",i?.isPublished){r(this.discardButton),r(this.publishButton);return}i?.lastPublished&&d(this.discardButton),d(this.publishButton)}};export{h as a};

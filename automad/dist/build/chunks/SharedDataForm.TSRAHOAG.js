/* Automad, (c) Marc Anton Dahmen, MIT license */
import{b as v}from"./chunk.QYQ3NE4C.js";import"./chunk.YJVHUJ7V.js";import{E as u,H as p,I as g,K as F,a as e,b as l,e as h,v as s,w as m}from"./chunk.KG3NJGTQ.js";import{a as r}from"./chunk.SQMRGQ3J.js";import"./chunk.ZTO3KGQP.js";import"./chunk.2NNYUVDG.js";var f=c=>({sharedDataFetchTimeBinding:new l("sharedDataFetchTime",{initial:c.time})}),o=class extends v{get deduplicationSettings(){return{getFormData:i=>{let t=g(i);return t.dataFetchTime=null,t},enabled:!0}}sections;bindings;get parallel(){return!1}get auto(){return!0}get initSelf(){return!0}init(){this.sections=m(this),this.listen(window,"AutomadContentPublished",()=>{this.bindings&&(this.bindings.sharedDataFetchTimeBinding.value=Math.ceil(new Date().getTime()/1e3))})}async processResponse(i){i.code===200&&(h("AutomadContentSaved"),this.bindings&&(this.bindings.sharedDataFetchTimeBinding.value=i.time),i.data&&(this.bindings||(this.bindings=f(i)),this.render(i)))}render(i){let{fields:t}=i.data,d=e.reservedFields.THEME,a=t[d]||Object.keys(e.themes)[0],T=e.themes[a]?.labels??{},S=e.themes[a]?.tooltips??{},E=e.themes[a]?.options??{},A=F(t);r("input",[],{type:"hidden","am-bind":"sharedDataFetchTime","am-bind-to":"value",name:"dataFetchTime"},this);let b=s("am-title-field",this.sections.settings,{key:e.reservedFields.SITENAME,value:t[e.reservedFields.SITENAME],name:`data[${e.reservedFields.SITENAME}]`},[],{required:""});new l("sitename",{input:b.input,modifier:n=>n}),s("am-main-theme-field",this.sections.settings,{key:d,value:a,name:`data[${d}]`}),s("am-syntax-theme-select-field",this.sections.settings,{key:e.reservedFields.SYNTAX_THEME,value:t[e.reservedFields.SYNTAX_THEME],name:`data[${e.reservedFields.SYNTAX_THEME}]`}),s("am-image-field",this.sections.settings,{key:e.reservedFields.OPEN_GRAPH_IMAGE,value:t[e.reservedFields.OPEN_GRAPH_IMAGE],name:`data[${e.reservedFields.OPEN_GRAPH_IMAGE}]`,label:e.text("openGraphImageShared")}),e.system.i18n?r("input",[],{type:"hidden",name:`data[${e.reservedFields.LANG_CUSTOM}]`,value:t[e.reservedFields.LANG_CUSTOM]},this.sections.settings):s("am-input-field",this.sections.settings,{key:e.reservedFields.LANG_CUSTOM,value:t[e.reservedFields.LANG_CUSTOM],name:`data[${e.reservedFields.LANG_CUSTOM}]`,label:e.text("langAttr"),placeholder:"en"}),u(t,this.sections),Object.keys(this.sections).forEach(n=>{p({section:this.sections[n],fields:A[n],labels:T,tooltips:S,themeOptions:E,renderEmptyAlert:n!="customizations"})})}};customElements.define("am-shared-data-form",o);export{o as SharedDataFormComponent};

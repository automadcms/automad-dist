/*! Automad 2.0.0-alpha.5, (c) 2024 Marc Anton Dahmen, MIT license */(()=>{"use strict";var e,t={4361:(e,t,a)=>{const i=(e,t=[],a={},i=null,s=null,n=!1)=>{const o=document.createElement(e);t.forEach((e=>{o.classList.add(e)}));for(const[e,t]of Object.entries(a))o.setAttribute(e,t);return i&&(n?i.prepend(o):i.appendChild(o)),s&&(o.innerHTML=s),o},s=e=>{const[t,a]=e.split("::"),i=e=>e.replace(/([A-Z])/g," $1").trim().toLowerCase().replace(/\s/g,"-");return`${i(t.replace("Controller",""))}/${i(a)}`};var n;!function(e){e.setup="setup",e.login="login",e.resetpassword="resetpassword",e.search="search",e.home="home",e.system="system",e.shared="shared",e.packages="packages",e.page="page",e.trash="trash",e.inpage="inpage"}(n||(n={}));const o=(e,t=50)=>{let a;return(...i)=>{clearTimeout(a),a=setTimeout((()=>{e.apply(void 0,i)}),t)}},l=(e,t=document)=>t.querySelector(e),r=(e,t=document)=>Array.from(t.querySelectorAll(e)),c=(e,t)=>{const a=[];let i=(null==t?void 0:t.closest(e))||null;for(;null!==i;)a.push(i),i=i.parentNode.closest(e);return a};var d=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};class m{static getState(e){return Ot.getInstance().get(e)}static get allowedFileTypes(){return m.getState("allowedFileTypes")}static get dashboardURL(){return m.getState("dashboard")}static get feedURL(){return m.getState("feed")}static get files(){return m.getState("files")}static get languages(){return m.getState("languages")}static get mainTheme(){return m.getState("mainTheme")}static get pages(){return m.getState("pages")}static get reservedFields(){return m.getState("reservedFields")}static get contentFields(){return m.getState("contentFields")}static get siteMTime(){return m.getState("siteMTime")}static get sharedPublicationState(){return m.getState("sharedPublicationState")}static get sitename(){return m.getState("sitename")}static get tags(){return m.getState("tags")}static get themes(){return m.getState("themes")}static get system(){return m.getState("system")}static get user(){return m.getState("user")}static get state(){return Ot.getInstance().data}static get root(){return Ot.getInstance().root}static get navigationIsLocked(){return Object.keys(this.navigationLocks).length>0}static get version(){return m.getState("version")}static bootstrap(e){return d(this,void 0,void 0,(function*(){m.baseIndex=e.elementAttributes["base-index"],m.baseURL=e.elementAttributes["base-url"],m.apiURL=`${m.baseIndex}/_api`;const{data:t}=yield Pt("AppController::bootstrap");Ot.getInstance().bootstrap(e,t),v(window,"AutomadAppStateRequireUpdate",this.updateState.bind(this))}))}static updateState(){return d(this,void 0,void 0,(function*(){const e=yield Pt("AppController::updateState",null,!1);Ot.getInstance().update(e.data)}))}static addNavigationLock(){const e=this.latestLockId++;return this.navigationLocks[e]=!0,e}static reload(){const e=l("am-filter input");e&&Kt("filter",e.value),Kt("scroll",String(window.scrollY)),window.location.reload()}static restoreFilterAndScroll(){const e=l("am-filter input"),t=Vt("filter"),a=Vt("scroll");t&&(e&&(e.value=t,b("input",e)),zt("filter")),a&&(window.scrollTo(0,parseInt(a)),zt("scroll"))}static removeNavigationLock(e){delete this.navigationLocks[e]}static text(e){return m.getState("text")[e]||""}static checkForSystemUpdate(){return d(this,void 0,void 0,(function*(){const e=yield Pt("SystemController::checkForUpdate",null,!0,null,!0);e.data&&(Ot.getInstance().set("systemUpdate",e.data),b("AutomadSystemUpdateCheck",window))}))}static checkForOutdatedPackages(){var e;return d(this,void 0,void 0,(function*(){const{data:t}=yield Pt("PackageManagerController::getOutdated",null,!0,null,!0);Ot.getInstance().set("outdatedPackages",(null===(e=null==t?void 0:t.outdated)||void 0===e?void 0:e.length)||0),b("AutomadPackagesUpdateCheck",window)}))}}m.navigationLocks={},m.latestLockId=0,m.apiURL="",m.baseIndex="",m.baseURL="",m.isReady=!1;class u{get value(){let e=this.input.value;if(this.storeValueAsObject&&("string"!=typeof e||""!=e)){e=JSON.parse(e).value}return this.modifier?this.modifier(e):e}set value(e){this.storeValueAsObject?this.input.value=JSON.stringify({value:e}):this.input.value=e,this.onChange&&this.onChange(e),b("input",this.input)}constructor(e,t={}){t=Object.assign({initial:null,input:null,modifier:null,onChange:null},t),this.modifier=t.modifier,this.storeValueAsObject=null===t.input,this.onChange=t.onChange,this.input=t.input||i("input",[],{}),p.add(e,this),null!==t.initial&&(this.value=t.initial)}}class h{static track(e,t){}}h.missing=[],h.unused=[],h.references=[],h.bindings=[];class p{static add(e,t){this._bindings[e]=t}static delete(e){delete this._bindings[e]}static get(e){return h.track(e,this._bindings[e]),this._bindings[e]}static getBindingNames(){return Object.keys(this._bindings)}static connectElements(e){r("[am-bind]",e).forEach((e=>{const t=e.getAttribute("am-bind"),a=this._bindings[t];if(h.track(t,a),!a)return;const i=e.getAttribute("am-bind-to");let s=[];i?(s=i.split(" "),e.removeAttribute("am-bind-to")):s=["textContent"],e.removeAttribute("am-bind");v(a.input,"change input",(()=>{s.forEach((t=>{switch(t){case"textContent":e.textContent=a.value;break;case"checked":e.checked=a.value;break;case"disabled":a.value?e.setAttribute("disabled",""):e.removeAttribute("disabled");break;case"value":e.value=a.value;break;default:e.setAttribute(t,a.value)}b("AutomadChangeByBinding",e)}))})),b("input",a.input)}))}static reset(){this._bindings={}}}p._bindings={};const g=e=>{const t=m.text("__lang__");return new Date(e).toLocaleDateString(t,{day:"2-digit",weekday:"short",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})},b=(e,t=window)=>{t.dispatchEvent(new Event(e,{bubbles:!0}))},v=(e,t,a,i="")=>{const s=t.split(" ").filter((e=>e.length>0)),n=e=>{if(!i)return void a.apply(e.target,[e]);(e.path||e.composedPath&&e.composedPath()).forEach((t=>{try{if(t.matches(i))return void a.apply(e.target,[e])}catch(e){}}))};s.forEach((t=>{e.addEventListener(t,n)}));return{remove:()=>{s.forEach((t=>{e.removeEventListener(t,n)}))}}},f=(e,t,a=!0)=>{const i=new MutationObserver(((e,a)=>{e.forEach((function(e){"attributes"===e.type&&"class"===e.attributeName&&t.apply(e.target,[e])}))}));i.observe(e,{attributes:!0,childList:!1,subtree:a});return{remove:()=>{i.disconnect()}}};class x extends HTMLElement{constructor(){super(),this.elementAttributes={},this.listeners=[]}static get observedAttributes(){return[]}attributeChangedCallback(e,t,a){this.elementAttributes[e]=a||""}disconnectedCallback(){this.removeListeners()}addListener(e){this.listeners.push(e)}removeListeners(){this.listeners.forEach((e=>{e.remove()}))}}class y extends x{constructor(){super(...arguments),this.classes=["am-c-modal"]}get isOpen(){return this.matches("[am-modal-open]")}lockNavigation(){this.lockId=m.addNavigationLock()}unlockNavigation(){m.removeNavigationLock(this.lockId)}connectedCallback(){this.classList.add(...this.classes),this.hasAttribute("am-no-click")||v(this,"click",(e=>{this===e.target&&this.close()})),this.hasAttribute("am-no-esc")||this.addListener(v(window,"keydown",(e=>{this.isOpen&&27==e.keyCode&&this.close()})))}toggleBodyOverflow(){l("body").classList.toggle("am-u-overflow-hidden",null!=l("[am-modal-open]"))}toggle(){this.isOpen?this.close():this.open()}close(){this.removeAttribute("am-modal-open"),this.toggleBodyOverflow(),this.unlockNavigation(),this.restoreInitialFormData(),b("AutomadModalClose",this),this.focusTrap.remove(),setTimeout((()=>{r(".am-validate").forEach((e=>{e.classList.remove("am-validate")}))}),400),this.hasAttribute("am-destroy")&&setTimeout((()=>{this.remove()}),400)}open(){if(this.setAttribute("am-modal-open",""),this.toggleBodyOverflow(),this.lockNavigation(),this.saveInitialFormData(),b("AutomadModalOpen",this),this.focusTrap=(e=>{var t;const a='input:not([type="hidden"]), button, textarea, [contenteditable], [tabindex="0"]';return null===(t=l(a,e))||void 0===t||t.focus(),v(document,"keydown",(t=>{if("Tab"!==t.key&&9!==t.keyCode)return;const i=r(a,e);if(0===i.length)return void t.preventDefault();const s=i[0],n=i[i.length-1];t.shiftKey?document.activeElement===s&&(t.preventDefault(),n.focus()):document.activeElement===n&&(t.preventDefault(),s.focus())}))})(this),!this.hasAttribute("am-no-focus")){const e=l("input, textarea",this);if(e){const t=e.value;e.focus(),e.value="",e.value=t}}}saveInitialFormData(){this.formData=dt(this)}restoreInitialFormData(){ht(this.formData,this)}}y.TAG_NAME="am-modal",customElements.define(y.TAG_NAME,y);class w extends x{set options(e){let t="";e.forEach((e=>{t+=ft`<option value="${e.value}"> ${void 0!==e.text?e.text:e.value} </option>`})),this._select.innerHTML=t,setTimeout(this.updateLabel.bind(this),0)}get value(){return this.selectedOption.value}set value(e){this._select.value=e,this.updateLabel()}get select(){return this._select}get selectedOption(){return this._select.options[this._select.selectedIndex]}connectedCallback(){this.classList.add("am-f-select")}updateLabel(){try{this.label.textContent=this.selectedOption.text}catch(e){}}init(e,t,a,s){this.innerHTML=a,this.label=i("span",[],{},this),this._select=i("select",[],s,this),this.options=e,this.value=t;const n=()=>{this.classList.toggle("am-focus",this._select===document.activeElement)};v(this._select,"focus blur",n),n(),v(this._select,"change AutomadChangeByBinding",this.updateLabel.bind(this)),setTimeout((()=>{Dt.attach({getValueProvider:()=>this._select,query:()=>this._select.value,mutate:e=>{this._select.value=`${e}`}})}),0)}}w.TAG_NAME="am-select",customElements.define(w.TAG_NAME,w);class k{static get enableLineBreaks(){return!1}constructor({data:e,api:t,config:a,block:s}){this.listeners=[],this.api=t,this.data=this.prepareData(e||{}),this.config=a,this.blockAPI=s,this.wrapper=i("div",["cdx-block"])}prepareData(e){return e}addListener(e){this.listeners.push(e)}destroy(){this.listeners.forEach((e=>{e.remove()}))}}var _=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};const $={start:"Start",end:"End",center:"Center","space-between":"Space Between","space-evenly":"Space Evenly","fill-row":"Fill Row"},C={normal:"Normal",stretch:"Stretch",center:"Center",start:"Start",end:"End"},T=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],A=["solid","dashed","dotted","double","groove","ridge"],L={card:!1,shadow:!1,matchRowHeight:!1,color:"",backgroundColor:"",backgroundBlendMode:"normal",borderColor:"",borderWidth:"0",borderRadius:"0",borderStyle:"solid",backgroundImage:"",paddingTop:"0",paddingBottom:"0",overflowHidden:!1},E=Object.assign({},L,{color:"inherit",backgroundColor:"transparent",borderColor:"currentColor"});class S extends k{constructor(){super(...arguments),this.holder=null,this.section=null}static get enableLineBreaks(){return!0}static get sanitize(){return{content:!0,style:!1}}static get toolbox(){return{title:m.text("sectionBlockTitle"),icon:'<i class="bi bi-layout-three-columns"></i>'}}prepareData(e){return{content:e.content||{},style:Object.assign({},L,e.style),justify:e.justify||"start",align:e.align||"normal",gap:void 0!==e.gap?e.gap:"",minBlockWidth:void 0!==e.minBlockWidth?e.minBlockWidth:""}}render(){this.section=i("div",["am-c-ed-bl-section"],{},this.wrapper),i("span",["am-u-flex"],{},this.section,ft`<span class="am-c-ed-bl-section__label"> ${m.text("sectionBlockTitle")} </span>`);return(()=>{_(this,void 0,void 0,(function*(){this.holder=Xe(this.section,this.data.content,{onChange:e=>_(this,void 0,void 0,(function*(){const{blocks:t}=yield e.saver.save();this.data.content={blocks:t},this.blockAPI.dispatchChange()}))},!0),yield this.holder.editor.isReady,this.holder.editor.focus(),v(this.holder,"paste",(e=>{e.stopPropagation()})),this.renderToolbar(),this.setStyle()}))})(),this.wrapper}save(){return this.data}renderToolbar(){const e=i("div",["am-c-ed-bl-section__toolbar"],{},this.section);this.renderStylesButton(e),this.renderJustifySelect(e),this.renderAlignSelect(e),this.renderNumberUnitInput(e,"gap",'<i class="bi bi-columns-gap"></i>'),this.renderNumberUnitInput(e,"minBlockWidth",'<i class="bi bi-arrows"></i>'),i("input",["am-u-display-none"],{},e),v(e,"change",(()=>{this.setStyle()}));v(this.wrapper,"click",(t=>{t.stopPropagation(),r(".am-c-ed-bl-section__toolbar").forEach((t=>{t.classList.toggle("am-active",t==e)})),e.style.transform="translateX(0)",setTimeout((()=>{const t=e.getBoundingClientRect(),a=document.body.offsetWidth;if(a<t.right){const i=a-t.right-10;e.style.transform=`translateX(${i}px)`}}),0)})),this.addListener(v(document,"click",(t=>{const a=t.target;this.wrapper.contains(a)||e.classList.remove("am-active")})))}renderStylesButton(e){const t=i("am-modal-toggle",["am-e-button","am-e-button--icon","am-e-button--primary"],{"am-tooltip":m.text("editStyle")},e,'<i class="bi bi-palette2"></i>');v(t,"click",(()=>{this.renderStylesModal()}))}renderJustifySelect(e){const t=Object.keys($).reduce(((e,t)=>(e.push({text:$[t],value:t}),e)),[]),a=i("span",["am-f-group"],{},e,ft`<span class="am-f-group__item am-f-group__icon"><i class="bi bi-distribute-horizontal"></i></span>`),s=nt(t,this.data.justify,a,null,null,"",["am-f-group__item","am-f-select--inline"]);v(s.select,"change",(()=>{this.data.justify=s.value,this.blockAPI.dispatchChange()}))}renderAlignSelect(e){const t=Object.keys(C).reduce(((e,t)=>(e.push({text:C[t],value:t}),e)),[]),a=i("span",["am-f-group"],{},e,ft`<span class="am-f-group__item am-f-group__icon"><i class="bi bi-distribute-vertical"></i></span>`),s=nt(t,this.data.align,a,null,null,"",["am-f-group__item","am-f-select--inline"]);v(s.select,"change",(()=>{this.data.align=s.value,this.blockAPI.dispatchChange()}))}renderNumberUnitInput(e,t,a){const s=i("span",["am-f-group"],{},e,ft`<span class="am-f-group__item am-f-group__icon"> ${a} </span>`),n=i("am-number-unit-input",["am-f-group__item"],{value:this.data[t]},s);v(n,"change",(()=>{this.data[t]=n.value,this.blockAPI.dispatchChange()}))}renderStylesModal(){const{modal:e,body:t}=tt(m.text("editStyle")),a=(e,t,a,i)=>{Qe(e,i,{name:t,value:this.data.style[t],key:na(),label:m.text(a)})};a("am-toggle","card","optimizeContentForCards",t),a("am-toggle","matchRowHeight","matchRowHeight",t);const s=i("div",["am-l-grid","am-l-grid--auto"],{},t);a("am-toggle","overflowHidden","overflowHidden",s),a("am-toggle","shadow","addShadow",s);const n=i("div",["am-l-grid","am-l-grid--auto"],{},t);a("am-color","color","textColor",n),a("am-color","backgroundColor","backgroundColor",n);const o=i("div",["am-l-grid","am-l-grid--auto"],{},t),l=na(),r=i("div",["am-c-field"],{},o,ft`<div><label for="${l}" class="am-c-field__label"> ${m.text("borderStyle")} </label></div>`);nt(A.reduce(((e,t)=>[...e,{value:t}]),[]),this.data.style.borderStyle,r,"borderStyle",l),a("am-color","borderColor","borderColor",o),a("am-image-select","backgroundImage","backgroundImage",t);const c=na(),d=i("div",["am-c-field"],{},t,ft`<div><label for="${c}" class="am-c-field__label"> Background Blendmode </label></div>`);nt(T.reduce(((e,t)=>[...e,{value:t}]),[]),this.data.style.backgroundBlendMode,d,"backgroundBlendMode",c);const u=i("div",["am-l-grid","am-l-grid--auto"],{},t);a("am-number-unit","borderWidth","borderWidth",u),a("am-number-unit","borderRadius","borderRadius",u);const h=i("div",["am-l-grid","am-l-grid--auto"],{},t);a("am-number-unit","paddingTop","paddingTop",h),a("am-number-unit","paddingBottom","paddingBottom",h),p.connectElements(t),this.api.listeners.on(t,"change",(()=>{this.data.style=dt(t),this.setStyle(),this.blockAPI.dispatchChange()})),setTimeout((()=>{e.open()}))}setStyle(){const{style:e,gap:t,justify:a,align:i,minBlockWidth:s}=this.data,n="am-style",o=["am-c-ed-bl-section__editor"];o.push(`${n}--justify-${a}`),o.push(`${n}--align-${i}`),e.card&&o.push(`${n}--card`),e.shadow&&o.push(`${n}--shadow`),e.overflowHidden&&o.push(`${n}--overflow-hidden`),e.matchRowHeight&&o.push(`${n}--match-height`),this.holder.className=o.join(" ");const l=[];if(["color","backgroundColor","backgroundBlendMode","borderColor","borderWidth","borderRadius","borderStyle","paddingTop","paddingBottom"].forEach((t=>{const a=e[t];l.push(`--${t}: ${a||E[t]};`)})),e.backgroundImage){const t=Jt(e.backgroundImage);l.push(`--backgroundImage: url(${t});`)}else l.push("--backgroundImage: none;");t&&l.push(`--gap: ${t};`),s&&l.push(`--minBlockWidth: ${s};`),this.holder.setAttribute("style",l.join(" "))}}class P{static get isInline(){return!0}get state(){return this._state}set state(e){this._state=e,this.button.classList.toggle(this.api.styles.inlineToolButtonActive,e)}constructor({api:e}){this._state=!1,this.api=e,this.button=i("button",[this.api.styles.inlineToolButton],{type:"button"},null,this.icon)}render(){return this.button}surround(e){this.state?this.unwrap():this.wrap(e)}wrap(e){const t=e.extractContents(),a=i(this.tag,[],{});a.appendChild(t),e.insertNode(a),this.api.selection.expandToTag(a)}unwrap(){this.restoreSelection();const e=this.api.selection.findParentTag(this.tag);this.api.selection.expandToTag(e);const t=window.getSelection().getRangeAt(0),a=t.extractContents();e.remove(),t.insertNode(a)}checkState(){const e=this.api.selection.findParentTag(this.tag);this.state=!!e,this.state?(this.saveSelection(),this.showActions(e)):this.hideActions()}saveSelection(){this.range=window.getSelection().getRangeAt(0)}restoreSelection(){const e=window.getSelection();e.removeAllRanges(),e.addRange(this.range)}showActions(e){}hideActions(){}}class I extends P{get shortcut(){return"CMD+B"}static get title(){return m.text("bold")}static get sanitize(){return{strong:!0}}get icon(){return'<i class="bi bi-type-bold"></i>'}get tag(){return"STRONG"}}class M extends P{static get title(){return m.text("inlineCode")}static get sanitize(){return{code:!0}}get icon(){return'<i class="bi bi-code"></i>'}get tag(){return"CODE"}}class R extends P{constructor(){super(...arguments),this.listener=null}static get title(){return m.text("color")}static get sanitize(){return{"am-inline-color":!0}}get tag(){return"AM-INLINE-COLOR"}get icon(){return'<i class="bi bi-paint-bucket"></i>'}renderActions(){return this.wrapper=i("div",["am-l-grid","am-l-grid--auto"],{}),this.textColorPicker=Qe("am-color",this.wrapper,{key:na(),value:"",name:"color",label:m.text("textColor")}),this.backgroundColorPicker=Qe("am-color",this.wrapper,{key:na(),value:"",name:"backgroundColor",label:m.text("backgroundColor")}),this.wrapper}showActions(e){const{color:t,backgroundColor:a}=e.style;t&&(this.textColorPicker.mutate(Qt(t)),b("change",this.textColorPicker.input)),a&&(this.backgroundColorPicker.mutate(Qt(a)),b("change",this.backgroundColorPicker.input)),this.listener=v(this.wrapper,"keyup change",(()=>{e.style.color=this.textColorPicker.query(),e.style.backgroundColor=this.backgroundColorPicker.query()})),this.wrapper.hidden=!1}hideActions(){this.wrapper.hidden=!0}clear(){var e;null===(e=this.listener)||void 0===e||e.remove()}}class H extends P{constructor(){super(...arguments),this.options=[],this.default="",this.property="",this.listener=null}static get title(){return""}renderActions(){this.wrapper=i("div",[],{});const e=i("div",["am-c-field"],{},this.wrapper,ft`<label class="am-c-field__label"> ${this.constructor.title} </label>`);return this.select=nt(this.options.reduce(((e,t)=>[...e,{value:t}]),[]),this.default,e),this.wrapper}showActions(e){const t=e.style.getPropertyValue(this.property);t&&(this.select.select.value=t),this.listener=v(this.wrapper,"change",(()=>{e.style.setProperty(this.property,this.select.value)})),this.wrapper.hidden=!1}hideActions(){this.wrapper.hidden=!0}clear(){var e;null===(e=this.listener)||void 0===e||e.remove()}}class B extends H{constructor(){super(...arguments),this.options=["70%","80%","90%","100%","110%","120%","130%","150%","175%","200%","250%","300%","350%","400%","450%","500%"],this.default="100%",this.property="font-size"}static get title(){return m.text("fontSize")}static get sanitize(){return{"am-inline-font-size":!0}}get tag(){return"AM-INLINE-FONT-SIZE"}get icon(){return'<i class="bi bi-fonts"></i>'}}class O extends P{get shortcut(){return"CMD+I"}static get title(){return m.text("italic")}static get sanitize(){return{i:!0}}get icon(){return'<i class="bi bi-type-italic"></i>'}get tag(){return"I"}}class F extends H{constructor(){super(...arguments),this.options=["normal","100%","105%","110%","115%","120%","125%","130%","135%","140%","145%","150%","155%","160%","165%","170%","175%","180%"],this.default="normal",this.property="line-height"}static get title(){return m.text("lineHeight")}static get sanitize(){return{"am-inline-line-height":!0}}get tag(){return"AM-INLINE-LINE-HEIGHT"}get icon(){return'<i class="bi bi-distribute-vertical"></i>'}}class N extends P{constructor(){super(...arguments),this.listener=null}static get title(){return m.text("link")}static get sanitize(){return{a:!0}}get tag(){return"A"}get icon(){return'<i class="bi bi-link-45deg"></i>'}renderActions(){this.wrapper=i("div",[],{});const e=i("div",["am-c-field"],{},this.wrapper,ft`<label class="am-c-field__label">${N.title}</label>`);return this.autocomplete=i("am-autocomplete-url",[],{},e),this.targetToggle=Qe("am-toggle",this.wrapper,{key:na(),value:!1,name:"target",label:m.text("openInNewTab")}),this.wrapper}showActions(e){var t;const a=this.autocomplete.input,i=this.targetToggle.input;a.value=null!==(t=e.getAttribute("href"))&&void 0!==t?t:"",i.checked="_blank"==e.getAttribute("target"),this.listener=v(this.wrapper,"input AutomadAutocompleteSelect",(()=>{e.href=a.value,i.checked?e.setAttribute("target","_blank"):e.removeAttribute("target")})),this.wrapper.hidden=!1,a.focus()}hideActions(){this.wrapper.hidden=!0}clear(){var e;null===(e=this.listener)||void 0===e||e.remove()}}class U extends P{static get title(){return m.text("strikeThrough")}static get sanitize(){return{s:!0}}get icon(){return'<i class="bi bi-type-strikethrough"></i>'}get tag(){return"S"}}class D extends P{static get title(){return m.text("underline")}static get sanitize(){return{u:!0}}get icon(){return'<i class="bi bi-type-underline"></i>'}get tag(){return"U"}}var j=a(3416),q=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};const z=(e,t,a=0)=>q(void 0,void 0,void 0,(function*(){const i=yield e.save();t.blocks.insert(i.tool,i.data,i.config,a,!0,!1,(0,j.x0)(32),i.tunes),t.blocks.getBlockByIndex(0).dispatchChange()}));var G=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};const V=e=>Array.from(e.parentNode.children).indexOf(e),W=e=>e.closest(Ye.TAG_NAME),J=e=>{if(!e)return;const t=document.createRange(),a=window.getSelection();t.setStart(e.childNodes[0],0),t.collapse(!0),a.removeAllRanges(),a.addRange(t),e.focus()};class Z{constructor(e){this.component=e,this.editor=e.editor,this.initListeners()}initListeners(){const e=l(":scope > .codex-editor > .ce-toolbar .ce-toolbar__settings-btn",this.component);e.setAttribute("draggable","true"),v(e,"dragstart",(()=>{const e=this.getCurrentBlock();Z.CURRENT={block:e,index:V(e.holder)}})),v(e,"drag",(()=>{this.editor.toolbar.close()})),v(this.component,"dragover",(e=>{e.stopImmediatePropagation();const t=e.target,a=t.closest(".ce-block");if(a)return Z.TARGET=a,void J(Z.TARGET);if(!t.closest(Ye.TAG_NAME))return;const i=l(".ce-block");i&&(Z.TARGET=i,J(Z.TARGET))})),v(this.component,"drop",(e=>G(this,void 0,void 0,(function*(){e.stopImmediatePropagation(),yield Z.move()}))))}getCurrentBlock(){return this.editor.blocks.getBlockByIndex(this.editor.blocks.getCurrentBlockIndex())}static move(){return G(this,void 0,void 0,(function*(){if(Z.CURRENT.block.holder==Z.TARGET)return;if(!Z.TARGET||!Z.CURRENT)return;const e=W(Z.CURRENT.block.holder),t=Z.CURRENT.index,a=Z.TARGET,i=W(a),s=V(a);e===i?(e.editor.blocks.move(s,t),e.editor.caret.setToBlock(s,"end")):(e.editor.blocks.delete(t),z(Z.CURRENT.block,i.editor,s),i.editor.caret.setToBlock(s,"end")),Z.CURRENT=null,Z.TARGET=null}))}}class K{static get isTune(){return!0}constructor({api:e,data:t,config:a,block:i}){this.api=e,this.config=a,this.block=i,this.data=this.prepareData(t),this.wrapper=this.renderSettings()}save(){return this.data}render(){return this.wrapper}}const Y=["section","delimiter","image","gallery","slider","pagelist","embed","table"],X=["1/4","1/3","1/2","2/3","3/4","1/1"];class Q extends K{get isStretchable(){return Y.includes(this.block.name||"")}get isFlex(){return this.config.isSectionBlock||!1}get selected(){const{stretched:e,width:t}=this.data;return e?Q.STRETCHED:t||""}set selected(e){this.data.stretched=e===Q.STRETCHED,this.data.width=e&&e!==Q.STRETCHED?e:null,this.apply()}apply(){this.data&&setTimeout((()=>{const e=this.block.holder,{stretched:t,width:a}=this.data;e.classList.toggle("am-style--stretched",t),a?e.setAttribute("am-width",a):e.removeAttribute("am-width")}),0)}wrap(e){return this.apply(),e}static updateToolbarPosition(e){if(!e)return;const t=l(":scope > .ce-block__content",e),a=e.closest(".codex-editor"),i=l(":scope > .ce-toolbar",a);if(!i)return;const s=l(".ce-settings",i);if((null==s?void 0:s.hasChildNodes())||a.matches(".codex-editor--toolbox-opened"))return;const n=Math.round(t.getBoundingClientRect().x-e.parentElement.getBoundingClientRect().x),o=Math.round(t.getBoundingClientRect().y-e.parentElement.getBoundingClientRect().y);i.setAttribute("style",`--x: ${n}px; --y: ${o}px;`)}prepareData(e){return{stretched:(null==e?void 0:e.stretched)||!1,width:(null==e?void 0:e.width)||null}}renderSettings(){const e=i("div",["am-c-ed-popover__form"]);if(!this.isFlex&&!this.isStretchable)return this.data=null,e;const t=[{value:"",text:m.text("layoutDefault")}];this.isStretchable&&t.push({value:Q.STRETCHED,text:m.text("layoutStretch")}),this.isFlex&&X.forEach((e=>{t.push({value:e,text:`${m.text("layoutWidth")}: ${e.replace("/","⁄")}`})}));const a=nt(t,this.selected,e);return v(a.select,"change",(()=>{this.selected=a.value,this.block.dispatchChange()})),e}}Q.STRETCHED="stretched";var ee=a(2453);class te extends k{static get toolbox(){return{title:m.text("delimiter"),icon:'<i class="bi bi-hr"></i>'}}render(){return this.wrapper.classList.add("am-c-ed-bl-delimiter"),i("hr",[],{},this.wrapper),this.wrapper}save(){return{}}}class ae extends x{set src(e){this.render(e)}static get observedAttributes(){return["src"]}connectedCallback(){this.classList.add("am-e-img")}attributeChangedCallback(e,t,a){"src"===e&&(this.src=a)}render(e){var t;if(this.innerHTML="",null===(t=this.listener)||void 0===t||t.remove(),0==e.length)return void(this.innerHTML=this.placeholder("slash-circle"));const a=i("img",[],{},this);this.listener=v(a,"error",(()=>{this.innerHTML=this.placeholder("exclamation-triangle")})),a.src=e}placeholder(e){return ft`<span class="am-e-img__error"><i class="bi bi-${e}"></i></span>`}}ae.TAG_NAME="am-img",customElements.define("am-img",ae);class ie extends k{static get sanitize(){return{url:!0,link:!1,openInNewTab:!1,caption:{}}}static get pasteConfig(){return{patterns:{image:/(https?:\/\/)?\S+\.(gif|jpe?g|tiff|png)$/i}}}static get toolbox(){return{title:m.text("imageTool"),icon:'<i class="bi bi-image"></i>'}}prepareData(e){return{url:e.url||"",link:e.link||"",openInNewTab:e.openInNewTab||!1,caption:e.caption||""}}setImage(e){this.data.url=e,this.img.src=Jt(e)}render(){this.wrapper.classList.add("am-c-ed-bl-image"),this.img=i(ae.TAG_NAME,[],{},this.wrapper),this.setImage(this.data.url);const e=i("div",["am-c-ed-bl-image__buttons","am-f-group"],{},this.wrapper),t=i("button",["am-e-button","am-e-button--icon","am-f-group__item"],{"am-tooltip":m.text("selectImage")},e,'<i class="bi bi-folder2"></i>'),a=i("button",["am-e-button","am-e-button--icon","am-f-group__item"],{"am-tooltip":m.text("link")},e,'<i class="bi bi-link-45deg"></i>');return this.caption=i("div",["cdx-block","ce-paragraph"],{contenteditable:"true",placeholder:m.text("caption")},this.wrapper,ft`${this.data.caption}`),v(t,"click",this.pickImage.bind(this)),v(a,"click",this.createLinkModal.bind(this)),this.wrapper}appendCallback(){this.pickImage()}onPaste(e){"pattern"==e.type&&this.setImage(e.detail.data)}pickImage(){at(this.setImage.bind(this),m.text("selectImage"),this.data.url)}createLinkModal(){const{modal:e,body:t}=tt(m.text("link"));Qe("am-url",t,{value:this.data.link,name:"link",key:na(),label:m.text("link")}),Qe("am-toggle",t,{value:this.data.openInNewTab,name:"newTab",key:na(),label:m.text("openInNewTab")}),v(t,"change",(()=>{const t=dt(e);this.data.link=t.link,this.data.openInNewTab=!!t.newTab,this.blockAPI.dispatchChange()})),setTimeout((()=>{e.open()}))}save(){return this.data.caption=this.caption.innerHTML||"",this.data}}var se=a(9257),ne=a.n(se);class oe extends(ne()){static get toolbox(){return{icon:'<i class="bi bi-list-ul"></i>',title:m.text("list")}}renderSettings(){const[e,t]=super.renderSettings();return[Object.assign(Object.assign({},e),{icon:'<i class="bi bi-list-ul"></i>',label:m.text("unorderedList")}),Object.assign(Object.assign({},t),{icon:'<i class="bi bi-list-ol"></i>',label:m.text("orderedList")})]}}class le extends k{static get conversionConfig(){return{import:"text",export:e=>e.caption?`${e.text} — ${e.caption}`:e.text}}static get enableLineBreaks(){return!0}static get sanitize(){return{text:{},caption:{}}}static get toolbox(){return{title:m.text("blockquote"),icon:'<i class="bi bi-quote"></i>'}}prepareData(e){return{text:e.text||"",caption:e.caption||""}}render(){return this.wrapper.classList.add("am-c-ed-bl-quote","am-u-flex","am-u-flex--column"),this.inputs={text:i("div",["am-c-ed-bl-quote__text","ce-paragraph"],{contenteditable:"true",placeholder:m.text("blockquote")},this.wrapper,ft`${this.data.text}`),caption:i("div",["am-c-ed-bl-quote__caption","ce-paragraph"],{contenteditable:"true",placeholder:`— ${m.text("caption")}`},this.wrapper,ft`${this.data.caption}`)},this.wrapper}save(){return{text:this.inputs.text.innerHTML,caption:this.inputs.caption.innerHTML}}}var re=a(9896),ce=a.n(re);class de extends(ce()){static get toolbox(){return{title:m.text("table"),icon:'<i class="bi bi-grid-3x3"></i>'}}renderSettings(){const[e,t]=super.renderSettings();return[Object.assign(Object.assign({},e),{icon:'<i class="bi bi-table"></i>',label:m.text("tableWithHeadings")}),Object.assign(Object.assign({},t),{icon:'<i class="bi bi-grid-3x3"></i>',label:m.text("tableWithoutHeadings")})]}}class me{static get isInline(){return!0}get state(){return this._state}set state(e){this._state=e,this.button.classList.toggle(this.api.styles.inlineToolButtonActive,e)}static get sanitize(){return{"am-inline-align":!0}}constructor({api:e}){this.tag="AM-INLINE-ALIGN",this.api=e,this.button=i("button",[this.api.styles.inlineToolButton],{type:"button"},null)}render(){return this.button.innerHTML=`<i class="bi bi-text-${this.align}"></i>`,this.button}surround(){var e;if(this.saveSelection(),this.state){const e=this.api.selection.findParentTag(this.tag);if(e){this.api.selection.expandToTag(e);const t=window.getSelection().getRangeAt(0),a=t.extractContents();e.remove(),t.insertNode(a)}}else{const t=()=>{const e=this.api.selection.findParentTag("DIV");this.api.selection.expandToTag(e);const t=window.getSelection().getRangeAt(0),a=t.extractContents(),s=i(this.tag,[],{});return s.appendChild(a),t.insertNode(s),s};let a=null!==(e=this.api.selection.findParentTag(this.tag))&&void 0!==e?e:t();a.style.textAlign=this.align,a.style.display="block"}this.restoreSelection()}checkState(){const e=this.api.selection.findParentTag(this.tag);if(e){const t=e.getAttribute("style"),a=new RegExp(this.align,"g");if(null==t?void 0:t.match(a))return void(this.state=!0)}this.state=!1}saveSelection(){const e=window.getSelection();this.selection={start:e.anchorOffset,end:e.focusOffset,div:this.api.selection.findParentTag("DIV")}}restoreSelection(){const e=window.getSelection();e.removeAllRanges();const t=l(`:scope> ${this.tag.toLowerCase()}`,this.selection.div),a=null!=t?t:this.selection.div;e.setBaseAndExtent(a.childNodes[0],this.selection.start,a.childNodes[0],this.selection.end)}}class ue extends me{constructor(){super(...arguments),this.align="left"}static get title(){return m.text("alignLeft")}}class he extends me{constructor(){super(...arguments),this.align="center"}static get title(){return m.text("alignLeft")}}class pe extends me{constructor(){super(...arguments),this.align="right"}static get title(){return m.text("alignLeft")}}class ge{set data(e){const t=l(":scope > *",this.block.holder);this._data=e,this.wrap(t),this.block.dispatchChange(),b("change",t)}get data(){return this._data}static get isTune(){return!0}constructor({api:e,data:t,config:a,block:i}){this.api=e,this.config=a,this.block=i,this._data=this.prepareData(null!=t?t:null)}sanitize(e){return e}render(){const e=this.renderLabel();return{icon:this.icon,label:e?`${e}<span class="am-u-display-none">${this.title}</span>`:`<span class="am-u-text-muted">${this.title}</span>`,closeOnActivate:!0,onActivate:this.onActivate.bind(this)}}onActivate(){const{modal:e,body:t}=tt(this.title);t.appendChild(this.createForm()),v(t,"change",(()=>{this.data=this.sanitize(this.getFormData(t))})),setTimeout((()=>{e.open()}),0)}save(){return this.data}wrap(e){return e}}class be extends ge{get title(){return m.text("className")}get icon(){return'<i class="bi bi-asterisk"></i>'}prepareData(e){return null!=e?e:""}sanitize(e){return(e||"").replace(/[^\w_\s]+/g,"-").trim()}getFormData(e){const{className:t}=dt(e);return t}createForm(){return Qe("am-input",null,{label:this.title,value:this.data,key:na(),name:"className"},[],{pattern:"[\\w\\-\\s_:]*"})}renderLabel(){return this.data?ft`<span class="am-e-badge">$${this.data}</span>`:""}wrap(e){var t;return(null!==(t=l(".__class",e))&&void 0!==t?t:i("span",["__class"],{},e,"",!0)).innerHTML=this.data?ft`<span class="am-e-badge"> .${this.data.replace(/\s+/g,".")} </span>`:"",e}}class ve extends ge{get title(){return"ID"}get icon(){return'<span style="font-size: 1.2rem">#</span>'}prepareData(e){return null!=e?e:""}sanitize(e){return(e||"").replace(/[^\w_]+/g,"-").trim()}getFormData(e){const{id:t}=dt(e);return t}createForm(){return Qe("am-input",null,{label:this.title,value:this.data,key:na(),name:"id"},[],{pattern:"[\\w\\-_]*"})}renderLabel(){return this.data?ft`<span class="am-e-badge">$${this.data}</span>`:""}wrap(e){var t;return(null!==(t=l(".__id",e))&&void 0!==t?t:i("span",["__id"],{},e,"",!0)).innerHTML=this.data?ft`<span class="am-e-badge">#${this.data}</span>`:"",e}}class fe extends ge{get title(){return m.text("padding")}get icon(){return'<i class="bi bi-distribute-vertical"></i>'}prepareData(e){return{top:(null==e?void 0:e.top)||"",right:(null==e?void 0:e.right)||"",bottom:(null==e?void 0:e.bottom)||"",left:(null==e?void 0:e.left)||""}}sanitize(e){const t=e=>e.replace(/[^\w_\.]+/g,"").trim();return{top:t(e.top),right:t(e.right),bottom:t(e.bottom),left:t(e.left)}}getFormData(e){return dt(e)}createForm(){const e=i("div",["am-u-flex","am-u-flex--column","am-u-flex--gap-large"],{},null,ft`<div class="am-u-flex am-u-flex--gap-large"><div class="top"></div><div class="bottom"></div></div><div class="am-u-flex am-u-flex--gap-large"><div class="left"></div><div class="right"></div></div>`);return Qe("am-number-unit",l(".top",e),{label:m.text("paddingTop"),value:this.data.top,key:na(),name:"top"}),Qe("am-number-unit",l(".bottom",e),{label:m.text("paddingBottom"),value:this.data.bottom,key:na(),name:"bottom"}),Qe("am-number-unit",l(".left",e),{label:m.text("paddingLeft"),value:this.data.left,key:na(),name:"left"}),Qe("am-number-unit",l(".right",e),{label:m.text("paddingRight"),value:this.data.right,key:na(),name:"right"}),e}renderLabel(){const{top:e,right:t,bottom:a,left:i}=this.data;return`${e||0} / ${t||0} / ${a||0} / ${i||0}`}wrap(e){const t={top:"paddingTop",right:"paddingRight",bottom:"paddingBottom",left:"paddingLeft"},a=l(":scope > .cdx-block",e);for(const[e,i]of Object.entries(this.data))a.style[t[e]]=i;return e}}var xe=a(9931),ye=a(5660),we=a.n(ye);const ke={pattern:/('([^']|\\')*'|"([^"]|\\")*")/},_e={pattern:new RegExp("@{.+}","s"),greedy:!0,inside:{punctuation:/[\|\(\)\{\}]+/,string:ke}},$e=we().languages.extend("html",{comment:{pattern:new RegExp("<#.+?#>","s")},function:{pattern:new RegExp("<@.+?@>","s"),inside:{keyword:{pattern:/(for|foreach|if|else|end|snippet|with)/},boolean:{pattern:/(true|false)/},property:{pattern:/[\w\:]+\:/},variable:_e,string:ke,punctuation:{pattern:/[\:\{\}\(\)]/}}},number:{pattern:/\d(.\d+)?/},operator:{pattern:/([\+\-\/\*\!]|not)/},tag:{pattern:/<\/?(?!\d)[^\s@>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},variable:_e});a(6854),a(7533),a(4446),a(4279),a(9016),a(2731),a(7046),a(110),a(7117),a(2503),a(2356),a(319),a(7802),a(6841),a(4064),a(3436),a(9945),a(366),a(9385),a(767),a(9865),a(7874),a(5266),a(1029),a(6836),a(4438),a(3358);const Ce=["apacheconf","automad","bash","basic","c","clike","csharp","cpp","css","go","graphql","handlebars","html","java","javascript","jsx","latex","less","lua","markdown","nginx","none","php","powershell","python","ruby","rust","sass","sql","tsx","typescript","vim","yaml"];we().languages.automad=$e;class Te{constructor(e,t,a,i=(()=>{})){e.innerHTML="",this.codeFlask=new xe.Z(e,{lineNumbers:!1,defaultTheme:!1,handleTabs:!0,handleNewLineIndentation:!0,handleSelfClosingCharacters:!0,tabSize:2,language:a}),this.codeFlask.addLanguage(a,we().languages[a]),this.codeFlask.updateCode(t),yt().log("Prism:",a,we().languages[a]),this.codeFlask.onUpdate(o((()=>{i(this.codeFlask.getCode())}),20))}}class Ae extends k{static get enableLineBreaks(){return!0}static get sanitize(){return{code:!0}}static get toolbox(){return{title:m.text("code"),icon:'<i class="bi bi-code-slash"></i>'}}prepareData(e){var t,a,i;return{code:null!==(t=e.code)&&void 0!==t?t:"",language:null!==(a=e.language)&&void 0!==a?a:"none",lineNumbers:null!==(i=e.lineNumbers)&&void 0!==i&&i}}render(){this.wrapper.classList.add("am-u-flex","am-u-flex--column","am-u-flex--gap"),i("span",["am-u-text-muted","am-u-user-select-none"],{},this.wrapper,ft`<am-icon-text am-icon="code-slash" am-text="${Ae.toolbox.title}"></am-icon-text>`);const e=i("div",["am-u-flex","am-u-flex--column","am-u-flex--gap"],{},this.wrapper),t=i("div",["am-l-grid","am-l-grid--auto","am-u-flex--gap"],{},e);nt(Ce.map((e=>({value:e}))),this.data.language,t,"language");const a=na();i("div",["am-f-toggle","am-f-toggle--button"],{},t,ft`<input id="${a}" type="checkbox" name="lineNumbers" value="1" ${this.data.lineNumbers?"checked":""} /><label for="${a}"><i class="bi"></i><span>${m.text("codeBlockLineNumbers")}</span></label>`);const s=i("div",["am-c-ed-bl-code"],{},e);return this.api.listeners.on(t,"change",(()=>{const{language:e,lineNumbers:a}=dt(t);this.data.lineNumbers=a,this.data.language=e,this.initEditor(s)})),this.initEditor(s),this.wrapper}initEditor(e){this.editor=new Te(e,this.data.code,this.data.language,(e=>{this.data.code=e})),this.api.listeners.on(l("textarea",e),"keydown",(e=>{e.stopImmediatePropagation()}))}save(){return{code:this.editor.codeFlask.getCode(),language:this.data.language,lineNumbers:this.data.lineNumbers}}}class Le extends k{static get enableLineBreaks(){return!0}static get sanitize(){return{code:!0}}static get toolbox(){return{title:m.text("rawHtmlMarkdown"),icon:'<i class="bi bi-markdown"></i>'}}prepareData(e){var t;return{code:null!==(t=e.code)&&void 0!==t?t:""}}render(){this.wrapper.classList.add("am-u-flex","am-u-flex--column","am-u-flex--gap"),i("span",["am-u-text-muted","am-u-user-select-none"],{},this.wrapper,ft`<am-icon-text am-icon="markdown" am-text="${Le.toolbox.title}"></am-icon-text>`);const e=i("div",["am-c-ed-bl-code"],{},this.wrapper);return this.initEditor(e),this.wrapper}initEditor(e){this.editor=new Te(e,this.data.code,"html",(e=>{this.data.code=e})),this.api.listeners.on(l("textarea",e),"keydown",(e=>{e.stopImmediatePropagation()}))}save(){return{code:this.editor.codeFlask.getCode()}}}var Ee=a(1474);class Se extends x{get images(){var e,t;return null!==(t=null===(e=this.sortable)||void 0===e?void 0:e.toArray())&&void 0!==t?t:[]}set images(e){this.render(e)}connectedCallback(){this.classList.add("am-c-image-collection")}render(e){this.removeListeners(),this.innerHTML="";const t=i("div",["am-c-image-collection__grid"],{},this);e.forEach((e=>{const a=i("div",["am-c-image-collection__item"],{"data-url":e,title:e},t,ft`<am-img src="${Wt(e)}" class="am-c-image-collection__image"></am-img>`),s=i("span",["am-c-image-collection__delete"],{},a);this.addListener(v(s,"click",(()=>{a.remove(),b("change",this)})))})),this.sortable=new Ee.ZP(t,{dataIdAttr:"data-url",dragoverBubble:!1,ghostClass:"am-c-image-collection__item--ghost",dragClass:"am-c-image-collection__item--drag",chosenClass:"am-c-image-collection__item--chosen",animation:300,onSort:()=>{b("change",this)}}),this.addListener(v(t,"dragover",(e=>{e.preventDefault(),e.stopPropagation()}))),this.addListener(v(t,"click",(e=>{e.target===t&&this.add()})));const a=i("button",["am-e-button","am-c-image-collection__add"],{},this,m.text("addImage"));this.addListener(v(a,"click",this.add.bind(this)))}add(){at((e=>{this.images=[...this.images,e],b("change",this)}),m.text("addImage"))}}Se.TAG_NAME="am-image-collection",customElements.define(Se.TAG_NAME,Se);class Pe extends k{static get sanitize(){return{layout:!1,columnWidthPx:!1,rowHeightPx:!1,gapPx:!1}}static get toolbox(){return{title:m.text("galleryBlockTitle"),icon:'<i class="bi bi-columns"></i>'}}prepareData(e){var t;return{files:e.files||[],layout:e.layout||"columns",columnWidthPx:e.columnWidthPx||250,rowHeightPx:e.rowHeightPx||250,gapPx:e.gapPx||5,cleanBottom:null!==(t=e.cleanBottom)&&void 0!==t&&t}}render(){this.wrapper.classList.add("am-u-flex","am-u-flex--column","am-u-flex--gap"),i("span",["am-u-text-muted","am-u-user-select-none"],{},this.wrapper,ft`<am-icon-text am-icon="columns" am-text="${Pe.toolbox.title}"></am-icon-text>`);const e=i("div",["am-c-image-collection-group"],{},this.wrapper),t=i("button",["am-e-button"],{},e,m.text("galleryBlockLayout"));this.api.listeners.on(t,"click",this.renderModal.bind(this));const a=i(Se.TAG_NAME,[],{},e);return setTimeout((()=>{a.images=this.data.files,this.api.listeners.on(a,"change",(()=>{this.data.files=a.images,this.blockAPI.dispatchChange()}))}),0),this.wrapper}renderModal(){const{modal:e,body:t}=tt(m.text("galleryBlockLayout"));setTimeout((()=>{this.renderLayoutSettings(t),e.open()}),0),v(e,"change",(()=>{this.data=Object.assign(Object.assign(Object.assign({},this.data),{cleanBottom:!1}),dt(e))})),v(e,"AutomadModalClose",(()=>{this.blockAPI.dispatchChange()}))}renderLayoutSettings(e){e.innerHTML="";const t=nt([{text:m.text("galleryBlockLayoutColumns"),value:"columns"},{text:m.text("galleryBlockLayoutRows"),value:"rows"}],this.data.layout,e,"layout"),a=i("div",["am-l-grid","am-l-grid--auto"],{},e);Qe("am-number",a,{name:"gapPx",value:this.data.gapPx,key:na(),label:`${m.text("galleryBlockLayoutGap")} (Pixel)`},[],{required:""}),"rows"==this.data.layout?Qe("am-number",a,{name:"rowHeightPx",value:this.data.rowHeightPx,key:na(),label:`${m.text("galleryBlockLayoutRowHeight")} (Pixel)`},[],{required:""}):(Qe("am-number",a,{name:"columnWidthPx",value:this.data.columnWidthPx,key:na(),label:`${m.text("galleryBlockLayoutColumnWidth")} (Pixel)`},[],{required:""}),Qe("am-toggle",e,{name:"cleanBottom",value:this.data.cleanBottom,key:na(),label:m.text("galleryBlockLayoutCleanBottom")}));const s=v(t,"change",(()=>{s.remove(),this.data.layout=t.value,this.renderLayoutSettings(e)}))}save(){return this.data}}const Ie=["slide","fade","cube","flip"],Me=e=>{const t={};return e.split(" ").forEach((e=>{const[a,i]=e.split(":");a&&i&&(t[a]={slidesPerView:parseInt(i)})})),t};class Re extends k{static get sanitize(){return{effect:!1}}static get toolbox(){return{title:m.text("imageSlideshowBlockTitle"),icon:'<i class="bi bi-collection-play"></i>'}}prepareData(e){var t,a,i,s;return{files:e.files||[],imageWidthPx:e.imageWidthPx||1200,imageHeightPx:e.imageHeightPx||780,gapPx:e.gapPx||30,slidesPerView:e.slidesPerView||1,loop:null===(t=e.loop)||void 0===t||t,autoplay:null!==(a=e.autoplay)&&void 0!==a&&a,effect:null!==(i=e.effect)&&void 0!==i?i:"slide",breakpoints:null!==(s=e.breakpoints)&&void 0!==s?s:{600:{slidesPerView:2},900:{slidesPerView:3}}}}render(){this.wrapper.classList.add("am-u-flex","am-u-flex--column","am-u-flex--gap"),i("span",["am-u-text-muted","am-u-user-select-none"],{},this.wrapper,ft`<am-icon-text am-icon="collection-play" am-text="${Re.toolbox.title}"></am-icon-text>`);const e=i("div",["am-c-image-collection-group"],{},this.wrapper),t=i("button",["am-e-button"],{},e,m.text("imageSlideshowBlockSettings"));this.api.listeners.on(t,"click",this.renderModal.bind(this));const a=i(Se.TAG_NAME,[],{},e);return setTimeout((()=>{a.images=this.data.files,this.api.listeners.on(a,"change",(()=>{this.data.files=a.images,this.blockAPI.dispatchChange()}))}),0),this.wrapper}renderModal(){const{modal:e,body:t}=tt(m.text("imageSlideshowBlockSettings"));setTimeout((()=>{this.renderSliderSettings(t),e.open()}),0),v(e,"change",(()=>{var t,a;const i=dt(e);this.data={files:this.data.files,imageWidthPx:i.imageWidthPx,imageHeightPx:i.imageHeightPx,gapPx:i.gapPx,slidesPerView:i.slidesPerView,loop:null!==(t=i.loop)&&void 0!==t&&t,autoplay:null!==(a=i.autoplay)&&void 0!==a&&a,effect:i.effect,breakpoints:Me(i.breakpointsString)}})),v(e,"AutomadModalClose",(()=>{this.blockAPI.dispatchChange()}))}renderSliderSettings(e){e.innerHTML="",ot(m.text("imageSlideshowBlockEffect"),nt(Ie.map((e=>({value:e}))),this.data.effect,null,"effect"),e),Qe("am-toggle",e,{name:"loop",value:this.data.loop,key:na(),label:m.text("imageSlideshowBlockLoop")}),Qe("am-toggle",e,{name:"autoplay",value:this.data.autoplay,key:na(),label:m.text("imageSlideshowBlockAutoplay")});const t=i("div",["am-l-grid","am-l-grid--auto"],{},e),a=i("div",["am-l-grid","am-l-grid--auto"],{},e);var s;Qe("am-number",t,{name:"imageWidthPx",value:this.data.imageWidthPx,key:na(),label:`${m.text("imageSlideshowBlockImageWidth")} (Pixel)`},[],{required:""}),Qe("am-number",t,{name:"imageHeightPx",value:this.data.imageHeightPx,key:na(),label:`${m.text("imageSlideshowBlockImageHeight")} (Pixel)`},[],{required:""}),Qe("am-number",a,{name:"slidesPerView",value:this.data.slidesPerView,key:na(),label:m.text("imageSlideshowBlockSlidesPerView")},[],{required:""}),Qe("am-number",a,{name:"gapPx",value:this.data.gapPx,key:na(),label:`${m.text("imageSlideshowBlockSpaceBetween")} (Pixel)`},[],{required:""}),i("div",["am-c-field"],{"am-error":m.text("imageSlideshowBlockBreakpointsError")},e,ft`<label class="am-c-field__label"> ${m.text("imageSlideshowBlockBreakpoints")} &mdash; <span class="am-u-text-mono">px:slides px:slides ...</span></label><input class="am-f-input am-u-text-mono" type="text" value="${s=this.data.breakpoints,Object.keys(s).reduce(((e,t)=>`${e} ${t}:${s[t].slidesPerView}`.trim()),"")}" name="breakpointsString" placeholder="600:2 900:3" pattern="([1-9][0-9]+:[0-9]+( |$))*" />`),i("p",[],{},e,m.text("imageSlideshowBlockBreakpointsHelp"))}save(){return this.data}}class He extends k{static get sanitize(){return{primaryText:{},primaryLink:!0,secondaryText:{},secondaryLink:!0}}static get toolbox(){return{title:m.text("buttonsBlockTitle"),icon:'<i class="bi bi-hand-index-thumb"></i>'}}prepareData(e){var t,a,i,s,n,o;const l={borderWidth:"2px",borderRadius:"0.5rem",paddingHorizontal:"1.5rem",paddingVertical:"0.5rem"};return{primaryText:e.primaryText||"Button",primaryLink:e.primaryLink||"",primaryStyle:null!==(t=e.primaryStyle)&&void 0!==t?t:l,primaryOpenInNewTab:null===(a=e.primaryOpenInNewTab)||void 0===a||a,secondaryText:e.secondaryText||"",secondaryLink:e.secondaryLink||"",secondaryStyle:null!==(i=e.secondaryStyle)&&void 0!==i?i:l,secondaryOpenInNewTab:null===(s=e.secondaryOpenInNewTab)||void 0===s||s,justify:null!==(n=e.justify)&&void 0!==n?n:"start",gap:null!==(o=e.gap)&&void 0!==o?o:"1rem"}}render(){this.wrapper.classList.add("am-u-flex"),this.wrapper.innerHTML=ft`<div class="am-c-ed-bl-buttons"><div><span class="__layout-edit am-c-ed-bl-buttons__edit"><am-icon-text am-icon="arrow-left-right" am-text="${m.text("buttonsBlockAlignment")}"></am-icon-text></span></div><div class="__flex am-u-flex"><div class="am-u-flex am-u-flex--column am-u-flex--gap am-u-flex--center"><div class="__primary"></div><span class="__primary-edit am-c-ed-bl-buttons__edit"><am-icon-text am-icon="sliders" am-text="${m.text("buttonsBlockSettings")}"></am-icon-text></span></div><div class="am-u-flex am-u-flex--column am-u-flex--gap am-u-flex--center"><div class="__secondary"></div><span class="__secondary-edit am-c-ed-bl-buttons__edit"><am-icon-text am-icon="sliders" am-text="${m.text("buttonsBlockSettings")}"></am-icon-text></span></div></div></div>`;const e=l(".__layout-edit",this.wrapper),t=l(".__primary-edit",this.wrapper),a=l(".__secondary-edit",this.wrapper);return this.flex=l(".__flex",this.wrapper),this.previews={primary:null,secondary:null},this.previews.primary=l(".__primary",this.wrapper),this.previews.secondary=l(".__secondary",this.wrapper),this.renderButton("primary"),this.renderButton("secondary"),this.updateLayout(),this.api.listeners.on(e,"click",this.renderLayoutModal.bind(this)),this.api.listeners.on(t,"click",(()=>{this.renderButtonModal("primary")})),this.api.listeners.on(a,"click",(()=>{this.renderButtonModal("secondary")})),this.wrapper}updateLayout(){this.wrapper.style.justifyContent=this.data.justify,this.flex.style.gap=this.data.gap}renderButton(e){const t=this.data[`${e}Text`],a=this.data[`${e}Style`],s=Object.keys(a).reduce(((e,t)=>a[t]?`${e} --${t}: ${a[t]};`.trim():""),"");this.previews[e].innerHTML=i("div",["am-c-ed-bl-buttons__button"],{style:s,name:`${e}Text`,contenteditable:"true",placeholder:m.text("buttonsBlockPlaceholder")},null,ft`${t}`).outerHTML}renderLayoutModal(){const{modal:e,body:t}=tt(m.text("buttonsBlockAlignment")),a=i("div",["am-l-grid","am-l-grid--auto"],{},t);ot(m.text("buttonsBlockAlignment"),nt([{text:m.text("alignLeft"),value:"start"},{text:m.text("alignCenter"),value:"center"},{text:m.text("alignRight"),value:"end"}],this.data.justify,null,"justify"),a),Qe("am-number-unit",a,{name:"gap",value:this.data.gap,key:na(),label:m.text("buttonsBlockGap")}),setTimeout((()=>{e.open()}),0),this.api.listeners.on(e,"change",o((()=>{this.data=Object.assign(Object.assign({},this.data),dt(t)),this.updateLayout(),this.blockAPI.dispatchChange()}),50))}renderButtonModal(e){const{modal:t,body:a}=tt(m.text("buttonsBlockSettings")),s=Qe("am-url",a,{name:`${e}Link`,key:na(),label:m.text("url"),value:this.data[`${e}Link`]}),n=Qe("am-toggle",a,{name:`${e}OpenInNewTab`,key:na(),label:m.text("openInNewTab"),value:this.data[`${e}OpenInNewTab`]}),l=i("div",[],{},a),r=(t,a,i,s=l,n=!1)=>{Qe(t,s,{name:a,key:na(),label:`${m.text(i)}${n?" (hover)":""}`,value:this.data[`${e}Style`][a]})};i("hr",[],{},l);const c=i("div",["am-l-grid","am-l-grid--auto"],{},l),d=i("div",[],{},c),u=i("div",[],{},c);r("am-color","color","color",d),r("am-color","background","backgroundColor",d),r("am-color","borderColor","borderColor",d),r("am-color","hoverColor","color",u,!0),r("am-color","hoverBackground","backgroundColor",u,!0),r("am-color","hoverBorderColor","borderColor",u,!0),i("hr",[],{},l);const h=i("div",["am-l-grid","am-l-grid--auto"],{},l);r("am-number-unit","borderWidth","borderWidth",h),r("am-number-unit","borderRadius","borderRadius",h),r("am-number-unit","paddingVertical","paddingVertical",h),r("am-number-unit","paddingHorizontal","paddingHorizontal",h),setTimeout((()=>{t.open()}),0),this.addListener(v(t,"change input",o((()=>{this.data=Object.assign(Object.assign({},this.data),{[`${e}Style`]:Object.fromEntries(Object.entries(dt(l)).filter((([e,t])=>t.length>0))),[`${e}Link`]:s.input.value,[`${e}OpenInNewTab`]:n.input.checked}),this.renderButton(e),this.blockAPI.dispatchChange()}),50)))}save(){return Object.assign(Object.assign({},this.data),{primaryText:l('[name="primaryText"]',this.flex).innerHTML,secondaryText:l('[name="secondaryText"]',this.flex).innerHTML})}}var Be=a(2534),Oe=a.n(Be);const Fe={codepen:{regex:/https?:\/\/codepen\.io\/([^\/\?\&]*)\/pen\/([^\/\?\&]*)/,embedUrl:"https://codepen.io/<%= remote_id %>?height=300&theme-id=0&default-tab=css,result&embed-version=2",html:"<iframe height='300' scrolling='no' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'></iframe>",height:300,width:600,id:e=>e.join("/embed/")},dailymotion:{regex:/https?:\/\/www\.dailymotion\.com\/video\/(\w+)(\?.*?)?$/,embedUrl:"https://www.dailymotion.com/embed/video/<%= remote_id %>/",html:'<iframe width="640" height="360" frameborder="0" allowFullScreen></iframe>',height:360,width:640},facebook:{regex:/https?:\/\/www.facebook.com\/([^\/\?\&]*)\/(.*)/,embedUrl:"https://www.facebook.com/plugins/post.php?href=https://www.facebook.com/<%= remote_id %>&width=500",html:"<iframe scrolling='no' frameborder='no' allowtransparency='true' allowfullscreen='true' style='margin: 0 auto; width: 500px; min-height: 500px; max-height: 1000px;'></iframe>",id:e=>e.join("/")},giphy:{regex:/https?:\/\/giphy\.com\/(?:gifs|videos)\/(?:[^\/]*\-)?([a-zA-Z0-9]+)$/,embedUrl:"https://giphy.com/embed/<%= remote_id %>/",html:'<iframe width="600" height="480" frameborder="0" allowFullScreen></iframe>',height:480,width:600},github:{regex:/https?:\/\/gist.github.com\/([^\/\?\&]*)\/([^\/\?\&]*)/,embedUrl:'data:text/html;charset=utf-8,<head><base target="_blank" /></head><body><script src="https://gist.github.com/<%= remote_id %>" ><\/script></body>',html:'<iframe width="100%" height="350" frameborder="0" style="margin: 0 auto;"></iframe>',height:300,width:600,id:e=>`${e.join("/")}.js`},imgur:{regex:/https?:\/\/(?:i\.)?imgur\.com.*\/([a-zA-Z0-9]+)(?:\.gifv)?/,embedUrl:"http://imgur.com/<%= remote_id %>/embed",html:'<iframe allowfullscreen="true" scrolling="no" id="imgur-embed-iframe-pub-<%= remote_id %>" class="imgur-embed-iframe-pub" style="height: 500px; width: 100%; border: 1px solid #000"></iframe>',height:500,width:540},instagram:{regex:/https?:\/\/www\.instagram\.com\/p\/([^\/\?\&]+)\/?/,embedUrl:"https://www.instagram.com/p/<%= remote_id %>/embed",html:'<iframe width="400" height="505" style="margin: 0 auto;" frameborder="0" scrolling="no" allowtransparency="true"></iframe>',height:505,width:400},mixcloud:{regex:/https?:\/\/www\.mixcloud\.com\/(.+)\/$/,embedUrl:"https://www.mixcloud.com/widget/iframe/?hide_cover=1&feed=/<%= remote_id %>/",html:'<iframe height="180" scrolling="no" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 100%;"></iframe>',height:180,width:0},soundcloud:{regex:/(https:\/\/soundcloud\.com\/.+)$/,embedUrl:"https://w.soundcloud.com/player/?url=<%= remote_id %>",html:'<iframe height="180" scrolling="no" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 100%;"></iframe>',height:180,width:0},twitter:{regex:/^https?:\/\/twitter\.com\/(?:#!\/)?(\w+)\/status(?:es)?\/(\d+)(?:\/.*)?$/,embedUrl:"https://twitframe.com/show?url=https://twitter.com/<%= remote_id %>",html:'<iframe width="500" height="500" style="display: block; width: 500px; border-bottom: 1px solid #E0E0E0; margin: 0 auto;" frameborder="0" scrolling="no" allowtransparency="true"></iframe>',height:0,width:0,id:e=>e.join("/status/")},vimeo:{regex:/(?:http[s]?:\/\/)?(?:www.)?vimeo\.co(?:.+\/([^\/]\d+)(?:#t=[\d]+)?s?$)/,embedUrl:"https://player.vimeo.com/video/<%= remote_id %>?title=0&byline=0",html:'<iframe style="width:100%;" height="320" frameborder="0"></iframe>',height:9,width:16},youtube:{regex:/(?:https?:\/\/)?(?:www\.)?(?:(?:youtu\.be\/)|(?:youtube\.com)\/(?:v\/|u\/\w\/|embed\/|watch))(?:(?:\?v=)?([^#&?=]*))?((?:[?&]\w*=\w*)*)/,embedUrl:"https://www.youtube.com/embed/<%= remote_id %>",html:'<iframe style="width: 100%; aspect-ratio: 16/9;" frameborder="0" allowfullscreen></iframe>',height:9,width:16,id:([e,t])=>{if(!t&&e)return e;const a={start:"start",end:"end",t:"start",time_continue:"start",list:"list"};return t=t.slice(1).split("&").map((t=>{const[i,s]=t.split("=");if(e||"v"!==i){if(a[i])return`${a[i]}=${s}`}else e=s})).filter((e=>!!e)),e+"?"+t.join("&")}}};class Ne extends k{static get conversionConfig(){return{export:"text",import:"text"}}static get pasteConfig(){return{tags:["H1","H2","H3","H4","H5","H6"]}}static get sanitize(){return{level:!1,text:{br:!0}}}static get enableLineBreaks(){return!1}static get toolbox(){return{title:m.text("heading"),icon:'<i class="bi bi-type-h1"></i>'}}prepareData(e){var t,a;return{text:null!==(t=e.text)&&void 0!==t?t:"",level:null!==(a=e.level)&&void 0!==a?a:2}}get content(){var e,t;return null!==(t=null===(e=l("[contenteditable]",this.wrapper))||void 0===e?void 0:e.innerHTML)&&void 0!==t?t:""}render(){return this.wrapper.innerHTML="",i("div",["am-c-ed-bl-header"],{contenteditable:"true"},i(`h${this.data.level}`,[],{},this.wrapper)).innerHTML=this.data.text,this.wrapper}save(){return{text:this.content,level:this.data.level}}renderSettings(){return[1,2,3,4,5,6].map((e=>({icon:ft`<i class="bi bi-type-h${e}"></i>`,label:`${m.text("heading")} ${e}`,closeOnActivate:!0,onActivate:()=>{this.data.level=e,this.data.text=this.content,this.render()},toggle:"level",isActive:this.data.level==e})))}merge(e){const t={text:this.data.text+e.text,level:this.data.level};this.data=t}validate(e){return""!==e.text.trim()}onPaste(e){var t;const a=e.detail.data;this.data={level:null!==(t=parseInt(a.tagName.replace("H","")))&&void 0!==t?t:2,text:a.textContent},this.render()}}class Ue extends k{static get conversionConfig(){return{export:"text",import:"text"}}static get pasteConfig(){return{tags:["P"]}}static get sanitize(){return{large:!1,text:{br:!0}}}static get enableLineBreaks(){return!1}static get toolbox(){return{title:m.text("textTool"),icon:'<i class="bi bi-text-paragraph"></i>'}}prepareData(e){var t,a;return{text:null!==(t=e.text)&&void 0!==t?t:"",large:null!==(a=e.large)&&void 0!==a&&a}}get content(){var e,t;return null!==(t=null===(e=l("[contenteditable]",this.wrapper))||void 0===e?void 0:e.innerHTML)&&void 0!==t?t:""}render(){return this.wrapper.innerHTML="",this.wrapper.classList.toggle("am-style--large",this.data.large),i("div",["am-c-ed-bl-paragraph"],{contenteditable:"true",placeholder:0===this.api.blocks.getBlocksCount()&&this.config.placeholder||""},this.wrapper).innerHTML=this.data.text,this.wrapper}save(){return{text:this.content,large:this.data.large}}renderSettings(){return{icon:'<i class="bi bi-capslock"></i>',label:m.text("large"),closeOnActivate:!1,onActivate:()=>{this.data.large=!this.data.large,this.wrapper.classList.toggle("am-style--large",this.data.large)},isActive:this.data.large,toggle:"large"}}merge(e){const t={text:this.data.text+e.text,large:this.data.large};this.data=t}validate(e){return""!==e.text.trim()}onPaste(e){const t={text:e.detail.data.innerHTML,large:!1};this.data=t}}var De=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};class je{static get isTune(){return!0}constructor({api:e,block:t}){this.api=e,this.block=t}render(){return{icon:'<i class="bi bi-copy"></i>',label:m.text("duplicate"),closeOnActivate:!0,onActivate:this.duplicate.bind(this)}}duplicate(){return De(this,void 0,void 0,(function*(){const e=this.api.blocks.getCurrentBlockIndex()+1;z(this.block,this.api,e)}))}}class qe extends k{static get sanitize(){return{to:!1,error:{},success:{},labelAddress:!1,labelSubject:!1,labelBody:!1,labelSend:!1}}static get toolbox(){return{title:m.text("mailBlockTitle"),icon:'<i class="bi bi-envelope"></i>'}}prepareData(e){return{to:e.to||m.user.email,error:e.error||"",success:e.success||"",labelAddress:e.labelAddress||"",labelSubject:e.labelSubject||"",labelBody:e.labelBody||"",labelSend:e.labelSend||""}}render(){return this.wrapper.classList.add("am-u-flex","am-u-flex--column","am-u-flex--gap"),this.wrapper.innerHTML=ft`<span class="am-u-text-muted am-u-user-select-none"><am-icon-text am-icon="envelope" am-text="${qe.toolbox.title}"></am-icon-text></span><div class="am-c-card"><div class="am-c-card__form"> ${Qe("am-email",null,{name:"to",key:na(),label:m.text("mailBlockTo"),value:this.data.to,placeholder:"you@domain.com"},[],{"am-error":m.text("emailRequiredError"),required:""}).outerHTML} <div class="am-l-grid am-l-grid--auto"> ${Qe("am-input",null,{name:"labelAddress",key:na(),label:m.text("mailBlockAddressFieldLabel"),value:this.data.labelAddress,placeholder:m.text("mailBlockDefaultLabelAddress")}).outerHTML} ${Qe("am-input",null,{name:"labelSubject",key:na(),label:m.text("mailBlockSubjectFieldLabel"),value:this.data.labelSubject,placeholder:m.text("mailBlockDefaultLabelSubject")}).outerHTML} </div><div class="am-l-grid am-l-grid--auto"> ${Qe("am-input",null,{name:"labelBody",key:na(),label:m.text("mailBlockBodyFieldLabel"),value:this.data.labelBody,placeholder:m.text("mailBlockDefaultLabelBody")}).outerHTML} ${Qe("am-input",null,{name:"labelSend",key:na(),label:m.text("mailBlockSendButtonLabel"),value:this.data.labelSend,placeholder:m.text("mailBlockDefaultLabelSend")}).outerHTML} </div> ${Qe("am-textarea",null,{name:"error",key:na(),label:m.text("mailBlockError"),value:this.data.error,placeholder:m.text("mailBlockDefaultError")}).outerHTML} ${Qe("am-textarea",null,{name:"success",key:na(),label:m.text("mailBlockSuccess"),value:this.data.success,placeholder:m.text("mailBlockDefaultSuccess")}).outerHTML} </div></div>`,this.wrapper}save(){return dt(this.wrapper)}}class ze extends k{static get toolbox(){return{title:m.text("tableOfContentsBlockTitle"),icon:'<i class="bi bi-list-columns"></i>'}}prepareData(e){var t;return{type:null!==(t=e.type)&&void 0!==t?t:"ordered"}}render(){return this.wrapper.innerHTML=ft`<div class="am-c-card"><div class="am-c-card__icon"><i class="bi bi-list-${"ordered"==this.data.type?"ol":"ul"}"></i></div><div class="am-c-card__title"> ${ze.toolbox.title} </div></div>`,this.wrapper}save(){return this.data}renderSettings(){return[{icon:'<i class="bi bi-list-ol"></i>',label:m.text("orderedList"),closeOnActivate:!0,onActivate:()=>{this.data.type="ordered",this.render()},toggle:"level",isActive:"ordered"==this.data.type},{icon:'<i class="bi bi-list-ul"></i>',label:m.text("unorderedList"),closeOnActivate:!0,onActivate:()=>{this.data.type="unordered",this.render()},toggle:"level",isActive:"unordered"==this.data.type}]}}const Ge=["all","children","related","siblings"],Ve="default";class We extends k{static get sanitize(){return{file:!1,filter:!1,matchUrl:!1,template:!1,sortField:!1,sortOrder:!1,type:!1}}static get toolbox(){return{title:m.text("pagelistBlockTitle"),icon:'<i class="bi bi-columns-gap"></i>'}}prepareData(e){var t,a,i,s,n,o;return{type:e.type||Ge[0],context:null!==(t=e.context)&&void 0!==t?t:"",excludeHidden:null===(a=e.excludeHidden)||void 0===a||a,excludeCurrent:null!==(i=e.excludeCurrent)&&void 0!==i&&i,matchUrl:e.matchUrl||"",filter:e.filter||"",template:e.template||"",limit:null!==(s=e.limit)&&void 0!==s?s:10,offset:e.offset||0,sortField:null!==(n=e.sortField)&&void 0!==n?n:":index",sortOrder:null!==(o=e.sortOrder)&&void 0!==o?o:"asc",file:e.file||Ve}}render(){return this.wrapper.classList.add("am-u-flex","am-u-flex--column","am-u-flex--gap"),this.wrapper.innerHTML=ft`<span class="am-u-text-muted am-u-user-select-none"><am-icon-text am-icon="columns-gap" am-text="${We.toolbox.title}"></am-icon-text></span><div class="am-c-card __card"></div>`,this.renderForm(l(".__card",this.wrapper)),v(this.wrapper,"change input",o((()=>{this.blockAPI.dispatchChange()}),50)),this.wrapper}renderForm(e){const t=m.files.pagelist.reduce(((e,t)=>[...e,{value:t,text:t}]),[{value:Ve,text:m.text("pagelistBlockDefaultFile")}]),a=Ge.reduce(((e,t)=>[...e,{value:t}]),[]),s=i("div",["am-c-card__form"],{},e),n=i("div",["am-c-card__form"],{},e);ot(m.text("pagelistBlockFile"),nt(t,this.data.file,null,"file"),s);const o=i("div",["am-l-grid","am-l-grid--auto"],{},n),r=i("div",["am-l-grid","am-l-grid--auto"],{},n),c=i("div",["am-l-grid","am-l-grid--auto"],{},n),d=(e,t)=>{const a=na();i("div",["am-f-toggle","am-f-toggle--button"],{},o,ft`<input id="${a}" type="checkbox" name="${e}" value="1" ${this.data[e]?"checked":""} /><label for="${a}"><i class="bi"></i><span>${t}</span></label>`)};d("excludeHidden",m.text("pagelistBlockExcludeHidden")),d("excludeCurrent",m.text("pagelistBlockExcludeCurrent")),i("div",["am-c-field"],{},r,ft`<div><label class="am-c-field__label"> ${m.text("pagelistBlockSortField")} </label></div><am-autocomplete name="sortField" value="${this.data.sortField}" am-data=":index, :path, date, title" am-min="0"></am-autocomplete>`),ot(m.text("pagelistBlockSortOrder"),nt([{value:"asc",text:"↑ asc"},{value:"desc",text:"↓ desc"}],this.data.sortOrder,null,"sortOrder"),r),ot(m.text("pagelistBlockType"),nt(a,this.data.type,null,"type"),r),Qe("am-url",r,{key:na(),name:"context",value:this.data.context,label:m.text("pagelistBlockContext")}),this.renderTagSelectField(r),i("div",["am-c-field"],{},r,ft`<div><label class="am-c-field__label"> ${m.text("pagelistBlockOffset")} / ${m.text("pagelistBlockLimit")} </label></div><div class="am-f-group"><input type="number" class="am-f-input am-f-group__item" name="offset" value="${this.data.offset}" /><input type="number" class="am-f-input am-f-group__item" name="limit" value="${this.data.limit}" /></div>`),Qe("am-input",c,{key:na(),name:"matchUrl",value:this.data.matchUrl,label:`${m.text("pagelistBlockFilterByUrl")} (Regex)`}),Qe("am-input",c,{key:na(),name:"template",value:this.data.template,label:`${m.text("pagelistBlockFilterByTemplate")} (Regex)`}),setTimeout((()=>{var e;null===(e=l(":focus",this.wrapper))||void 0===e||e.blur(),b("click",this.wrapper)}),50)}save(){const e=dt(this.wrapper);return Object.assign({excludeCurrent:!1,excludeHidden:!1},e)}renderTagSelectField(e){const t=()=>m.tags.reduce(((e,t)=>[...e,{value:t}]),[{value:"",text:"—"}]);let a=t();const{select:i}=ot(m.text("pagelistBlockFilter"),nt(a,this.data.filter,null,"filter"),e);this.addListener(v(window,"AutomadAppStateChange",(()=>{const e=i.value;i.options=t(),m.tags.includes(e)&&(i.value=e)})))}}const Je="default";class Ze extends k{static get sanitize(){return{file:!1,glob:!1,sortOrder:!1}}static get toolbox(){return{title:m.text("filelistBlockTitle"),icon:'<i class="bi bi-files"></i>'}}prepareData(e){var t;return{file:e.file||Je,glob:e.glob||"*.*",sortOrder:null!==(t=e.sortOrder)&&void 0!==t?t:"asc"}}render(){return this.wrapper.classList.add("am-u-flex","am-u-flex--column","am-u-flex--gap"),this.wrapper.innerHTML=ft`<span class="am-u-text-muted am-u-user-select-none"><am-icon-text am-icon="files" am-text="${Ze.toolbox.title}"></am-icon-text></span><div class="am-c-card __card"></div>`,this.renderForm(l(".__card",this.wrapper)),v(this.wrapper,"change input",o((()=>{this.blockAPI.dispatchChange()}),50)),this.wrapper}renderForm(e){const t=m.files.filelist.reduce(((e,t)=>[...e,{value:t,text:t}]),[{value:Je,text:m.text("filelistBlockDefaultFile")}]),a=i("div",["am-c-card__form"],{},e),s=i("div",["am-c-card__form"],{},e),n=i("div",["am-l-grid","am-l-grid--auto"],{},s);ot(m.text("filelistBlockFile"),nt(t,this.data.file,null,"file"),a),Qe("am-input",n,{key:na(),name:"glob",value:this.data.glob,label:`${m.text("filelistBlockPattern")} (Glob)`}),ot(m.text("filelistBlockSortOrder"),nt([{value:"asc",text:"↑ asc"},{value:"desc",text:"↓ desc"}],this.data.sortOrder,null,"sortOrder"),n)}save(){return dt(this.wrapper)}}class Ke extends k{static get sanitize(){return{file:!1,snippet:!0}}static get toolbox(){return{title:m.text("snippetBlockTitle"),icon:'<i class="bi bi-code-square"></i>'}}static get enableLineBreaks(){return!0}prepareData(e){return{file:e.file||"",snippet:e.snippet||""}}render(){return this.wrapper.classList.add("am-u-flex","am-u-flex--column","am-u-flex--gap"),this.wrapper.innerHTML=ft`<span class="am-u-text-muted am-u-user-select-none"><am-icon-text am-icon="files" am-text="${Ke.toolbox.title}"></am-icon-text></span><div class="am-c-card __card"></div>`,this.renderForm(l(".__card",this.wrapper)),v(this.wrapper,"change input",o((()=>{this.blockAPI.dispatchChange()}),50)),this.wrapper}renderForm(e){const t=m.files.snippets.reduce(((e,t)=>[...e,{value:t,text:t}]),[{value:"",text:"—"}]),a=i("div",["am-c-card__form"],{},e),s=i("div",["am-c-card__form"],{},e);Qe("am-textarea",a,{key:na(),name:"snippet",value:this.data.snippet,label:m.text("snippetBlockSnippet")}),ot(m.text("snippetBlockFile"),nt(t,this.data.file,null,"file"),s)}save(){return dt(this.wrapper)}}class Ye extends x{get baseTunes(){return["layout","spacing","className","id","duplicate"]}init(e,t,a){this.style.position="relative",this.classList.add("am-e-contents"),this.editor=new ee.Z(Object.assign({data:e,holder:this,logLevel:"ERROR",minHeight:50,autofocus:!1,placeholder:a?"":m.text("editorPlaceholder"),tools:Object.assign(Object.assign(Object.assign({},this.getBlockTools()),this.getBlockTunes(a)),this.getInlineTools()),tunes:this.baseTunes,inlineToolbar:["alignLeft","alignCenter","alignRight","bold","italic","fontSize","lineHeight","link","codeInline","underline","strikeThrough","color"],i18n:{messages:this.getI18nDictionary()},onReady:()=>{this.onRender()}},t))}getBlockTools(){return{paragraph:{class:Ue,inlineToolbar:!0},header:{class:Ne,inlineToolbar:!0},section:{class:S},nestedList:{class:oe,inlineToolbar:!0},table:{class:de,inlineToolbar:!0},quote:{class:le,inlineToolbar:!0},delimiter:te,image:{class:ie,inlineToolbar:!0},gallery:{class:Pe,inlineToolbar:!1},imageSlideshow:{class:Re,inlineToolbar:!1},buttons:{class:He,inlineToolbar:!0},tableOfContents:{class:ze},code:{class:Ae,inlineToolbar:!1},raw:{class:Le,inlineToolbar:!1},mail:{class:qe,inlineToolbar:!0},pagelist:{class:We},filelist:{class:Ze},snippet:{class:Ke,tunes:[]},embed:{class:Oe(),inlineToolbar:!0,config:{services:Fe}}}}getInlineTools(){return{alignLeft:{class:ue},alignCenter:{class:he},alignRight:{class:pe},bold:{class:I},italic:{class:O},link:{class:N},codeInline:{class:M},underline:{class:D},strikeThrough:{class:U},color:{class:R},fontSize:{class:B},lineHeight:{class:F}}}getBlockTunes(e){return{spacing:{class:fe},className:{class:be},id:{class:ve},layout:{class:Q,config:{isSectionBlock:e}},duplicate:{class:je}}}getI18nDictionary(){return{ui:{blockTunes:{toggler:{"Click to tune":m.text("tuneOrMove")}},inlineToolbar:{converter:{"Convert to":m.text("convertTo")}},toolbar:{toolbox:{Add:m.text("add")}}},toolNames:{},tools:{table:{"Add column to left":m.text("tableAddColumnLeft"),"Add column to right":m.text("tableAddColumnRight"),"Delete column":m.text("tableDeleteColumn"),"Add row above":m.text("tableAddRowAbove"),"Add row below":m.text("tableAddRowBelow"),"Delete row":m.text("tableDeleteRow")},embed:{"Enter a caption":m.text("caption")}},blockTunes:{delete:{Delete:m.text("delete"),"Click to delete":m.text("clickToDelete")},moveUp:{"Move up":m.text("moveUp")},moveDown:{"Move down":m.text("moveDown")}}}}onRender(){window.requestIdleCallback((()=>{new Z(this)}))}}Ye.TAG_NAME="am-editor-js",customElements.define(Ye.TAG_NAME,Ye);const Xe=(e,t,a,s)=>{const n=i(Ye.TAG_NAME,[],{},e);return n.init(t,a,s),n},Qe=(e,t,a,s=[],n={},o=!1)=>{const l=i(e,s,n,o?i("am-modal-field",[],{"am-page":Gt(),"am-no-click":""},t):t);return l.data=a,l},et=e=>{const t=t=>i("am-switcher-section",[],{name:t},e);return{settings:t("settings"),text:t("text"),colors:t("colors")}},tt=(e,t=m.text("ok"),a=!0)=>{const s={};a&&(s["am-destroy"]="");const n=i(y.TAG_NAME,[],s,ea(),ft`<am-modal-dialog><am-modal-header>${e}</am-modal-header><am-modal-body></am-modal-body><am-modal-footer><am-modal-close class="am-e-button am-e-button--primary"> ${t} </am-modal-close></am-modal-footer></am-modal-dialog>`);return{modal:n,body:l("am-modal-body",n),button:l("am-modal-footer button",n)}},at=(e,t,a="")=>{const s=i(y.TAG_NAME,[],{"am-destroy":""},ea()),n=`imagePickerModal-temp-${na()}`,o=na(),r=na(),c=na(),d=Gt();new u(n,{onChange:t=>{const a=l(`#${r}`),i=l(`#${c}`),o=a.value,d=i.value,m=o&&d&&!t.match(/\:\/\//)?`?${o}x${d}`:"";e(`${t}${m}`),p.delete(n),s.close()}});const h=d?ft`<am-image-picker am-page="${d}" am-label="${m.text("pageImages")}" am-binding-name="${n}"></am-image-picker>`:"";i("am-modal-dialog",["am-c-modal__dialog--large"],{},s,ft`<am-modal-header>${t}</am-modal-header><am-modal-body><span class="am-f-group"><input id="${o}" type="text" class="am-f-input am-f-group__item" value="${a}" placeholder="${m.text("url")}" /><button class="am-e-button am-f-group__item"> ${m.text("ok")} </button></span><hr /><div class="am-u-flex am-u-flex--gap"><div class="am-u-flex__item-grow"><div class="am-c-field"><label class="am-c-field__label"> ${m.text("resizeWidthTitle")} </label><input type="number" class="am-f-input" id="${r}" /></div></div><div class="am-u-flex__item-grow"><div class="am-c-field am-u-flex__item-grow"><label class="am-c-field__label"> ${m.text("resizeHeightTitle")} </label><input type="number" class="am-f-input" id="${c}" /></div></div></div> ${h} <am-image-picker am-label="${m.text("sharedImages")}" am-binding-name="${n}"></am-image-picker></am-modal-body>`),v(l("button",s),"click",(()=>{const t=l(`#${o}`,s);e(t.value),p.delete(n),s.close()})),setTimeout((()=>{s.open()}),0)},it=(e,t)=>{const a=i(y.TAG_NAME,[],{"am-destroy":""},ea()),s=i("am-modal-dialog",[],{},a,ft`<am-modal-header>$${t}</am-modal-header>`),n=i("am-modal-body",[],{},s),o=i("am-modal-footer",[],{},s),l=p.get(e),r=i("am-autocomplete-url",[],{},n);i("am-modal-close",["am-e-button"],{},o,m.text("cancel"));const c=i("button",["am-e-button","am-e-button--primary"],{},o,m.text("ok"));v(a,"AutomadModalOpen",(()=>{r.input.value=""}));const d=()=>{l.value=r.input.value,a.close()};v(r,"AutomadAutocompleteSelect",d),v(c,"click",d),setTimeout((()=>{a.open()}),0)},st=e=>{const t=i(y.TAG_NAME,[],{"am-no-esc":"","am-no-click":"","am-destroy":""},ea());return t.innerHTML=ft`<am-modal-dialog><span class="am-c-modal__spinner"><span class="am-c-modal__spinner-icon"></span><span class="am-c-modal__spinner-text">${e}</span></span></am-modal-dialog>`,t},nt=(e,t,a=null,s=null,n=null,o="",l=[],r={})=>{const c=i(w.TAG_NAME,l,{},a);return s&&(r.name=s),n&&(r.id=n),c.init(e,t,o,r),c},ot=(e,t,a)=>{const s=i("div",["am-c-field"],{},a,ft`<div><label class="am-c-field__label">${e}</label></div>`);return s.appendChild(t),{select:t,field:s}};class lt{static get selector(){return this._controls.map((e=>`${e}:not(:scope am-editor ${e})`)).join(", ")}static add(e){this._controls.includes(e)||this._controls.push(e)}}lt._controls=["input","textarea","select"];const rt=e=>sa(e.replace("+","")).replace("Color ","").replace("Checkbox ",""),ct=({section:e,fields:t,tooltips:a,shared:s})=>{if(0==Object.values(t).length)return void i("am-alert",[],{"am-icon":"slash-circle","am-text":m.text("sectionHasNoFields")},e);const n=mt(!!s);Object.keys(t).forEach((i=>{if(Object.values(m.reservedFields).includes(i)||i.startsWith(":"))return;let o="am-textarea",l="";for(const[e,t]of Object.entries(n))if(i.startsWith(e)){o=t;break}s&&(l=s[i]),Qe(o,e,{key:i,value:t[i],tooltip:a[i],name:`data[${i}]`,placeholder:l},[],{},["am-editor","am-markdown"].includes(o))}))},dt=e=>{const t={};return r(lt.selector,e).forEach((e=>{const a=e.getAttribute("type"),i=e.getAttribute("name"),s=["checkbox","radio"].includes(a);if((!s||e.checked)&&i){let a=!(!s||"1"!==e.value)||e.value;"string"==typeof a&&(a=a.trim()),t[i]=a}})),t},mt=e=>({"+":"am-editor",checkbox:e?"am-toggle-select":"am-toggle",color:"am-color",date:"am-date",text:"am-markdown",image:"am-image-select",url:"am-url"}),ut=e=>{const t={settings:{},text:{},colors:{}};return Object.keys(e).forEach((a=>{switch(a.match(/^(\+|text|color|.)/)[1]){case"+":case"text":t.text[a]=e[a];break;case"color":t.colors[a]=e[a];break;default:t.settings[a]=e[a]}})),t},ht=(e,t)=>{e&&(r('[type="radio"], [type="input"]').forEach((e=>{e.checked=!1})),Object.keys(e).forEach((a=>{const i=l(`[name="${a}"]`,t);if(i){const t=i.getAttribute("type");["checkbox","radio"].includes(t)?i.checked=!0:i.value=e[a]}})))},pt=e=>{v(e,"keydown",(t=>{if(9===t.keyCode){t.preventDefault(),t.stopPropagation();const a=e.selectionStart,i=e.selectionEnd,s=e.value;e.value=`${s.substring(0,a)}\t${s.substring(i)}`,e.selectionStart=a+1,e.selectionEnd=a+1}}))};var gt=a(7856),bt=a.n(gt);const vt={CUSTOM_ELEMENT_HANDLING:{tagNameCheck:/^(am|sortable)-/,attributeNameCheck:/^am-/,allowCustomizedBuiltInElements:!0},ADD_ATTR:["am-bind","am-bind-to","am-publication-state","am-tooltip","am-tooltip-options","am-toggle","target"],ADD_URI_SAFE_ATTR:["am-tooltip-options"],SANITIZE_DOM:!1},ft=(e,...t)=>{let a=e.raw,i="";return t.forEach(((e,t)=>{let s=a[t];s.endsWith("$")&&(e=xt(e),s=s.slice(0,-1)),i+=s+e})),i+=a[a.length-1],bt().sanitize(i,vt)},xt=e=>{const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","/":"&#8203;/&#8203;"};return e.toString().replace(/[&<>"'\/]/g,(e=>t[e]))},yt=()=>new wt;class wt{error(...e){console.error(...e)}log(){}request(){}response(){}bindingInfo(){}bindingSuccess(){}}var kt=a(8588),_t=a.n(kt);const $t={close:!1,gravity:"top",position:"right",stopOnFocus:!0,escapeMarkup:!1,destination:null},Ct=({message:e,icon:t,duration:a,className:s})=>{const n=l("html.am-ui > body, body .am-ui"),o=i("div",["am-c-notify__node"],{});i("i",["am-c-notify__icon","bi",`bi-${t}`],{},o),i("span",["am-c-notify__text"],{},o).innerHTML=e,i("span",["am-c-notify__close"],{},o);const r=_t()(Object.assign($t,{node:o,duration:a,className:null!=s?s:"am-c-notify",selector:n,onClick:function(){r.hideToast()}}));r.showToast()},Tt=e=>{Ct({message:e,duration:-1,icon:"x-circle",className:"am-c-notify am-c-notify--danger"})},At=(e,t=3e3)=>{Ct({message:e,duration:t,icon:"check-circle"})};var Lt=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};const Et=()=>l('meta[name="csrf"]').content||"",St=e=>{const t={};return Object.keys(e).forEach((a=>{((e,t,a)=>{const i=t.split(/(\[[^\[\]]*\])/g).filter((e=>e)).map((e=>e.replace(/[\[\]]/g,"")));let s=e;i.forEach(((e,t)=>{const n=e||Object.keys(s).length||0;i.length===t+1?"string"==typeof a?a.length&&(s[n]=a):s[n]=a:(s[n]=s[n]||{},s=s[n])}))})(t,a,e[a])})),t},Pt=(e,t=null,a=!0,i=null,n=!1)=>Lt(void 0,void 0,void 0,(function*(){if(!a)for(;!Mt.idle;)yield It();Mt.add();let o,l=(null==t?void 0:t.formData)||t;l&&(l=St(l));const r=new AbortController,c=v(window,"AutomadBeforeUpdateView",(()=>{n&&r.abort(),c.remove()})),d=s(e);try{const e=yield((e,t=null,a=null)=>Lt(void 0,void 0,void 0,(function*(){const i={method:"GET",signal:a};if(null!==t){const e=new FormData;e.append("__csrf__",Et()),e.append("__json__",JSON.stringify(t)),i.method="POST",i.body=e,i.headers={}}return fetch(e,i)})))(`${m.apiURL}/${d}`,l,r.signal);o=yield e.json(),"function"==typeof i&&i.apply(this,[o])}catch(e){e.message.includes("aborted")||Tt(`${m.text("fetchingDataError")} (${d})`),o={code:500,time:0}}c.remove(),Mt.remove();const u=yt();return u.request(e,l),u.response(e,o),void 0!==o.exception&&(Tt(o.exception.message),u.error(e,o.exception)),o})),It=()=>Lt(void 0,void 0,void 0,(function*(){return new Promise(((e,t)=>{const a=()=>{Mt.idle&&(e(!0),window.removeEventListener(Mt.EVENT_NAME,a))};window.addEventListener(Mt.EVENT_NAME,a),a()}))}));class Mt{static get idle(){return this.count<=0}static add(){l("am-spinner")||i("am-spinner",[],{},document.body),this.count++,b(this.EVENT_NAME)}static remove(){const e=l("am-spinner");this.count--,this.idle&&e&&e.remove(),b(this.EVENT_NAME)}}Mt.EVENT_NAME="AutomadPendingRequestsChange",Mt.count=0;const Rt=()=>{const e=new RegExp(`^${m.dashboardURL}/`,"i");return window.location.pathname.replace(e,"")},Ht=()=>{const e=Rt();if((t=e)&&t in n)return e;var t;window.location.href=`${m.dashboardURL}/${n.home}`},Bt=e=>`am-${e}`;class Ot{static getInstance(){return Ot.instance||(Ot.instance=new Ot,yt().log("Created new State instance")),Ot.instance}get root(){return this._root}get data(){return this._data}constructor(){this._root=null,this._data=null}bootstrap(e,t){this._root=e,this._data=t}update(e){this._data=Object.assign({},this._data,e),b("AutomadAppStateChange")}get(e){return this._data[e]}set(e,t){this._data[e]=t}}Ot.instance=null;var Ft=a(7545),Nt=a.n(Ft);const Ut=()=>{r(".ct").forEach((e=>{e.remove()}));const e=l(".am-ui"),t=new(Nt());v(e,"mouseover",(e=>{const a=e.path||e.composedPath&&e.composedPath();let s=null;if(a.forEach((e=>{try{e.matches("[am-tooltip]")&&(s=e)}catch(e){}})),s){const e=Object.assign({placement:"bottom",delay:150,hidingDelay:100},(e=>{const t=e.getAttribute("am-tooltip-options")||"",a={};t&&t.split(",").forEach((e=>{const[t,i]=e.split(":");isNaN(parseInt(i))?a[t.trim()]=i.trim():a[t.trim()]=parseInt(i)}));return a})(s));let a=s.getAttribute("am-tooltip");a&&t.show(s,i("span",[],{},null,a),e)}else t.hide()}))};class Dt{static get size(){return{undo:Dt.undoStack.length,redo:Dt.redoStack.length}}static undoHandler(){const e=Dt.undoStack.pop();e&&(e.undo(),Dt.redoStack.push(e))}static redoHandler(){const e=Dt.redoStack.pop();e&&(e.redo(),Dt.undoStack.push(e))}static addListeners(){aa("z",Dt.undoHandler),aa("y",Dt.redoHandler)}static new(){Dt.undoStack=new jt,Dt.redoStack=new jt,b("AutomadUndoStackUpdate")}static addEntry(e){Dt.redoStack=new jt,Dt.undoStack.push(e)}static attach(e){setTimeout((()=>{new qt(e)}),0)}}class jt{get length(){return this._stack.length}constructor(){this._stack=[]}push(e){this._stack.push(e),this._stack=this._stack.slice(-jt.LIMIT),b("AutomadUndoStackUpdate")}pop(){const e=this._stack.pop();return b("AutomadUndoStackUpdate"),e}}jt.LIMIT=50;class qt{constructor(e){this.ignoreEventFeedback=!1;const t=()=>{this.ignoreEventFeedback=!0,b("change",e.getValueProvider())},a=o((()=>{if(this.ignoreEventFeedback)return void(this.ignoreEventFeedback=!1);const a=e.query(),i=this.undoState;JSON.stringify(a)!==JSON.stringify(i)&&(Dt.addEntry({undo:()=>{e.mutate(i),t()},redo:()=>{e.mutate(a),t()}}),this.undoState=a)}),500);this.undoState=e.query(),v(e.getValueProvider(),"change input",a.bind(this))}}const zt=e=>{const t=new URL(window.location.href);t.searchParams.delete(e),window.history.replaceState(null,null,t)},Gt=()=>Vt("url")||Vt("context"),Vt=e=>new URLSearchParams(window.location.search).get(e)||"",Wt=(e,t=250,a=250)=>{if(!e)return"";const i=encodeURIComponent(Jt(e));return`${m.baseIndex}/_resize?url=${i}&w=${t}&h=${a}`},Jt=e=>{if(!e)return"";if(e.match(/^\//))return`${m.baseURL}${e}`;if(e.match(/:\/\//g))return e;const t=Gt();if(t){const a=m.pages[t];if(a)return`${m.baseURL}/pages${a.path}${e}`}return""},Zt=e=>{if(e)return e.match(/^\//)?`${m.baseIndex}${e}`:e},Kt=(e,t)=>{const a=new URL(window.location.href);a.searchParams.set(e,t),window.history.replaceState(null,null,a)};var Yt=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};const Xt=e=>Yt(void 0,void 0,void 0,(function*(){let t=i("am-modal",[],{"am-destroy":"","am-no-click":"","am-no-esc":"",style:"z-index: 2000;"},ea());return t.innerHTML=ft`<am-modal-dialog><am-modal-body>${e}</am-modal-body><am-modal-footer><am-modal-close class="am-e-button"> ${m.text("cancel")} </am-modal-close><am-modal-close am-confirm class="am-e-button am-e-button--primary"> ${m.text("ok")} </am-modal-close></am-modal-footer></am-modal-dialog>`,setTimeout((()=>{t.open()}),0),new Promise(((e,a)=>{v(t,"click",(a=>{let i=!1;t.close(),t=null;try{const e=a.target;i=e.matches("[am-confirm]")||null!=e.closest("[am-confirm]")}catch(e){}e(i)}),"am-modal-close")}))})),Qt=e=>{const t=e.match(/(\d+)/g);let a=parseInt(t[0]).toString(16),i=parseInt(t[1]).toString(16),s=parseInt(t[2]).toString(16);return a=1===a.length?"0"+a:a,i=1===i.length?"0"+i:i,s=1===s.length?"0"+s:s,"#"+a+i+s},ea=()=>l("body .am-ui, .am-ui body"),ta=()=>-1!=navigator.userAgent.toLowerCase().indexOf("mac")?"⌘":"Ctrl",aa=(e,t)=>v(window,"keydown",(a=>{if(a.ctrlKey||a.metaKey){const i=String.fromCharCode(a.which).toLowerCase();if(e==i)return a.preventDefault(),void t.apply(a.target,[a])}})),ia=e=>{document.title=`${e} — Automad`},sa=e=>e.replace(/\//g," / ").replace(/(?!^)([A-Z]+)/g," $1").replace("_"," ").split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),na=()=>{const e=(0,j.kP)("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",2),t=(0,j.kP)("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",30);return`${e()}${t()}`};class oa extends x{connectedCallback(){this.classList.add("am-l-dashboard__section","am-l-dashboard__section--breadcrumbs"),this.addListener(v(window,"scroll",(()=>{this.classList.toggle("am-l-dashboard__section--breadcrumbs-hidden",window.scrollY>40)})))}}var la=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-breadcrumbs-page",class extends oa{constructor(){super();const e=i("div",["am-c-breadcrumbs"],{},i("div",["am-l-dashboard__content"],{},this));i("am-link",["am-c-breadcrumbs__item"],{"am-target":n.home},e,m.text("dashboardTitle")),this.init(e)}connectedCallback(){super.connectedCallback()}init(e){return la(this,void 0,void 0,(function*(){const t=Gt(),a=yield Pt("PageController::breadcrumbs",{url:t});this.render(e,a.data)}))}render(e,t){t&&t.forEach(((a,s)=>{const o=`${n.page}?url=${encodeURIComponent(a.url)}`,l=i("am-link",["am-c-breadcrumbs__item"],{"am-target":o},e);s==t.length-1?l.innerHTML=ft`<span am-bind="title"> $${a.title} </span>`:l.textContent=a.title}))}});customElements.define("am-breadcrumbs-route",class extends oa{static get observedAttributes(){return["am-target","am-text","am-icon"]}connectedCallback(){super.connectedCallback();const e=this.hasAttribute("am-narrow");this.innerHTML=ft`<div class="am-l-dashboard__content ${e?"am-l-dashboard__content--narrow":""}"><div class="am-c-breadcrumbs"><am-link class="am-c-breadcrumbs__item" am-target="${n.home}"><span>${m.text("dashboardTitle")}</span></am-link><am-link class="am-c-breadcrumbs__item" am-target="${this.elementAttributes["am-target"]}"><span>${this.elementAttributes["am-text"]}</span></am-link></div></div>`}});class ra extends x{constructor(){super(...arguments),this.linkLabel=!0}get isSpellchecked(){return this.hasAttribute("spellcheck")}get input(){return l("[name]",this)}set data({key:e,value:t,name:a,id:i,tooltip:s,label:n,placeholder:o,isInPage:l}){i=null!=i?i:(e=>`am-field__${e.replace(/\s+/g,"_")}`)(e),t=void 0===t?"":t,s=xt(s||""),n=n||rt(e),o=o||"",l=null!=l&&l,this._data={name:a,id:i,label:n,value:t,tooltip:s,placeholder:o,isInPage:l},this.create()}connectedCallback(){this.classList.add("am-c-field")}getValueProvider(){return this.input}mutate(e){this.input.value=e}query(){return this.input.value}create(){this.createLabel(),this.createInput(),this.applyAttributes(),Dt.attach(this)}createLabel(){const{label:e,tooltip:t,isInPage:a}=this._data;if(a)return;const s={};this.linkLabel&&(s.for=this._data.id);const n=i("div",[],{},this),o=i("label",["am-c-field__label"],s,n);i("span",[],{},o).textContent=e,t&&(i("i",["bi","bi-lightbulb"],{},o),o.setAttribute("am-tooltip",t))}applyAttributes(){r("input, textarea",this).forEach((e=>{this.hasAttribute("required")&&(e.setAttribute("pattern",".*\\S.*"),e.setAttribute("required",""),this.removeAttribute("required"),this.hasAttribute("am-error")||this.setAttribute("am-error",m.text("requiredField"))),e.setAttribute("spellcheck",this.isSpellchecked?"true":"false"),["am-bind","am-bind-to","am-toggle","pattern"].forEach((t=>{this.hasAttribute(t)&&(e.setAttribute(t,this.getAttribute(t)),this.removeAttribute(t))}))}))}}customElements.define("am-color",class extends ra{createInput(){const{name:e,id:t,value:a}=this._data,s=i("div",["am-f-input-combo"],{},this),n=i("input",["am-f-input","am-u-text-mono"],{id:t,name:e,value:a,type:"text"},s),o=i("input",[],{type:"color",value:a},i("span",["am-f-input-combo__color"],{},s));v(o,"change",(()=>{n.value=o.value,b("change",n)})),v(n,"keyup change",(()=>{o.value=n.value}))}});customElements.define("am-date",class extends ra{createInput(){var e,t;const{name:a,id:s,value:n,placeholder:o}=this._data,l=null!==(t=null===(e=n.match(/[\d-]+T\d\d:\d\d/))||void 0===e?void 0:e[0])&&void 0!==t?t:"";i("input",["am-f-input"],{id:s,name:a,value:l,type:"datetime-local",placeholder:o},this)}});var ca=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};lt.add("am-editor"),customElements.define("am-editor",class extends ra{constructor(){super(...arguments),this.linkLabel=!1}createInput(){const{name:e,id:t,value:a}=this._data;this.setAttribute("name",e),this.value=a,this.editorJS=Xe(i("div",[],{id:t},this),{blocks:this.value.blocks},{onChange:e=>ca(this,void 0,void 0,(function*(){const{blocks:t}=yield e.saver.save();JSON.stringify(this.value.blocks)!==JSON.stringify(t)&&(this.value={blocks:[...t],automadVersion:m.version},b("input",this))}))},!1),this.attachToolbarPositionObservers(),this.attachPopupHeightObservers()}getValueProvider(){return this}mutate(e){return ca(this,void 0,void 0,(function*(){this.value=e,e.blocks.length>0?yield this.editorJS.editor.render(e):this.editorJS.editor.clear(),this.editorJS.onRender()}))}query(){return this.value}attachPopupHeightObservers(){this.addListener(f(this,(e=>{const t=e.target;if(!t.classList.contains("codex-editor"))return;if(!t.classList.contains("codex-editor--toolbox-opened"))return void this.style.removeProperty("min-height");const a=l(".ce-popover--opened",t);setTimeout((()=>{const e=a.getBoundingClientRect(),t=this.getBoundingClientRect(),i=e.top-t.top+e.height;this.style.minHeight=`${i}px`}),0)}))),this.addListener(f(this,(e=>{const t=e.target;t.classList.contains("ce-popover")&&t.closest(".ce-settings")&&(t.classList.contains("ce-popover--opened")?setTimeout((()=>{const e=t.getBoundingClientRect(),a=this.getBoundingClientRect(),i=e.top-a.top+e.height;this.style.minHeight=`${i}px`}),0):this.style.removeProperty("min-height"))})))}attachToolbarPositionObservers(){this.addListener(v(this,"keydown",(e=>{if("/"!=e.key)return;const t=e.target.closest(".ce-block");Q.updateToolbarPosition(t)}))),this.addListener(v(this,"mouseover",o((e=>{e.stopPropagation();const t=e.target.closest(".ce-block");Q.updateToolbarPosition(t)}),10),".ce-block"))}});class da extends ra{get inputType(){return"text"}createInput(){const{name:e,id:t,value:a,placeholder:s}=this._data;i("input",["am-f-input"],{id:t,name:e,value:a,type:this.inputType,placeholder:s},this)}}customElements.define("am-input",da);customElements.define("am-email",class extends da{get inputType(){return"email"}});const ma={group:"feedFields",direction:"vertical",animation:200,dataIdAttr:"data-field",draggable:".am-c-feed-field-select__item",handle:".am-c-feed-field-select__item",ghostClass:"am-c-feed-field-select__item--ghost",chosenClass:"am-c-feed-field-select__item--chosen",dragClass:"am-c-feed-field-select__item--drag"};customElements.define("am-feed-field-select",class extends ra{connectedCallback(){super.connectedCallback(),setTimeout((()=>{this.init(),v(this.input,"change AutomadChangeByBinding",this.init.bind(this))}),0)}createLabel(){}createInput(){const{name:e,value:t}=this._data;i("input",[],{type:"hidden",name:e,value:t},this)}init(){let e=l("section",this);e&&e.remove(),e=i("section",[],{},this);const t=JSON.parse(this.input.value||"[]"),a=m.contentFields.filter((e=>!t.includes(e))),s=this.createSortable(t,m.text("systemRssFeedFieldsInfoUsed"),[],e);i("div",["am-c-feed-field-select__arrows"],{},e,'<i class="bi bi-arrow-down-up"></i>');const n=this.createSortable(a,m.text("systemRssFeedFieldsInfoUnused"),["am-c-feed-field-select--muted"],e),o=new Ee.ZP(s,Object.assign({},ma,{onSort:e=>{this.input.value=JSON.stringify(o.toArray()),b("input",this.input)}}));new Ee.ZP(n,ma)}createSortable(e,t,a,s){const n=i("div",[].concat(a,["am-c-feed-field-select"]),{"data-text":t},s);return e.forEach((e=>{i("div",["am-c-feed-field-select__item"],{[ma.dataIdAttr]:e},n).innerHTML=ft`<span>${rt(e)}</span><i class="bi bi-grip-vertical"></i>`})),n}});customElements.define("am-image-select",class extends ra{createInput(){const{name:e,id:t,value:a,placeholder:s}=this._data,n=i("span",["am-c-image-select"],{},this),o=i("input",["am-f-input"],{id:t,name:e,type:"text",placeholder:s,value:a}),l=this.createPreview(n,o,t),r=i("div",["am-c-image-select__combo"],{},n);r.appendChild(o);const c=this.createModalButton(r),d=()=>{at((e=>{o.value=e,b("change",o)}),this._data.label,o.value)};v(c,"click",d.bind(this)),v(l,"click",d.bind(this))}createPreview(e,t,a){const s=`imageSelectComponent_preview_${a}`;return new u(s,{input:t,modifier:e=>Wt(e.split("?")[0])}),i(ae.TAG_NAME,["am-c-image-select__preview"],{"am-bind":s,"am-bind-to":"src"},e)}createModalButton(e){return i("button",["am-e-button"],{},e,ft`<i class="bi bi-folder"></i><span>${m.text("browseFiles")}</span>`)}});customElements.define("am-main-theme",class extends ra{createInput(){var e;const{name:t,id:a,value:s}=this._data,o=Object.values(m.themes),l=null!==(e=m.themes[s])&&void 0!==e?e:Object.values(m.themes)[0],r=[];o.forEach((e=>{r.push({text:e.name,value:e.path})})),nt(r,l.path,this,t,a,'<i class="bi bi-box-seam"></i>');const c=i("div",["am-u-flex","am-u-flex--column"],{},this);i("am-icon-text",[],{"am-icon":"file-earmark-text","am-text":m.text("themeReadme")},i("a",[],{href:l.readme,target:"_blank"},c)),i("am-icon-text",[],{"am-icon":"cloud-download","am-text":m.text("moreThemes")},i("am-link",["am-u-text-link"],{"am-target":n.packages},c))}});var ua=a(471),ha=a(9582),pa=a.n(ha);const ga=(e,t,a)=>{const s=i("button",["toastui-editor-toolbar-icons",e],{});return v(s,"click",a),{el:s,name:t,tooltip:t,onUpdated({disabled:e}){e?s.setAttribute("disabled",""):s.removeAttribute("disabled")}}},ba={image(e,t){const{origin:a,entering:i}=t,s=a();return i&&(s.attributes={src:Jt(e.destination)}),s},link(e,t){const{origin:a,entering:i}=t,s=a();return i&&(s.attributes={href:Zt(e.destination),target:"_blank"}),s}};lt.add("am-markdown"),customElements.define("am-markdown",class extends ra{constructor(){super(...arguments),this.linkLabel=!1}createInput(){const{name:e,id:t,value:a,placeholder:s}=this._data,n=i("div",["am-c-md-editor","am-e-contents"],{id:t},this);this.setAttribute("name",e),this.value=a;const o=`markdownComponents_link_${t}`,c=ga("image",m.text("insertImage"),(()=>{at((e=>{e&&this.editor.insertText(`\r\n![](${e})`)}),m.text("insertImage"))})),d=ga("link",m.text("insertLink"),(()=>{it(o,"insertLink")}));ua.ZP.setLanguage("en-US",{Write:m.text("write"),Preview:m.text("preview"),Headings:m.text("headings"),Heading:m.text("heading"),Paragraph:m.text("paragraph"),Strike:m.text("strikeThrough"),Bold:m.text("bold"),Italic:m.text("italic"),Code:m.text("inlineCode"),"Insert CodeBlock":m.text("insertCodeBlock"),Blockquote:m.text("blockquote"),"Unordered list":m.text("unorderedList"),"Ordered list":m.text("orderedList"),Line:m.text("insertHorizontalLine"),"Insert table":m.text("insertTable"),Indent:m.text("indent"),Outdent:m.text("outdent")}),this.editor=new ua.ZP({el:n,initialValue:a,autofocus:!1,usageStatistics:!1,height:"auto",hideModeSwitch:!0,initialEditType:"markdown",previewStyle:"tab",placeholder:s,previewHighlight:!0,toolbarItems:[["heading","bold","italic","strike","code","quote"],["ul","ol","indent","outdent"],["table",c,d,"hr","codeblock"]],customHTMLRenderer:ba,events:{change:()=>{this.value=this.editor.getMarkdown(),b("input",this)},focus:()=>{n.classList.add("am-c-md-editor--focus")},blur:()=>{n.classList.remove("am-c-md-editor--focus")}},plugins:[[pa(),{highlighter:we()}]]}),new u(o,{onChange:e=>{e&&this.editor.insertText(`[${this.editor.getSelectedText()||e}](${e})`)}});const h=l(".toastui-editor-tabs",this),p=i("div",["tab-item"],{},h),g=r("div",h);p.textContent=m.text("vertical"),v(h,"click",(e=>{const t=e.target;let a=0;g.forEach(((e,i)=>{e.isSameNode(t)&&(a=i),e.classList.toggle("active",e.isSameNode(t))})),this.editor.changePreviewStyle(2===a?"vertical":"tab"),t.click()}),"div")}getValueProvider(){return this}query(){return this.value}mutate(e){this.editor.setMarkdown(e)}});customElements.define("am-number",class extends ra{createInput(){const{name:e,id:t,value:a}=this._data;i("input",["am-f-input"],{type:"number",id:t,name:e,value:a},this)}});customElements.define("am-number-unit",class extends ra{constructor(){super(...arguments),this.linkLabel=!1}createInput(){const{name:e,id:t,value:a}=this._data;i("am-number-unit-input",[],{id:t,name:e,value:a},this)}});var va=a(8634),fa=a.n(va);customElements.define("am-page-tags",class extends ra{createInput(){const{name:e,id:t,value:a}=this._data,s=i("textarea",["am-f-input"],{name:e,id:t},this);s.innerHTML=a;const n=new(fa())(s,{whitelist:m.tags,originalInputValueFormat:e=>e.map((e=>e.value)).join(", "),dropdown:{enabled:0,maxItems:8,position:"text",closeOnSelect:!0}});n.on("change",(e=>{this.closest("am-page-data-form").onChange()})),n.on("change",o((()=>{m.updateState()}),2e3))}});const xa=(e,t="")=>[t,e.split("/").reverse()[0].replace(/\.php$/g,"")].filter((e=>e.length)).join("/"),ya=(e,t,a,s="*",n="")=>{e.forEach((e=>{const o=xa(e,n),l=i("option",[],{value:o},t);l.textContent=((e,t="")=>{const a=e.split("/").reverse()[0].replace(/\.php$/g,"");return sa([t,a].join("/"))})(o,s),a==o&&l.setAttribute("selected","")}))};customElements.define("am-page-template",class extends x{set data({fields:e,template:t,themeKey:a}){this.render({fields:e,template:t,themeKey:a})}connectedCallback(){this.classList.add("am-c-field")}render({fields:e,template:t,themeKey:a}){const{buttonLabel:s,buttonIcon:n,selectedTemplate:o}=(({fields:e,template:t,themeKey:a})=>{const i=m.themes;let s=i[m.mainTheme];void 0===s&&(s=Object.values(i)[0]);let n=!1,o=s,l=xa(t),r=sa(l),c="code-slash";return void 0!==i[e[a]]&&(o=i[e[a]],r=sa(`${o.name}/${l}`),l=xa(t,o.path)),n=-1!==(null==o?void 0:o.templates.indexOf(t)),n||(c="question-circle"),{buttonLabel:r,buttonIcon:c,selectedTemplate:l}})({fields:e,template:t,themeKey:a});i("div",["am-c-field"],{},this,ft`<label class="am-c-field__label">${m.text("pageTemplate")}</label><am-modal-toggle am-modal="#am-page-template-modal" class="am-f-input am-u-flex am-u-flex--align-center am-u-flex--between am-u-cursor-pointer"><am-icon-text am-icon="${n}" am-text="${s}"></am-icon-text><i class="bi bi-pen"></i></am-modal-toggle>`),i("am-modal",[],{id:"am-page-template-modal"},this,ft`<am-modal-dialog><am-modal-header> ${m.text("pageTemplate")} </am-modal-header><am-modal-body></am-modal-body></am-modal-dialog>`);const r=l("am-modal-body",this);Object.keys(m.themes).length>0?r.innerHTML=ft`<am-page-template-select value="${o}"></am-page-template-select>`:r.textContent=m.text("noThemesFound")}}),customElements.define("am-page-template-select",class extends x{connectedCallback(){var e;this.classList.add("am-f-select");const t=this.getAttribute("value"),a=m.themes[m.mainTheme]||m.themes[Object.keys(m.themes)[0]],s=m.themes,n=i("span",[],{},this),o=i("select",[],{name:"theme_template"},this),l=i("optgroup",[],{label:"*"},o);ya(null!==(e=null==a?void 0:a.templates)&&void 0!==e?e:[],l,t),Object.values(s).forEach((e=>{const a=i("optgroup",[],{label:e.name},o);ya(e.templates,a,t,e.name,e.path)}));const r=()=>{n.textContent=o.options[o.selectedIndex].text};v(o,"change",r),setTimeout(r,0)}});customElements.define("am-password",class extends da{get inputType(){return"password"}});var wa=a(1202);customElements.define("am-syntax-theme-select",class extends ra{createInput(){const{name:e,id:t,value:a}=this._data,s=!!Gt(),n=a||(s?"":"verdandi.light-dark");let o=[{text:"&mdash;",value:"none"},...wa];s&&(o=[{text:m.text("useSharedDefault"),value:""},...o]),this.classList.add("am-u-flex","am-u-flex--column","am-u-flex--gap"),nt(o,n,this,e,t),i("div",[],{},this,ft`<a href="https://automadcms.github.io/automad-prism-themes/" target="_blank"><am-icon-text am-icon="palette2" am-text="${m.text("visitSyntaxGallery")}"></am-icon-text></a>`)}});customElements.define("am-textarea",class extends ra{createInput(){const{name:e,id:t,value:a,placeholder:s}=this._data,n=i("textarea",["am-f-input"],{id:t,name:e,placeholder:s,wrap:"off"},this);n.textContent=a,this.initAutoResize(n),pt(n)}initAutoResize(e){const t=o((()=>{this.fitContent(e)}),50);v(e,"keyup focus focusout drop paste",t),this.addListener(v(window,"resize",t)),t()}fitContent(e){const t=i("div",["am-f-input"],{style:`position: absolute; height: auto; width: ${e.offsetWidth}; white-space: pre-line; opacity: 0;`},this);t.textContent=e.value+"-",e.style.height=`${t.offsetHeight+15}px`,t.remove()}});customElements.define("am-title",class extends ra{createInput(){const{name:e,id:t,value:a}=this._data;i("input",["am-f-input","am-f-input--title"],{id:t,name:e,value:a,type:"text"},this)}});class ka extends ra{constructor(){super(...arguments),this.classes=["am-f-toggle","am-f-toggle--button"]}createInput(){const{name:e,id:t,value:a,label:s}=this._data;i("div",this.classes,{},this,ft`<input type="checkbox" name="${e}" id="${t}" value="1" ${a?"checked":""} /><label for="${t}"><i class="bi"></i><span>${s}</span></label>`)}query(){return this.input.checked}mutate(e){this.input.checked=e}}customElements.define("am-toggle",ka);customElements.define("am-toggle-large",class extends ka{constructor(){super(...arguments),this.classes=["am-f-toggle","am-f-toggle--large"]}createLabel(){}});customElements.define("am-toggle-select",class extends ra{createInput(){const{name:e,id:t,value:a,label:s,placeholder:n}=this._data,o=i("div",["am-f-toggle","am-f-toggle--select"],{},this,ft`<label for="${t}"><i class="bi"></i><span>${s}</span></label><select name="${e}" id="${t}"><option value="">${m.text("useSharedDefault")}</option><option value="0">${m.text("disable")}</option><option value="1">${m.text("enable")}</option></select>`),r=()=>{o.classList.toggle("am-f-toggle--off","0"===c.value),o.classList.toggle("am-f-toggle--on","1"===c.value)};o.classList.toggle("am-f-toggle--default-on",""!=n);const c=l("select",o);c.value=a||"",this.addListener(v(c,"change",r.bind(this))),r()}});customElements.define("am-url",class extends ra{createInput(){const{name:e,id:t,value:a,placeholder:s,label:n}=this._data,o=i("div",["am-f-input-combo"],{},this),l=`urlComponent_${t}`,r=i("input",["am-f-input"],{id:t,name:e,value:a,type:"text",placeholder:s},o),c=i("span",["am-f-input-combo__button"],{},o,'<i class="bi bi-link"></i>');new u(l,{input:r}),v(c,"click",(()=>{it(l,n)}))}});customElements.define("am-file-card",class extends x{set data(e){this.render(e)}connectedCallback(){this.classList.add("am-c-card")}render(e){let t="",a="";e.width&&e.height&&(t=ft`<div class="am-c-icon-text"><i class="bi bi-aspect-ratio"></i><span> ${e.width} ✗ ${e.height} </span></div>`),e.caption&&(a=ft`<am-icon-text am-icon="chat-square-text" am-text="$${e.caption}"></am-icon-text>`),this.innerHTML=ft`${this.renderPreview(e)} <am-file-info class="am-u-flex__item-grow am-u-flex am-u-flex--column am-u-flex--gap am-u-cursor-pointer"><div class="am-c-card__title" am-tooltip="$${e.basename}"> $${e.basename} </div><div class="am-c-card__body"> ${a} ${t} <am-icon-text am-icon="calendar2-date" am-text="${e.mtime||"-"}"></am-icon-text><am-icon-text am-icon="hdd" am-text="${e.size||"-"}"></am-icon-text></div></am-file-info><div class="am-c-card__footer"> ${this.renderDropdown(e)} <am-checkbox name="delete[$${e.basename}]"></am-checkbox></div>`,r("am-file-info",this).forEach((t=>{t.data=e}))}renderPreview(e){return e.thumbnail?ft`<am-file-robot am-file="${m.baseURL}${e.url}?${Date.now()}" class="am-c-card__teaser am-u-cursor-pointer" am-tooltip="$${e.basename}"><img src="${e.thumbnail}" /></am-file-robot>`:ft`<am-file-info class="am-c-card__teaser am-u-cursor-pointer" am-tooltip="$${e.basename}"><i class="bi bi-file-earmark bi-filetype-${e.extension}"></i></am-file-info>`}renderDropdown(e){let t="";return e.thumbnail&&(t=ft`<am-file-robot am-file="${m.baseURL}${e.url}" class="am-c-dropdown__link"><am-icon-text am-icon="pencil" am-text="${m.text("editImage")}"></am-icon-text></am-file-robot>`),ft`<am-dropdown><i class="bi bi-three-dots"></i><div class="am-c-dropdown__items"> ${t} <am-file-info class="am-c-dropdown__link"><am-icon-text am-icon="card-heading" am-text="${m.text("editFileInfo")}"></am-icon-text></am-file-info><am-copy class="am-c-dropdown__link" value="${e.url}"><am-icon-text am-icon="clipboard-plus" am-text="${m.text("copyUrlClipboard")}"></am-icon-text></am-copy></div></am-dropdown>`}});customElements.define("am-file-count",class extends x{connectedCallback(){const e=i("span",[],{},this),t=()=>{const t=r("am-file-card").length;e.textContent=`${t}`};this.addListener(v(window,"AutomadFileCollectionRender",t.bind(this))),setTimeout(t.bind(this),0)}});customElements.define("am-file-info",class extends x{connectedCallback(){v(this,"click",(()=>{if(!this.data)return;const e=this.createModal(this.data);setTimeout((()=>{e.open()}),0)}))}createModal(e){const t=i("am-modal",[],{"am-destroy":""},document.body);return t.innerHTML=this.renderModal(e),t}renderModal(e){return ft`<am-form am-api="FileController::editInfo" am-event="AutomadFilesChangeOnServer" class="am-c-modal__dialog"><am-modal-header>${m.text("editFileInfo")}</am-modal-header><input type="hidden" name="old-name" value="${e.basename}" /><am-modal-body> ${Qe("am-input",null,{key:"new-name",value:e.basename,name:"new-name",label:m.text("fileName")},[]).outerHTML} ${Qe("am-textarea",null,{key:"caption",value:e.caption,name:"caption",label:m.text("caption")},[]).outerHTML} </am-modal-body><am-modal-footer><a href="${e.url}" class="am-e-button" download="$${e.basename}"> ${m.text("downloadFile")} </a><am-submit class="am-e-button am-e-button--primary"> ${m.text("save")} </am-submit></am-modal-footer></am-form>`}});var _a=a(8858);const $a={palette:{"txt-primary":"hsl(var(--am-clr-text-paragraph))","txt-primary-invert":"hsl(var(--am-clr-background))","txt-secondary":"hsl(var(--am-clr-text-paragraph))","txt-secondary-invert":"hsl(var(--am-clr-background))","txt-placeholder":"hsl(var(--am-clr-text-muted))","accent-primary":"hsl(var(--am-clr-text-link))","accent-primary-hover":"hsl(var(--am-clr-text-link-hover))","accent-primary-active":"hsl(var(--am-clr-text-active))","accent-primary-disabled":"hsl(var(--am-clr-background-faded))","bg-primary":"hsl(var(--am-clr-background))","bg-primary-hover":"hsl(var(--am-clr-background))","bg-primary-active":"hsl(var(--am-clr-background))","bg-primary-0-5-opacity":"hsl(var(--am-clr-background))","bg-secondary":"hsl(var(--am-clr-background))","icons-primary":"hsl(var(--am-clr-text-primary))","icons-primary-opacity-0-6":"hsl(var(--am-clr-text-muted))","icons-secondary":"hsl(var(--am-clr-text-paragraph))","btn-primary-text":"hsl(var(--am-clr-text-primary))","btn-disabled-text":"hsl(var(--am-clr-text-muted))","link-primary":"hsl(var(--am-clr-text-link))","link-hover":"hsl(var(--am-clr-text-link-hover))","link-active":"hsl(var(--am-clr-text-active))","borders-primary":"hsl(var(--am-clr-border))","borders-secondary":"hsl(var(--am-clr-border))","borders-strong":"hsl(var(--am-clr-border))","borders-invert":"hsl(var(--am-clr-border))","border-active-bottom":"hsl(var(--am-clr-text))","active-secondary":"hsl(var(--am-clr-background-primary))","active-secondary-hover":"hsl(var(--am-clr-background-primary-hover))","active-secondary-active":"hsl(var(--am-clr-background-primary-hover))","light-shadow":"0 4px 20px rgba(0,0,0,0.1)",tag:"hsl(var(--am-clr-text-paragraph))",error:"hsl(var(--am-clr-text-paragraph))",success:"hsl(var(--am-clr-text-paragraph))",warning:"hsl(var(--am-clr-text-paragraph))",info:"hsl(var(--am-clr-text-paragraph))"},typography:{fontFamily:"InterVariable"}};var Ca=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-file-robot",class extends x{static get observedAttributes(){return["am-file"]}connectedCallback(){v(this,"click",(()=>{const e=this.createModal();setTimeout((()=>{e.open()}),0)}))}createModal(){const e=i("am-modal",[],{"am-destroy":"","am-no-esc":""},document.body),t=i("am-form",["am-c-modal__dialog","am-c-modal__dialog--fullscreen"],{"am-api":"ImageController::save"},e);return this.initFileRobot(t,e),e}initFileRobot(e,t){const a={source:this.elementAttributes["am-file"],savingPixelRatio:1,previewPixelRatio:window.devicePixelRatio,useBackendTranslations:!1,theme:$a,translations:m.state.text,onSave:(t,a)=>Ca(this,void 0,void 0,(function*(){e.additionalData=t,yield e.submit(),b("AutomadFilesChangeOnServer"),s()})),onClose:(e,t)=>Ca(this,void 0,void 0,(function*(){t&&!(yield Xt(m.text("discardImageChanges")))||s()}))},i=new _a.Z(e,a),s=()=>{i.terminate(),t.close()};i.render()}});var Ta=a(247);customElements.define("am-upload",class extends x{constructor(){super(...arguments),this.dropzone=null,this.form=null,this.modal=null,this.queue=null}get options(){const e=m.allowedFileTypes.map((e=>`.${e}`)).join(", ");return{clickable:[this.form],paramName:"file",hiddenInputContainer:this,uploadMultiple:!1,parallelUploads:2,maxFilesize:512,acceptedFiles:e,previewsContainer:this.queue,addRemoveLinks:!0,dictInvalidFileType:m.text("unsupportedFileTypeError"),dictCancelUpload:m.text("cancel"),dictUploadCanceled:m.text("uploadCancelled"),dictCancelUploadConfirmation:m.text("confirmCancelUpload"),chunking:!0,forceChunking:!0,parallelChunkUploads:!1,thumbnailWidth:150,thumbnailHeight:150}}connectedCallback(){this.classList.add("am-c-upload"),this.form=this.createForm(),this.modal=i("am-modal",[],{"am-no-click":"","am-no-esc":""},this.form),this.queue=i("am-modal-dialog",["am-c-upload__previews"],{},this.modal),this.dropzone=new Ta.Z(this.form,this.options),this.dropzone.on("success",this.onSuccess.bind(this)),this.dropzone.on("error",this.onError.bind(this)),this.dropzone.on("addedfiles",this.onAddedFiles.bind(this)),this.dropzone.on("queuecomplete",this.onQueueComplete.bind(this))}onError(e,t){this.dropzone.removeFile(e),"string"!=typeof t&&t.error&&(t=t.error),Tt(ft`${t}:<br />$${e.name}`)}onSuccess(e){const t=l("am-file-collection-list-form");At(ft`${m.text("uploadedSuccess")}:<br />$${e.name}`),this.dropzone.removeFile(e),t.refresh()}onAddedFiles(){this.modal.open()}onQueueComplete(){this.modal.close()}createForm(){const e=i("form",["am-c-upload__dropzone"],{action:`${m.apiURL}/${s("FileCollectionController::upload")}`},this);e.innerHTML=ft`<span>${m.text("dropFilesOrClick")}</span>`;const t=Gt();return t&&i("input",[],{type:"hidden",name:"url",value:t},e),i("input",[],{type:"hidden",name:"__csrf__",value:Et()},e),e}});class Aa extends x{set message(e){this.classList.toggle("am-c-alert",e.length>0),this.classList.toggle("am-c-alert--danger",e.length>0),this.innerHTML=ft`${e}`}}Aa.TAG_NAME="am-form-error",customElements.define(Aa.TAG_NAME,Aa);var La=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};const Ea=o((e=>La(void 0,void 0,void 0,(function*(){e()}))),750);class Sa extends x{get parallel(){return!0}get api(){return this.getAttribute("am-api")}get auto(){return this.hasAttribute("am-auto")}get confirm(){return this.getAttribute("am-confirm")}get watch(){return this.hasAttribute("am-watch")}get initSelf(){return!1}get submitButtons(){const e=r(`am-submit[am-form="${this.api}"]`),t=r("am-submit:not([am-form])",this);return e.concat(t)}get formData(){const e=Object.assign({},this.additionalData,dt(this)),t=Gt();return t&&(e.url=t),e}get parentModal(){return this.closest("am-modal")||null}constructor(){super(),this.additionalData={},this.init()}init(){this.initSelf&&this.submit(!0),this.hasAttribute("am-focus")&&setTimeout((()=>{l("input").focus()}),0),this.hasAttribute("am-enter")&&v(this,"keydown",(e=>{13==e.which&&(e.preventDefault(),this.submit())}),".am-f-input"),this.disableSubmitButtons(),this.watchChanges()}disableSubmitButtons(){this.watch&&setTimeout((()=>{this.submitButtons.forEach((e=>{e.setAttribute("disabled",""),e.blur()}))}),0)}submit(e=!1){return La(this,void 0,void 0,(function*(){if(!e&&this.confirm){if(!(yield Xt(this.confirm)))return}const t=m.addNavigationLock();this.submitButtons.forEach((e=>{e.classList.add("am-e-button--loading"),e.prepend(i("am-spinner"))})),r('input:not([type="hidden"], textarea, [contenteditable])',this).forEach((e=>{e.classList.add("am-validate")})),this.verifyRequired()?yield Pt(this.api,this,this.parallel,(e=>La(this,void 0,void 0,(function*(){yield this.processResponse(e),this.hasAttribute("am-event")&&b(this.getAttribute("am-event")),m.removeNavigationLock(t)})))):m.removeNavigationLock(t),this.submitButtons.forEach((e=>{var t;e.classList.remove("am-e-button--loading"),null===(t=l("am-spinner",e))||void 0===t||t.remove()}))}))}processResponse(e){var t;return La(this,void 0,void 0,(function*(){const{redirect:a,reload:i,error:s,success:n,debug:o}=e;a&&m.root.setView(a),i&&m.reload(),setTimeout((()=>{const e=l(Aa.TAG_NAME,this);e&&(e.message=null!=s?s:""),s&&(e||Tt(s),yt().error(s))}),0),n&&At(n),o&&o instanceof Array&&o.forEach((e=>{yt().log(this.api,e)})),s||(this.disableSubmitButtons(),null===(t=this.parentModal)||void 0===t||t.close())}))}onChange(){if(m.isReady){if(this.auto){Ea((()=>La(this,void 0,void 0,(function*(){const e=m.addNavigationLock();yield this.submit(),m.removeNavigationLock(e)}))));const e=m.addNavigationLock();setTimeout((()=>{m.removeNavigationLock(e)}),760)}this.watch&&this.submitButtons.forEach((e=>{e.removeAttribute("disabled")}))}}watchChanges(){v(this,"change keydown cut paste drop input",this.onChange.bind(this),lt.selector)}verifyRequired(){const e=r("[required]",this),t=[];return e.forEach((e=>{e.value.trim()||t.push(e)})),!t.length||(t[0].focus(),!1)}}customElements.define("am-form",Sa);var Pa=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-file-collection-list-form",class extends Sa{get initSelf(){return!0}init(){super.init(),this.classList.add("am-l-grid"),this.setAttribute("style","--min: 11.5rem; --aspect: 1.25;"),this.addListener(v(window,"AutomadAppStateChange AutomadFilesChangeOnServer",this.refresh.bind(this)))}processResponse(e){const t=Object.create(null,{processResponse:{get:()=>super.processResponse}});return Pa(this,void 0,void 0,(function*(){yield t.processResponse.call(this,e),void 0!==e.data&&(this.innerHTML="",void 0!==e.data.files&&(e.data.files.forEach((e=>{i("am-file-card",[],{},this).data=e})),b("AutomadFileCollectionRender")))}))}refresh(){r('[type="checkbox"]',this).forEach((e=>{e.checked=!1})),this.submit(!0)}});class Ia extends x{static get observedAttributes(){return["am-form"]}get relatedForms(){let e=r(`[am-api="${this.elementAttributes["am-form"]}"]`);return 0==e.length&&(e=c("[am-api]",this)),e}connectedCallback(){this.setAttribute("tabindex","0"),v(this,"click",(()=>{if(this.hasAttribute("disabled"))return!1;this.relatedForms.forEach((e=>{e.submit()}))}).bind(this))}}customElements.define("am-submit",Ia);customElements.define("am-file-collection-submit",class extends Ia{connectedCallback(){super.connectedCallback(),this.toggleAttribute("disabled",!0),this.relatedForms.forEach((e=>{const t=()=>{this.toggleAttribute("disabled",0==r(":checked",e).length)};this.addListener(v(window,"AutomadFileCollectionRender",t)),this.addListener(v(e,"change",t))}))}});var Ma=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-config-file-form",class extends Sa{get parallel(){return!1}get initSelf(){return!0}init(){super.init(),this.addListener(v(window,"AutomadAppStateChange",(()=>{this.innerHTML="",this.submit()})))}processResponse(e){const t=Object.create(null,{processResponse:{get:()=>super.processResponse}});var a;return Ma(this,void 0,void 0,(function*(){t.processResponse.call(this,e),(null===(a=e.data)||void 0===a?void 0:a.content)&&this.render(e.data.content)}))}render(e){this.innerHTML=ft`<am-modal-toggle class="am-e-button am-e-button--primary" am-modal="#am-config-file-form-modal"> ${m.text("systemConfigFileEdit")} </am-modal-toggle><am-modal id="am-config-file-form-modal"><am-modal-dialog class="am-c-modal__dialog--large"><div class="am-c-modal__header am-u-flex am-u-flex--align-center am-u-flex--gap"><span>${m.text("systemConfigFileEdit")}</span><span class="am-u-flex am-u-flex--align-center am-u-flex--gap"><am-modal-close class="am-e-button"> ${m.text("cancel")} </am-modal-close><am-submit class="am-e-button am-e-button--primary"> ${m.text("save")} </am-submit></span></div><textarea class="am-c-modal__code" name="content"></textarea></am-modal-dialog></am-modal>`;const t=l("textarea",this);t.value=e,pt(t),Dt.attach({getValueProvider:()=>t,query:()=>t.value,mutate:e=>{t.value=e}})}});customElements.define("am-delete-users-form",class extends Sa{init(){const e=()=>{this.innerHTML=m.system.users.reduce(((e,t)=>{const a=m.user.name==t.name?ft`<span class="am-u-text-muted"> ${m.text("systemUsersYou")} </span>`:ft`<am-checkbox name="delete[${t.name}]"></am-checkbox>`;return ft`${e} <span class="am-c-card"><span class="am-c-card__body am-c-card__body--large"><span class="am-u-flex am-u-flex--gap am-u-flex--align-center"><span class="am-u-flex__item-grow"> ${t.name} (${t.email}) </span> ${a} </span></span></span>`}),"")};super.init(),this.classList.add("am-u-flex","am-u-flex--column","am-u-flex--gap"),this.addListener(v(window,"AutomadAppStateChange",e.bind(this))),e()}});var Ra=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};class Ha extends x{connectedCallback(){let e="";"/"==Gt()&&(e=`am-confirm="${m.text("pageHistoryRestoreHomeConfirm")}"`);const t=i(y.TAG_NAME,[],{id:Ha.MODAL_ID},this,ft`<am-form class="am-c-modal__dialog" am-api="HistoryController::restore" ${e}><am-modal-header> ${m.text("pageHistory")} </am-modal-header><am-modal-body class="am-u-flex--gap-large"></am-modal-body><am-modal-footer><am-modal-close class="am-e-button">${m.text("cancel")}</am-modal-close><am-submit class="am-e-button am-e-button--primary"> ${m.text("pageHistoryRestore")} </am-submit></am-modal-footer></am-form>`),a=l("am-modal-body",t);this.addListener(v(t,"AutomadModalOpen",(()=>{this.init(a)})))}init(e){return Ra(this,void 0,void 0,(function*(){e.innerHTML="<am-spinner></am-spinner>";const{data:t}=yield Pt("HistoryController::log",{url:Gt()});if(!t)return void(e.innerHTML=m.text("pageHistoryNoRevision"));e.innerHTML=`<span>${"/"==Gt()?m.text("pageHistoryRestoreHomeText"):m.text("pageHistoryRestoreText")}</span>`;const a=t.reduce(((e,t)=>{const a=g(t.time);return e.push({text:a,value:t.hash}),e}),[]);nt(a,a[0].value,e,"revision")}))}}Ha.MODAL_ID="am-history-modal",customElements.define("am-history-modal-form",Ha);var Ba=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-inpage-form",class extends Sa{get api(){return"InPageController::edit"}get parallel(){return!1}get watch(){return!0}get initSelf(){return!0}init(){var e,t,a,i;const s=new URLSearchParams(document.location.search);this.field=s.get("field"),this.page=s.get("page"),this.context=s.get("context"),this.additionalData={field:this.field,context:this.context,init:!0},this.setAttribute("am-api",this.api),ia(`${null!==(t=null===(e=m.pages[this.context])||void 0===e?void 0:e.title)&&void 0!==t?t:"404"} (${this.field})`),this.bindings={inPageReturnUrlBinding:new u("inPageReturnUrl",{initial:this.page,modifier:e=>`${m.baseIndex}${e}`}),inPageTitleBinding:new u("inPageTitle",{initial:null!==(i=null===(a=m.pages[this.context])||void 0===a?void 0:a.title)&&void 0!==i?i:"404"}),inPageContextUrlBinding:new u("inPageContextUrl",{initial:this.context,modifier:e=>`${m.baseIndex}${e}`}),inPageFieldBinding:new u("inPageField",{initial:this.field,modifier:e=>rt(e)})},p.connectElements(m.root),v(window,"keydown",(e=>{27===e.keyCode&&(l("[am-modal-open]")||(e.preventDefault(),e.stopImmediatePropagation(),window.location.href=this.bindings.inPageReturnUrlBinding.value))})),v(document,"click",(e=>{var t,a;e.target.contains(this)&&(null===(t=l("[contenteditable], input, textarea",this))||void 0===t||t.focus(),null===(a=l(Ye.TAG_NAME))||void 0===a||a.editor.caret.setToLastBlock("end"))})),super.init()}processResponse(e){const t=Object.create(null,{processResponse:{get:()=>super.processResponse}});return Ba(this,void 0,void 0,(function*(){this.additionalData.init=!1,yield t.processResponse.call(this,e),200===e.code&&e.data&&(e.data.saved&&(window.location.href=this.bindings.inPageReturnUrlBinding.value),void 0!==e.data.value&&this.render(e))}))}render(e){const t=mt(!0);let a="am-textarea";for(const[e,i]of Object.entries(t))if(this.field.startsWith(e)){a=i;break}this.innerHTML="",Qe(a,this,{key:this.field,value:e.data.value,name:"value",isInPage:!0}),this.additionalData.dataFetchTime=e.time}});var Oa=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};const Fa=["sendmail","smtp"];customElements.define("am-mail-config-form",class extends Sa{constructor(){super(...arguments),this._config=null}get watch(){return!0}get config(){return this._config}set config(e){this._config=e,this.render()}connectedCallback(){this.config=m.system.mail,this.addListener(v(window,"AutomadAppStateChange",(()=>{this.config=m.system.mail})))}render(){const e=this.config;this.innerHTML="",this.classList.add("am-u-flex","am-u-flex--column","am-u-flex--gap-large");const t=i("div",[],{},this),a=nt(Fa.map((e=>({value:e}))),e.transport,t,"transport");Qe("am-email",t,{key:"from",name:"from",value:e.from,label:`${m.text("emailFrom")} (From)`,placeholder:e.fromDefault});const s=i("div",["am-c-card"],{},this),n=()=>{s.classList.toggle("am-u-display-none","smtp"!==a.value)},o=i("div",["am-c-card__form"],{},s),l=i("div",["am-l-grid","am-l-grid--auto"],{},o);Qe("am-input",l,{key:"smtpServer",name:"smtpServer",value:e.smtpServer,label:"SMTP Server"},[],{pattern:"^\\S*$"}),Qe("am-input",l,{key:"smtpPort",name:"smtpPort",value:e.smtpPort,label:"SMTP Port"},[],{pattern:"^\\d{0,5}$"}),Qe("am-input",o,{key:"smtpUsername",name:"smtpUsername",value:e.smtpUsername,label:`SMTP ${m.text("username")}`},[],{pattern:"^\\S*$"}),Qe("am-input",o,{key:"smtpPassword",name:"smtpPassword",value:"",label:`SMTP ${m.text("password")}`,placeholder:m.system.mail.smtpPasswordIsSet?m.text("systemMailSmtpPasswordPlaceholder"):""}),n(),this.addListener(v(a,"change",n));const r=i("div",["am-u-flex","am-u-flex--gap"],{},this);i("am-submit",["am-e-button","am-e-button--primary"],{disabled:"true"},r,m.text("save"));const c=i("button",["am-e-button","am-e-button--danger"],{},r,m.text("reset"));this.addListener(v(c,"click",(()=>Oa(this,void 0,void 0,(function*(){(yield Xt(m.text("systemMailReset")))&&Pt("MailConfigController::reset",{},!0,(()=>{b("AutomadAppStateRequireUpdate"),Dt.new()}))})))))}});var Na=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-page-data-form",class extends Sa{get parallel(){return!1}get auto(){return!0}get initSelf(){return!0}init(){this.sections=et(this),super.init(),this.addListener(v(window,"AutomadContentPublished",(()=>{this.bindings&&(this.bindings.pageDataFetchTimeBinding.value=Math.ceil((new Date).getTime()/1e3))})))}mainSettings({section:e,url:t,fields:a,template:s,readme:n}){const o=(t,i,s="",n={},o=e)=>{const l={key:i,value:a[i],name:`data[${i}]`,label:s};return Qe(t,o,l,[],n)},l=i("div",["am-u-flex","am-u-flex--column","am-u-flex--gap"],{},e),r=o("am-title",m.reservedFields.TITLE,"",{required:""},l);new u("title",{input:r.input,modifier:e=>(ia(e),e)}),i("a",[],{href:`${m.baseIndex}${t}`},l).innerHTML=ft`<span class="am-c-icon-text"><i class="bi bi-link"></i><span>${m.baseIndex}${t}</span></span>`,o("am-toggle-large",m.reservedFields.PRIVATE,m.text("keepPagePrivate"));const c=i("am-page-template",[],{},e);c.data={fields:a,template:s,themeKey:m.reservedFields.THEME};const d=i("a",[],{href:n,target:"_blank"},c);i("am-icon-text",[],{"am-icon":"file-earmark-text","am-text":m.text("themeReadme")},d),o("am-syntax-theme-select",m.reservedFields.SYNTAX_THEME,rt(m.reservedFields.SYNTAX_THEME)),o("am-toggle",m.reservedFields.HIDDEN,m.text("hidePage")),o("am-date",m.reservedFields.DATE,m.text("date")),"/"!=t&&Qe("am-input",e,{key:m.reservedFields.SLUG,value:a[m.reservedFields.SLUG],name:`data[${m.reservedFields.SLUG}]`,label:m.text("pageSlug")},[],{"am-bind":"pageSlug","am-bind-to":"value"}),o("am-url",m.reservedFields.URL,m.text("redirectPage")),o("am-page-tags",m.reservedFields.TAGS,m.text("pageTags"))}pageNotFound(){this.innerHTML=ft`<am-alert am-icon="x-circle" am-text="${m.text("pageNotFoundError")} ⟶ ${Gt()}"></am-alert>`}processResponse(e){const t=Object.create(null,{processResponse:{get:()=>super.processResponse}});var a;return Na(this,void 0,void 0,(function*(){if(yield t.processResponse.call(this,e),404===e.code)return this.pageNotFound(),void yt().error("Page not found");if(200===e.code&&(b("AutomadContentSaved"),this.bindings&&(this.bindings.pageDataFetchTimeBinding.value=e.time),e.data)){if(this.bindings||(this.bindings=(e=>{const t=new u("pageDataFetchTime",{initial:e.time});return{slugBinding:new u("pageSlug",{initial:e.data.fields[m.reservedFields.SLUG]}),pageDataFetchTimeBinding:t}})(e)),e.data.updateUI)return this.bindings.slugBinding.value=null!==(a=e.data.slug)&&void 0!==a?a:"",void(yield m.updateState());this.render(e)}}))}render(e){var t,a;const{url:s,fields:n,shared:o,template:l,readme:r}=e.data;if(!n)return;i("input",[],{type:"hidden","am-bind":"pageDataFetchTime","am-bind-to":"value",name:"dataFetchTime"},this);const c=m.reservedFields.THEME,d=m.themes;ia(n.title);let u={};u=n[c]?(null===(t=d[n[c]])||void 0===t?void 0:t.tooltips)||{}:(null===(a=d[o[c]])||void 0===a?void 0:a.tooltips)||{};const h=ut(n);this.mainSettings({section:this.sections.settings,url:s,fields:n,template:l,readme:r}),Object.keys(this.sections).forEach((e=>{ct({section:this.sections[e],fields:h[e],tooltips:u,shared:o})}))}});var Ua=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};class Da extends x{connectedCallback(){const e=Rt();if(![n.page,n.shared].includes(e))return void this.remove();const t=e===n.page,a=Gt();this.stateBinding=new u("publicationState",{initial:a?m.pages[a].publicationState:null}),this.publishController=t?"PageController::publish":"SharedController::publish",this.stateController=t?"PageController::getPublicationState":"SharedController::getPublicationState",this.classList.add("am-c-navbar__item"),this.innerHTML=ft`<am-form am-watch am-api="${this.publishController}" am-event="AutomadContentPublished"><am-submit disabled class="am-e-button"> ${m.text("publish")} </am-submit></am-form>`,this.button=l("am-submit",this),this.tooltip=new(Nt()),this.addListener(v(this.button,"mouseover",(()=>{this.tooltip&&this.lastPublished&&this.tooltip.show(this.button,i("span",[],{},null,`${m.text("lastPublished")}:<br>${g(this.lastPublished)}`),{})}))),this.addListener(v(this.button,"mouseleave",(()=>{this.tooltip.hide()}))),this.addListener(v(window,"AutomadContentSaved AutomadContentPublished",this.update.bind(this))),setTimeout((()=>{this.update()}),0)}update(){return Ua(this,void 0,void 0,(function*(){const{data:e}=yield Pt(this.stateController,{url:Gt()});this.lastPublished=e.lastPublished,this.stateBinding.value=e.isPublished?"published":"draft",e.isPublished?this.button.setAttribute("disabled",""):this.button.hasAttribute("disabled")&&this.button.removeAttribute("disabled")}))}}Da.TAG_NAME="am-publish-form",customElements.define(Da.TAG_NAME,Da);var ja=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-reset-password-form",class extends Sa{get states(){return{success:this.renderSuccess,setPassword:this.renderSetPassword,requestToken:this.renderRequestToken}}get initSelf(){return!0}processResponse(e){const t=Object.create(null,{processResponse:{get:()=>super.processResponse}});return ja(this,void 0,void 0,(function*(){if(t.processResponse.call(this,e),!e.data)return;const a=e.data;a.state&&Object.keys(this.states).includes(a.state)&&this.states[a.state].apply(this,[a])}))}renderRequestToken(e){this.innerHTML=ft`<h2>${m.text("resetPassword")}</h2><am-form-error></am-form-error><div class="am-c-card"><div class="am-c-card__body am-c-card__body--large"> ${m.text("passwordResetEnterNameOrEmail")} </div><div class="am-c-card__form"><input type="text" class="am-f-input" name="name-or-email" value="$${Vt("username")}" placeholder="${m.text("usernameOrEmail")}" /><div class="am-c-card__form-buttons"><am-link class="am-e-button" am-target="${n.login}"> ${m.text("cancel")} </am-link><am-submit class="am-e-button am-e-button--primary"> ${m.text("submit")} </am-submit></div></div></div>`}renderSetPassword(e){this.innerHTML=ft`<h2>${m.text("resetPassword")}</h2><am-form-error></am-form-error><div class="am-c-card"><div class="am-c-card__body am-c-card__body--large"> ${m.text("passwordResetEnterNewPassword")} </div><div class="am-c-card__form"><input type="text" class="am-f-input" name="token" autocomplete="reset-token" placeholder="${m.text("passwordResetToken")}" am-tooltip="${m.text("passwordResetToken")}" am-tooltip-options="placement: top" required /><input type="password" class="am-f-input" name="password1" autocomplete="new-password-1" placeholder="${m.text("password")}" am-tooltip="${m.text("password")}" am-tooltip-options="placement: top" required /><input type="password" class="am-f-input" name="password2" autocomplete="new-password-2" placeholder="${m.text("repeatPassword")}" am-tooltip="${m.text("repeatPassword")}" am-tooltip-options="placement: top" required /><input type="hidden" name="username" value="${e.username}" /><div class="am-c-card__form-buttons"><am-link class="am-e-button" am-target="${n.login}"> ${m.text("cancel")} </am-link><am-submit class="am-e-button am-e-button--primary"> ${m.text("passwordResetSave")} </am-submit></div></div></div>`}renderSuccess(e){this.innerHTML=ft`<h2>${m.text("resetPassword")}</h2><div class="am-c-card"><div class="am-c-card__body am-c-card__body--large"> ${m.text("passwordChangedSuccess")} </div><div class="am-c-card__form"><am-link class="am-e-button am-e-button--primary" am-target="${n.login}"> ${m.text("signIn")} </am-link></div></div>`}});var qa=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};const za=e=>{const{path:t,fieldResultsArray:a,url:i}=e,s=a.reduce(((e,t)=>e.concat([t.field])),[]);return ft`<div class="am-c-card"><div class="am-c-card__list"><div class="am-c-card__list-item am-c-card__list-item--faded am-u-flex am-u-flex--between am-u-flex--align-center"><am-link am-target="${t?`${n.page}?url=${i}`:n.shared}" class="am-c-icon-text am-u-text-link"><i class="bi bi-file-earmark-text"></i><span>${i||m.text("sharedTitle")}</span></am-link><am-checkbox name="${t}" value="${s.join()}"></am-checkbox></div> ${(e=>e.reduce(((e,t)=>ft`${e} <div class="am-c-card__list-item am-u-flex am-u-flex--column am-u-flex--gap"><span><span class="am-e-badge"> ${rt(t.field)} </span></span><span>${t.context}</span></div>`),""))(a)} </div></div>`};customElements.define("am-search-form",class extends x{get api(){return"SearchController::searchReplace"}connectedCallback(){this.classList.add("am-u-flex","am-u-flex--gap-large","am-u-flex--column");const e=i("section",["am-u-flex","am-u-flex--column","am-u-flex--gap"],{},this),{searchBar:t,search:a,isRegex:s,isCaseSensitive:n,replace:l}=this.createForm(e),{replaceButton:c,checkAll:d,unCheckAll:m}=this.createButtons(e),u=i("section",["am-u-flex","am-u-flex--column","am-u-flex--gap-large"],{},this),h=(e={})=>qa(this,void 0,void 0,(function*(){const t=Object.assign({searchValue:a.value,isRegex:s.checked,isCaseSensitive:n.checked},e),i=yield Pt(this.api,t);this.createResults(i,u)})),p=o((()=>qa(this,void 0,void 0,(function*(){const e=new URL(window.location.href);e.searchParams.set("search",a.value),window.history.replaceState(null,null,e),h()}))),200);v(t,"input",p,"input"),v(c,"click",(()=>{const e=JSON.stringify(dt(u));h({replaceValue:l.value,replaceSelected:!0,files:e})}));const g=e=>{r("input",u).forEach((t=>{t.checked=e,b("input",t)}))};v(d,"click",(()=>{g(!0)})),v(m,"click",(()=>{g(!1)})),p()}createResults(e,t){const a=e.data;t.innerHTML=a?a.reduce(((e,t)=>ft`${e} ${za(t)}`),""):ft`<am-alert am-icon="slash-circle" am-text="searchNoResults"></am-alert>`}createForm(e){const t=i("div",["am-u-flex","am-u-flex--gap"],{},e);return{searchBar:t,search:i("input",["am-f-input"],{type:"text",name:"searchValue",value:Vt("search"),placeholder:m.text("searchPlaceholder")},t),isRegex:i("am-custom-icon-checkbox",[],{name:"isRegex","am-icon":"regex","am-tooltip":m.text("searchIsRegex")},t),isCaseSensitive:i("am-custom-icon-checkbox",[],{name:"isCaseSensitive","am-icon":"type","am-tooltip":m.text("searchIsCaseSensitive")},t),replace:i("input",["am-f-input"],{type:"text",name:"replaceValue",placeholder:m.text("searchReplacePlaceholder")},e)}}createButtons(e){const t=i("div",["am-u-flex","am-u-flex--between"],{},e),a=i("span",["am-e-button","am-e-button--primary"],{},t);a.textContent=m.text("searchReplaceSelected");const s=i("div",["am-f-group"],{},t),n=i("span",["am-e-button","am-f-group__item"],{},s);n.textContent=m.text("searchReplaceCheckAll");const o=i("span",["am-e-button","am-f-group__item"],{},s);return o.textContent=m.text("searchReplaceUncheckAll"),{replaceButton:a,checkAll:n,unCheckAll:o}}});var Ga=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-setup-form",class extends Sa{connectedCallback(){this.renderForm()}processResponse(e){const t=Object.create(null,{processResponse:{get:()=>super.processResponse}});return Ga(this,void 0,void 0,(function*(){const{data:a}=e;if((null==a?void 0:a.php)&&(null==a?void 0:a.filename)&&(null==a?void 0:a.configDir)){this.renderSuccess(a.configDir,a.filename);const e=window.URL.createObjectURL(new Blob([a.php],{type:"application/octet-stream"}));i("a",[],{href:e,target:"_blank",download:a.filename}).click()}t.processResponse.call(this,e)}))}renderForm(){this.innerHTML=ft`<h2>Create User &mdash; Step 1/2</h2><am-form-error></am-form-error><div class="am-c-card"><div class="am-c-card__body am-c-card__body--large"><p> Create the first user account using the form below and download the account file to your computer. </p></div><div class="am-c-card__form"><input class="am-f-input" type="text" name="username" placeholder="Username" required /><input class="am-f-input" type="email" name="email" placeholder="Email" required /><input class="am-f-input" type="password" name="password1" placeholder="Password" required /><input class="am-f-input" type="password" name="password2" placeholder="Repeat Password" required /><div class="am-c-card__form-buttons"><am-submit class="am-e-button am-e-button--primary"> Create Account and Download File </am-submit></div></div></div>`}renderSuccess(e,t){this.innerHTML=ft`<h2>Create User &mdash; Step 2/2</h2><div class="am-c-card"><div class="am-c-card__body am-c-card__body--large"><p> Now, upload the downloaded <code>${t}</code> to your webserver and place it inside <code>${e}</code>. After the file is uploaded, hit the button below in order to sign in. </p></div><div class="am-c-card__form"><div class="am-c-card__form-buttons"><a href="./${n.login}" class="am-e-button am-e-button--primary"> I have uploaded the file, let me sign in! </a></div></div></div>`}});var Va=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-shared-data-form",class extends Sa{get parallel(){return!1}get auto(){return!0}get initSelf(){return!0}init(){this.sections=et(this),super.init(),this.addListener(v(window,"AutomadContentPublished",(()=>{this.bindings&&(this.bindings.sharedDataFetchTimeBinding.value=Math.ceil((new Date).getTime()/1e3))})))}processResponse(e){const t=Object.create(null,{processResponse:{get:()=>super.processResponse}});return Va(this,void 0,void 0,(function*(){yield t.processResponse.call(this,e),200===e.code&&(b("AutomadContentSaved"),this.bindings&&(this.bindings.sharedDataFetchTimeBinding.value=e.time),e.data&&(this.bindings||(this.bindings=(e=>({sharedDataFetchTimeBinding:new u("sharedDataFetchTime",{initial:e.time})}))(e)),this.render(e)))}))}render(e){var t,a;const{fields:s}=e.data,n=m.reservedFields.THEME,o=s[n]||Object.keys(m.themes)[0],l=null!==(a=null===(t=m.themes[o])||void 0===t?void 0:t.tooltips)&&void 0!==a?a:{},r=ut(s);i("input",[],{type:"hidden","am-bind":"sharedDataFetchTime","am-bind-to":"value",name:"dataFetchTime"},this);const c=Qe("am-title",this.sections.settings,{key:m.reservedFields.SITENAME,value:s[m.reservedFields.SITENAME],name:`data[${m.reservedFields.SITENAME}]`},[],{required:""});new u("sitename",{input:c.input,modifier:e=>e}),Qe("am-main-theme",this.sections.settings,{key:n,value:o,name:`data[${n}]`}),Qe("am-syntax-theme-select",this.sections.settings,{key:m.reservedFields.SYNTAX_THEME,value:s[m.reservedFields.SYNTAX_THEME],name:`data[${m.reservedFields.SYNTAX_THEME}]`}),Object.keys(this.sections).forEach((e=>{ct({section:this.sections[e],fields:r[e],tooltips:l})}))}});var Wa=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-system-update-form",class extends Sa{get states(){return{disabled:this.renderDisabled,notSupported:this.renderNotSupported,success:this.renderSuccess,connectionError:this.renderConnectionError,pending:this.renderPending,upToDate:this.renderUpToDate}}get parallel(){return!1}get initSelf(){return!0}processResponse(e){const t=Object.create(null,{processResponse:{get:()=>super.processResponse}});return Wa(this,void 0,void 0,(function*(){if(t.processResponse.call(this,e),this.progressModal&&this.progressModal.close(),!e.data)return;const a=e.data;a.state&&Object.keys(this.states).includes(a.state)&&this.states[a.state].apply(this,[a])}))}renderDisabled(e){this.innerHTML=ft`<am-alert am-icon="slash-circle" am-text="systemUpdateDisabled"></am-alert>`}renderNotSupported(e){this.innerHTML=ft`<am-alert am-icon="slash-circle" am-text="systemUpdateNotSupportedError"></am-alert>`}renderSuccess(e){this.renderUpToDate(e);const t=i("am-modal",[],{"am-no-esc":"","am-no-click":"","am-destroy":""},this);t.innerHTML=ft`<am-modal-dialog><am-modal-body> ${m.text("systemUpdateSuccess")} <br /><span> ${m.text("systemUpdateCurrentVersion")}: <strong>${e.current}</strong></span></am-modal-body><am-modal-footer><a href="${m.dashboardURL}" class="am-e-button am-e-button--primary"> ${m.text("systemUpdateSuccessReload")} </a></am-modal-footer></am-modal-dialog>`,t.open()}renderConnectionError(e){this.innerHTML=ft`<am-alert am-icon="hdd-network" am-text="systemUpdateConnectionError"></am-alert>`}renderPending(e){this.innerHTML=ft`<div class="am-c-alert"><input type="hidden" name="update" value="run" /><div class="am-c-alert__icon"><i class="bi bi-download"></i></div><div class="am-c-alert__text"><div> ${m.text("systemUpdateCurrentVersion")} <strong>${e.current}</strong>. <br /> ${m.text("systemUpdateAvailable")} </div><div class="am-u-flex am-u-flex--gap"><am-submit class="am-e-button am-e-button--primary"> ${m.text("systemUpdateTo")} <span class="am-e-badge">${e.latest}</span></am-submit><a href="https://automad.org/release-notes" class="am-e-button" target="_blank"> Release Notes </a></div></div></div><div><p>${m.text("systemUpdateItems")}</p> ${(e=>{let t="";return e.forEach((e=>{t+=ft`<li>${e}</li>`})),ft`<ul class="am-u-text-paragraph am-u-text-mono"> ${t} </ul>`})(e.items)} </div>`;const t=l("am-submit",this);v(t,"click",(()=>{this.progressModal=i("am-modal",[],{"am-no-esc":"","am-no-click":"","am-destroy":""},ea()),this.progressModal.innerHTML=ft`<am-modal-dialog><div class="am-c-modal__spinner"><span class="am-c-modal__spinner-icon"></span><span class="am-c-modal__spinner-text"> ${m.text("systemUpdateProgress")} </span></div></am-modal-dialog>`,this.progressModal.open()}))}renderUpToDate(e){this.innerHTML=ft`<am-alert am-icon="check-circle" am-text="systemUpToDate"></am-alert>`}});var Ja=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-trash-form",class extends x{connectedCallback(){this.init()}init(){return Ja(this,void 0,void 0,(function*(){this.innerHTML="";const{data:e}=yield Pt("PageTrashController::list"),t=i("div",["am-u-flex","am-u-flex--column","am-u-flex--gap"],{},this);e?e.forEach((e=>{((e,t)=>{const a=new Date(e.lastModified);i("div",["am-c-card"],{},t,ft`<div class="am-c-card__header"><div><am-icon-text class="am-c-card__title" am-icon="file-earmark-text" am-text="${e.title}"></am-icon-text><div class="am-c-card__body"> ${a.toLocaleString()} </div></div><div><am-dropdown class="am-c-card__header-dropdown" am-right><i class="bi bi-three-dots"></i><div class="am-c-dropdown__items"><am-form am-api="PageTrashController::restore"><input type="hidden" name="path" value="${e.path}" /><am-submit class="am-c-dropdown__link"><i class="bi bi-arrow-counterclockwise"></i><span>${m.text("trashRestore")}</span></am-submit></am-form><am-form am-api="PageTrashController::permanentlyDelete" am-confirm="${m.text("trashPermanentlyDeleteConfirm")}"><input type="hidden" name="path" value="${e.path}" /><am-submit class="am-c-dropdown__link"><i class="bi bi-x-lg"></i><span> ${m.text("trashPermanentlyDelete")} </span></am-submit></am-form></div></am-dropdown></div></div>`)})(e,t)})):i("am-alert",[],{"am-icon":"slash-circle","am-text":m.text("trashIsEmpty")},t)}))}});var Za=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-recently-edited-pages",class extends x{connectedCallback(){this.init()}init(){return Za(this,void 0,void 0,(function*(){this.innerHTML="<am-spinner></am-spinner>";const{data:e}=yield Pt("PageCollectionController::getRecentlyEdited");this.innerHTML="",this.classList.add("am-l-grid"),this.setAttribute("style","--min: 12rem;"),e.forEach((e=>{const t=`${n.page}?url=${e.url}`,a=Zt(e.url);i("div",["am-c-card","am-c-card--hover"],{},this,ft`<am-link am-target="${t}&section=files" class="am-c-card__teaser"> ${""!=e.thumbnail?`<img src="${Jt(e.thumbnail)}" />`:'<i class="bi bi-file-earmark-text"></i>'} </am-link><am-link am-target="${t}" class="am-c-card__title"> ${e.title} </am-link><am-link am-target="${t}" class="am-c-card__body"><span>${g(e.lastModified)}</span><span> ${e.fileCount} ${m.text(1===e.fileCount?"file":"files")} </span></am-link><div class="am-c-card__buttons"><am-link am-target="${t}"><span class="am-u-flex am-u-flex--gap am-u-flex--align-center"><span>${m.text("edit")}</span></span></am-link><a href="${a}" target="_blank"><span class="am-u-flex am-u-flex--gap am-u-flex--align-center"><span>${m.text("visit")}</span></span></a></div>`)}))}))}});var Ka=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-server-info",class extends x{connectedCallback(){this.init()}init(){return Ka(this,void 0,void 0,(function*(){const{data:e}=yield Pt("AppController::getServerInfo");this.innerHTML=ft`<table><tr><td>Host Name</td><td>${e.hostName}</td></tr><tr><td>Host IP</td><td>${e.hostIp}</td></tr><tr><td>Server OS</td><td>${e.serverOs}</td></tr><tr><td>Server Software</td><td>${e.serverSoftware}</td></tr><tr><td>PHP Version</td><td>${e.phpVersion}</td></tr><tr><td>PHP Sapi</td><td>${e.phpSapiName}</td></tr><tr><td>Memory Limit</td><td>${e.memoryLimit}</td></tr></table>`}))}});customElements.define("am-private-indicator",class extends x{connectedCallback(){this.classList.add("am-c-privacy-indicator"),this.addListener(v(window,"AutomadAppStateChange",this.render.bind(this))),this.render()}render(){var e;const t=Gt();this.innerHTML="",(null===(e=m.pages[t])||void 0===e?void 0:e.private)?i("i",["bi","bi-eye-slash-fill"],{},this):i("i",["bi","bi-eye"],{},this)}});class Ya extends x{connectedCallback(){this.render(),this.addListener(v(window,"AutomadAppStateChange",this.render.bind(this)))}}customElements.define("am-navbar-debug-indicator",class extends Ya{render(){this.classList.toggle("am-u-display-none",!m.system.debug),m.system.debug?this.innerHTML=ft`<am-link class="am-c-navbar__item" am-target="${n.system}?section=debug" am-tooltip="${m.text("debugEnabled")}"><i class="bi bi-bug"></i></am-link>`:this.innerHTML=""}});class Xa extends x{connectedCallback(){this.render(),this.addListener(v(window,"AutomadPackagesUpdateCheck",this.render.bind(this)))}}customElements.define("am-navbar-outdated-packages-indicator",class extends Xa{render(){const e=m.state.outdatedPackages;this.classList.toggle("am-u-display-none",!e),this.innerHTML=e>0?ft`<am-link class="am-c-navbar__item" am-target="${n.packages}" am-tooltip="${m.text("packagesUpdatesAvailable")}"><i class="bi bi-box-seam"></i></am-link>`:""}});class Qa extends x{connectedCallback(){this.render(),this.addListener(v(window,"AutomadSystemUpdateCheck",this.render.bind(this)))}}customElements.define("am-navbar-update-indicator",class extends Qa{render(){var e,t;this.classList.toggle("am-u-display-none",!(null===(e=m.state.systemUpdate)||void 0===e?void 0:e.pending)),(null===(t=m.state.systemUpdate)||void 0===t?void 0:t.pending)?this.innerHTML=ft`<am-link class="am-c-navbar__item" am-target="${n.system}?section=update" am-tooltip="${m.text("systemUpdateTooltip")}"><i class="bi bi-download"></i></am-link>`:this.innerHTML=""}});customElements.define("am-sidebar-outdated-packages-indicator",class extends Xa{render(){const e=m.state.outdatedPackages;this.classList.toggle("am-e-badge",e>0),this.innerHTML=e?ft`↓ ${e}`:""}});class ei extends Ya{render(){this.state?this.innerHTML=ft`<am-icon-text class="am-u-text-active" am-icon="check-circle" am-text="${this.textOn}"></am-icon-text>`:this.innerHTML=ft`<am-icon-text class="am-u-text-muted" am-icon="slash-circle" am-text="${this.textOff}"></am-icon-text>`}}customElements.define("am-system-cache-indicator",class extends ei{get textOn(){return m.text("cacheEnabled")}get textOff(){return m.text("cacheDisabled")}get state(){return m.system.cache.enabled}});customElements.define("am-system-debug-indicator",class extends ei{get textOn(){return m.text("debugEnabled")}get textOff(){return m.text("debugDisabled")}get state(){return m.system.debug}});customElements.define("am-system-feed-indicator",class extends ei{get textOn(){return m.text("feedEnabled")}get textOff(){return m.text("feedDisabled")}get state(){return m.system.feed.enabled}});customElements.define("am-system-i18n-indicator",class extends ei{get textOn(){return m.text("i18nEnabled")}get textOff(){return m.text("i18nDisabled")}get state(){return m.system.i18n}});customElements.define("am-system-mail-indicator",class extends Ya{render(){this.innerHTML=`<am-icon-text class="${"smtp"===m.system.mail.transport?"am-u-text-active":"am-u-text-muted"}" am-icon="send" am-text="${m.system.mail.transport}"></am-icon-text>`}});customElements.define("am-system-update-indicator",class extends Qa{render(){var e,t;(null===(e=m.state.systemUpdate)||void 0===e?void 0:e.pending)?this.innerHTML=ft`<span class="am-u-text-active am-c-icon-text"><i class="bi bi-download"></i><span> ${m.text("systemUpdateTo")} ${null===(t=m.state.systemUpdate)||void 0===t?void 0:t.latest} </span></span>`:this.innerHTML=ft`<am-icon-text class="am-u-text-muted" am-icon="check-circle" am-text="${m.text("systemUpToDate")}"></am-icon-text>`}});customElements.define("am-user-count-indicator",class extends Ya{render(){this.textContent=`${m.system.users.length}`}});customElements.define("am-modal-body",class extends x{connectedCallback(){this.classList.add("am-c-modal__body")}});customElements.define("am-modal-close",class extends x{connectedCallback(){v(this,"click",(()=>{const e=this.closest(y.TAG_NAME);e instanceof y&&e.close()}).bind(this))}});customElements.define("am-modal-dialog",class extends x{connectedCallback(){this.classList.add("am-c-modal__dialog")}});customElements.define("am-modal-footer",class extends x{connectedCallback(){this.classList.add("am-c-modal__footer")}});customElements.define("am-modal-header",class extends x{connectedCallback(){this.classList.add("am-c-modal__header"),i("am-modal-close",["am-c-modal__close"],{},this)}});class ti extends y{constructor(){super(...arguments),this.classes=["am-c-modal-field"]}connectedCallback(){super.connectedCallback(),this.render(),this.addListener(v(this,"click",(()=>{r(ti.TAG_NAME).forEach((e=>{e.removeAttribute("style")})),this.style.zIndex="40"})))}render(){const e=this.getAttribute("am-page")||m.text("sharedTitle");i("div",["am-c-modal-field__header"],{},this,ft`<am-icon-text am-icon="file-earmark-text" am-text="${e}"></am-icon-text><span class="am-c-modal-field__toggle">↙</span>`),i("div",["am-c-modal-field__toggle"],{},this).innerHTML="↗",v(this,"click",(()=>{this.toggle()}),".am-c-modal-field__toggle")}}ti.TAG_NAME="am-modal-field",customElements.define(ti.TAG_NAME,ti);customElements.define("am-modal-jumpbar",class extends y{connectedCallback(){super.connectedCallback(),i("am-modal-jumpbar-dialog",[],{placeholder:"jumpbarButtonText"},this),this.addListener(aa("j",(()=>{m.navigationIsLocked||this.open()}))),v(this,"focusout",(()=>{this.close()}),"input")}lockNavigation(){}unlockNavigation(){}saveInitialFormData(){}restoreInitialFormData(){}});class ai extends x{constructor(){super(...arguments),this.items=[],this.selectedIndex=null,this.initialIndex=null,this.maxItems=8,this.elementClasses=["am-c-dropdown"],this.inputClasses=["am-f-input"],this.itemsClasses=["am-c-dropdown__items","am-c-dropdown__items--autocomplete"],this.linkClass="am-c-dropdown__link",this.linkActiveClass="am-active"}static get observedAttributes(){return["placeholder","name","value"]}get data(){var e;const t=[];return(null!==(e=this.getAttribute("am-data"))&&void 0!==e?e:"").split(",").forEach((e=>{const a=e.trim();t.push({value:a,title:a})})),t}get minInputLength(){var e;return parseInt(null!==(e=this.getAttribute("am-min"))&&void 0!==e?e:"1")}connectedCallback(){this.classList.add(...this.elementClasses),this.addListener(v(window,"AutomadAppStateChange",this.init.bind(this))),this.init()}init(){void 0!==this.data&&(this.innerHTML="",this.items=[],this.input=this.createInput(),this.dropdown=i("div",this.itemsClasses,{},this),this.data.forEach((e=>{this.items.push({element:this.createItemElement(e),value:this.createItemValue(e),item:e})})),this.itemsFiltered=this.items,this.registerDropdownEvents(),this.registerInputEvents(),this.update())}createInput(){const e={type:"text"},t=m.text(this.elementAttributes.placeholder);return t&&(e.placeholder=t),this.elementAttributes.name&&(e.name=this.elementAttributes.name),this.elementAttributes.value&&(e.value=this.elementAttributes.value),i("input",this.inputClasses,e,this)}createItemElement(e){return i("a",[this.linkClass],{},null,ft`$${e.title}`)}createItemValue(e){return e.value.toLowerCase()}renderDropdown(){this.dropdown.innerHTML="",this.itemsFiltered.forEach((e=>{this.dropdown.appendChild(e.element)}))}update(){const e=this.input.value.toLowerCase().split(" ");let t=0;this.itemsFiltered=[],this.items.forEach((a=>{var i=!0;if(t<this.maxItems){for(var s=0;s<e.length;s++)if(-1==a.value.indexOf(e[s])){i=!1;break}i&&(this.itemsFiltered.push(a),t++)}})),this.selectedIndex=this.initialIndex,this.renderDropdown(),this.toggleActiveItemStyle()}onKeyDownEvent(e){switch(e.keyCode){case 38:this.prev(e);break;case 40:this.next(e);break;case 13:this.select(e);break;case 9:case 27:this.input.blur(),this.close()}}onKeyUpEvent(e){[38,40,13,9,27].includes(e.keyCode)||(this.update(),this.open())}onMouseOverEvent(e){let t=e.target;t.matches(`.${this.linkClass}`)||(t=t.closest(`.${this.linkClass}`)),this.selectedIndex=Array.from(this.dropdown.children).indexOf(t),this.toggleActiveItemStyle()}registerInputEvents(){v(this.input,"keydown",this.onKeyDownEvent.bind(this)),v(this.input,"keyup",o(this.onKeyUpEvent.bind(this))),v(this.input,"focus",this.open.bind(this)),v(document,"click",(e=>{this.contains(e.target)||this.close()}))}registerDropdownEvents(){v(this.dropdown,"mouseover",(e=>{this.onMouseOverEvent(e)}),`.${this.linkClass}`),v(this.dropdown,"click",(e=>{this.select(e)}),`.${this.linkClass}`)}toggleActiveItemStyle(){this.itemsFiltered.forEach(((e,t)=>{e.element.classList.toggle(this.linkActiveClass,t==this.selectedIndex)}))}close(){this.selectedIndex=this.initialIndex,this.toggleActiveItemStyle(),this.classList.remove("am-c-dropdown--open")}open(){this.input.value.length>=this.minInputLength&&(this.update(),this.classList.add("am-c-dropdown--open"))}prev(e){e.stopImmediatePropagation(),e.preventDefault(),this.selectedIndex--,this.selectedIndex<0&&(this.selectedIndex=this.itemsFiltered.length-1),this.toggleActiveItemStyle()}next(e){e.stopImmediatePropagation(),e.preventDefault(),null===this.selectedIndex?this.selectedIndex=0:(this.selectedIndex++,this.selectedIndex>this.itemsFiltered.length-1&&(this.selectedIndex=0)),this.toggleActiveItemStyle()}select(e){e.stopImmediatePropagation(),e.preventDefault(),null!==this.selectedIndex&&(this.input.value=this.itemsFiltered[this.selectedIndex].value),this.close(),b("AutomadAutocompleteSelect",this)}}customElements.define("am-autocomplete",ai);const ii=()=>[].concat([{target:n.search,value:m.text("searchTitle"),title:m.text("searchTitle"),icon:"search",cls:["am-c-modal__jumpbar-divider"]}],[{external:m.baseIndex||"/",value:m.text("inPageEdit"),title:m.text("inPageEdit"),icon:"window-desktop",cls:["am-c-modal__jumpbar-divider"]}],(()=>{const e=(e,t,a,i=[])=>({target:`${n.system}?section=${e}`,value:`${m.text("systemTitle")} ${m.text(t)}`,title:m.text(t),subtitle:m.text("systemTitle"),icon:a,cls:i});return[e("cache","systemCache","device-ssd"),e("users","systemUsers","person-badge"),e("feed","systemRssFeed","rss"),e("mail","systemMail","envelope"),e("i18n","systemI18n","globe"),e("language","systemLanguage","translate"),e("debug","systemDebug","bug"),e("update","systemUpdate","arrow-repeat",["am-c-modal__jumpbar-divider"])]})(),[{target:n.shared,value:m.text("sharedTitle"),title:m.text("sharedTitle"),icon:"file-earmark-medical",cls:["am-c-modal__jumpbar-divider"]}],[{target:n.packages,value:m.text("packagesTitle"),title:m.text("packagesTitle"),icon:"box-seam",cls:["am-c-modal__jumpbar-divider"]}],[{target:n.trash,value:m.text("trashTitle"),title:m.text("trashTitle"),icon:"trash3",cls:["am-c-modal__jumpbar-divider"]}],(()=>{const e=[],t=Object.values(m.pages);return t.sort(((e,t)=>e.lastModified<t.lastModified?1:t.lastModified<e.lastModified?-1:0)),t.forEach((t=>{const a=t.private?"eye-slash-fill":"file-earmark-text";e.push({target:`${n.page}?url=${t.url}`,value:`${t.title} ${t.url}`,title:t.title,subtitle:t.url,icon:a})})),e})());customElements.define("am-modal-jumpbar-dialog",class extends ai{constructor(){super(...arguments),this.initialIndex=0,this.elementClasses=["am-c-modal__dialog"],this.inputClasses=["am-c-modal__jumpbar-input"],this.itemsClasses=["am-c-modal__jumpbar-items"],this.linkClass="am-c-modal__jumpbar-link",this.linkActiveClass="am-active"}get data(){return ii()}get minInputLength(){return 0}createItemElement(e){const t={};e.external&&(t["am-external"]=e.external),e.target&&(t["am-target"]=e.target);const a=e.cls||[],s=i("am-link",a.concat("am-c-modal__jumpbar-link"),t);return s.innerHTML=this.itemHtml(e.icon,e.title,e.subtitle),s}createItemValue(e){return e.value.toLowerCase()}itemHtml(e,t,a){return ft`<i class="bi bi-${e}"></i><span>$${t}</span><span class="am-u-text-muted">$${a||""}</span>`}update(){const e=this.itemsFiltered[0];e.element.setAttribute("am-target",`${n.search}?search=${encodeURIComponent(this.input.value).replace(/%20/g,"+")}`),e.value=`${e.value} ${this.input.value.toLowerCase()}`,e.element.innerHTML=this.itemHtml(e.item.icon,e.item.title,this.input.value),this.maxItems=Math.floor((window.innerHeight-150)/46),super.update()}close(){this.selectedIndex=this.initialIndex,this.toggleActiveItemStyle()}open(){this.update()}select(e){e.preventDefault(),null!==this.selectedIndex&&this.itemsFiltered[this.selectedIndex].element.click(),this.close()}});customElements.define("am-modal-toggle",class extends x{static get observedAttributes(){return["am-modal"]}connectedCallback(){v(this,"click",(()=>{l(this.elementAttributes["am-modal"]).toggle()}).bind(this))}});var si=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};const ni=(e,t,a)=>si(void 0,void 0,void 0,(function*(){const i=st(a);i.open();const{error:s,success:n}=yield Pt(t,{package:e.name});s&&Tt(s),n&&At(n),i.close(),b("AutomadPackagesChange"),m.checkForOutdatedPackages()})),oi=(e,t)=>{const a=i("div",["am-c-card__buttons"],{},t);e.installed?(((e,t)=>{const a=i("span",[],{},t);i("span",[],{},a).textContent=m.text("packageRemove"),v(a,"click",(()=>{ni(e,"PackageManagerController::remove",m.text("packageRemoving"))}))})(e,a),e.outdated&&((e,t)=>{const a=i("span",[],{},t);i("span",[],{},a).textContent=m.text("packageUpdate"),v(a,"click",(()=>{ni(e,"PackageManagerController::update",m.text("packageUpdating"))}))})(e,a)):((e,t)=>{const a=i("span",[],{},t);i("span",[],{},a).textContent=m.text("packageInstall"),v(a,"click",(()=>{ni(e,"PackageManagerController::install",m.text("packageInstalling"))}))})(e,a)};customElements.define("am-package-card",class extends x{set data(e){this.render(e)}render(e){return si(this,void 0,void 0,(function*(){this.classList.add("am-c-card"),this.classList.toggle("am-c-card--active",e.installed);const t=`https://packages.automad.org/${e.name}`;((e,t,a)=>{i("div",["am-c-card__header"],{},a,ft`<div class="am-c-card__title"> $${e.name.split("/")[0]} /<br />$${e.name.split("/")[1]} </div><am-dropdown class="am-c-card__header-dropdown" am-right><i class="bi bi-three-dots"></i><div class="am-c-dropdown__items"><a href="${t}" class="am-c-dropdown__link" target="_blank"><am-icon-text am-icon="file-richtext" am-text="Readme"></am-icon-text></a><a href="${e.repository}" class="am-c-dropdown__link" target="_blank"><am-icon-text am-icon="git" am-text="Repository"></am-icon-text></a></div></am-dropdown>`)})(e,t,this),((e,t,a)=>{const s=e=>{i("i",["bi","bi-box-seam"],{},e)},n=i("a",["am-c-card__teaser"],{href:t,target:"_blank"},a);if(e.version){const t=["am-e-badge"],a=[e.version];e.outdated&&(a.push(""),a.push(e.latest)),i("span",t,{},n,a.join(" "))}if(e.image){const t=i("img",[],{src:e.image},n);v(t,"error",(()=>{t.remove(),s(n)}))}else s(n)})(e,t,this),((e,t)=>{i("span",["am-u-text-limit-rows"],{},i("div",["am-c-card__body"],{},t)).textContent=e.description})(e,this),oi(e,this)}))}});var li=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-package-list",class extends x{connectedCallback(){this.classList.add("am-l-grid"),this.init(),this.addListener(v(window,"AutomadPackagesChange",this.init.bind(this)))}init(){return li(this,void 0,void 0,(function*(){this.innerHTML="<am-spinner></am-spinner>";try{const e=yield li(void 0,void 0,void 0,(function*(){const{data:e}=yield Pt("PackageManagerController::getPackageCollection");if(!e)return[];const t=e.packages;return t.sort(((e,t)=>e.installed<t.installed?1:t.installed<e.installed?-1:0)),t}));this.innerHTML="",e.forEach((e=>{i("am-package-card",[],{},this).data=e}))}catch(e){i("am-alert",[],{icon:"exclamation-circle",type:"danger",text:"packagistConnectionError"},this)}}))}});var ri=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-update-all-packages",class extends x{connectedCallback(){this.classList.add("am-u-display-none","am-e-button"),this.textContent=m.text("packagesUpdateAll"),this.init(),this.addListener(v(window,"AutomadPackagesUpdateCheck",this.init.bind(this))),v(this,"click",(()=>ri(this,void 0,void 0,(function*(){const e=st(m.text("packagesUpdatingAll"));e.open();const{error:t,success:a}=yield Pt("PackageManagerController::updateAll");t&&Tt(t),a&&At(a),e.close(),b("AutomadPackagesChange"),m.checkForOutdatedPackages()}))))}init(){return ri(this,void 0,void 0,(function*(){const e=m.state.outdatedPackages>0;this.classList.toggle("am-u-display-none",!e)}))}});class ci extends x{constructor(){super(...arguments),this.partials={}}init(){return ia(this.pageTitle),this.innerHTML=this.template(this.partials),this}}const di=({main:e})=>ft`<div class="am-l-dashboard"><div class="am-l-dashboard__navbar am-l-dashboard__navbar--left"><div class="am-c-navbar"><am-link am-target="${n.home}" class="am-c-navbar__item"><am-logo></am-logo></am-link><am-modal-toggle am-modal="#am-add-page-modal" class="am-c-navbar__item" am-tooltip="${m.text("addPage")}"><span>${m.text("new")}</span><i class="bi bi-plus-lg"></i></am-modal-toggle></div></div><div class="am-l-dashboard__navbar am-l-dashboard__navbar--right"><div class="am-c-navbar"><am-link am-target="${n.home}" class="am-u-display-small am-c-navbar__item"><am-logo></am-logo></am-link><am-modal-toggle class="am-c-navbar__item am-u-display-small-none" am-modal="#am-jumpbar-modal"><span> ${m.text("jumpbarButtonText")} </span><am-key-combo-badge am-key="J"></am-key-combo-badge></am-modal-toggle><span class="am-c-navbar__group"><am-navbar-update-indicator class="am-u-display-small-none"></am-navbar-update-indicator><am-navbar-outdated-packages-indicator class="am-u-display-small-none"></am-navbar-outdated-packages-indicator><am-navbar-debug-indicator class="am-u-display-small-none"></am-navbar-debug-indicator><am-undo-buttons class="am-u-display-small-none"></am-undo-buttons><am-publish-form></am-publish-form><am-modal-toggle class="am-c-navbar__item am-u-display-small" am-modal="#am-jumpbar-modal"><i class="bi bi-menu-button-wide"></i></am-modal-toggle><am-sidebar-toggle class="am-c-navbar__item am-u-display-small"><i class="bi bi-list"></i></am-sidebar-toggle><am-dropdown class="am-u-display-small-none" am-right><span class="am-c-navbar__item"><i class="bi bi-three-dots"></i></span><div class="am-c-dropdown__items"><span class="am-c-dropdown__content am-c-dropdown__divider"><am-dashboard-theme-toggle></am-dashboard-theme-toggle></span><am-modal-toggle class="am-c-dropdown__link" am-modal="#am-about-modal"><i class="bi bi-info-circle"></i><span>${m.text("aboutAutomad")}</span></am-modal-toggle><a href="https://automad.org" target="_blank" class="am-c-dropdown__link am-c-dropdown__divider"><i class="bi bi-book"></i><span>${m.text("documentation")}</span></a><am-link class="am-c-dropdown__link am-c-dropdown__divider" am-target="${n.system}?section=users"><i class="bi bi-people"></i><span>${m.text("systemUsers")}</span></am-link><span class="am-c-dropdown__label"> ${m.text("signedInAs")} ${m.user.name} </span><am-submit class="am-c-dropdown__link" am-form="SessionController::logout"><i class="bi bi-box-arrow-right"></i><span> ${m.text("signOut")} </span></am-submit></div></am-dropdown></span></div></div><am-sidebar-toggle class="am-l-dashboard__sidebar-backdrop"></am-sidebar-toggle><am-sidebar class="am-l-dashboard__sidebar"><div class="am-l-dashboard__sidebar-navbar"><div class="am-c-navbar"><am-modal-toggle am-modal="#am-add-page-modal" class="am-c-navbar__item" am-tooltip="${m.text("addPage")}"><span>${m.text("new")}</span><i class="bi bi-plus-lg"></i></am-modal-toggle></div></div><nav class="am-c-nav"><span class="am-c-nav__item"><a href="${m.baseIndex||"/"}" class="am-c-nav__link"><span class="am-c-icon-text"><i class="bi bi-window-desktop"></i><span am-bind="sitename" am-bind-to="textContent"> $${m.sitename} </span></span></a></span><am-nav-item am-page="search" am-icon="search" am-text="searchTitle"></am-nav-item><am-nav-item am-page="system" am-icon="sliders" am-text="systemTitle"></am-nav-item><am-nav-item am-page="shared" am-icon="asterisk" am-text="sharedTitle" am-publication-state="${m.sharedPublicationState}" ${Rt()==n.shared?'\n\t\t\t\t\t\t\tam-bind="publicationState"\n\t\t\t\t\t\t\tam-bind-to="am-publication-state"\n\t\t\t\t\t\t':""}></am-nav-item><am-nav-item am-page="packages" am-icon="box-seam" am-text="packagesTitle" am-badge="am-sidebar-outdated-packages-indicator"></am-nav-item><am-nav-item am-page="trash" am-icon="trash3" am-text="trashTitle"></am-nav-item></nav><am-nav-tree></am-nav-tree><div class="am-c-nav am-u-display-small"><span class="am-c-nav__item"><am-modal-toggle class="am-c-nav__link" am-modal="#am-about-modal"><i class="bi bi-info-circle"></i><span>${m.text("aboutAutomad")}</span></am-modal-toggle></span><span class="am-c-nav__item"><am-submit class="am-c-nav__link" am-form="SessionController::logout"><i class="bi bi-box-arrow-right"></i><span> ${m.text("signOut")} ${m.user.name} </span></am-submit></span><am-dashboard-theme-toggle></am-dashboard-theme-toggle></div></am-sidebar><div class="am-l-dashboard__main">${e}</div><footer class="am-l-dashboard__footer"><am-modal-toggle class="am-u-cursor-pointer am-u-flex am-u-flex--gap" am-modal="#am-about-modal"><span class="am-e-badge am-e-badge--muted"> ${m.version} </span></am-modal-toggle></footer></div><!-- Sign out form --><am-form am-api="SessionController::logout"></am-form><!-- Jumpbar Modal --><am-modal-jumpbar id="am-jumpbar-modal"></am-modal-jumpbar><!-- New Page Modal --><am-modal id="am-add-page-modal"><am-modal-dialog><am-form am-api="PageController::add"><am-modal-header>${m.text("addPage")}</am-modal-header><am-modal-body> ${Qe("am-input",null,{key:`new-${m.reservedFields.TITLE}`,name:m.reservedFields.TITLE,label:sa(m.reservedFields.TITLE),value:m.text("newPageTitle")},[],{required:""}).outerHTML} <div class="am-c-field"><label class="am-c-field__label">${m.text("pageTemplate")}</label><am-page-template-select value=""></am-page-template-select></div> ${Qe("am-toggle-large",null,{key:`new-${m.reservedFields.PRIVATE}`,name:m.reservedFields.PRIVATE,label:m.text("keepPagePrivate"),value:!0}).outerHTML} <div class="am-c-field"><label class="am-c-field__label">${m.text("selectTargetNewPage")}</label><am-page-select-tree></am-page-select-tree></div></am-modal-body><am-modal-footer><am-modal-close class="am-e-button"> ${m.text("cancel")} </am-modal-close><am-submit class="am-e-button am-e-button--primary"> ${m.text("addPage")} </am-submit></am-modal-footer></am-form></am-modal-dialog></am-modal><!-- About Automad Modal --><am-modal id="am-about-modal"><am-modal-dialog class="am-c-modal__dialog--small"><am-modal-body><am-logo></am-logo><hr /> Automad is a modern flat-file content management system and templating engine <hr /><span class="am-u-flex am-u-flex--between"><a href="https://automad.org" target="_blank" class="am-u-text-link">Open Website</a><a href="https://automad.org/release-notes" class="am-e-badge" target="_blank"> ${m.version} </a></span></am-modal-body></am-modal-dialog></am-modal>`;class mi extends ci{constructor(){super(...arguments),this.template=di,this.partials={main:this.renderMainPartial()}}}customElements.define(Bt(n.home),class extends mi{get pageTitle(){return m.text("dashboardTitle")}renderMainPartial(){return ft`<section class="am-l-dashboard__section"><div class="am-l-dashboard__content"><div class="am-u-flex am-u-flex--column am-u-flex--gap-large"><div class="am-u-flex am-u-flex--gap am-u-flex--align-baseline"><h1 class="am-e-base-home-h1">${m.sitename}</h1><am-link class="am-u-text-muted" am-target="${n.shared}"><i class="bi bi-pencil"></i></am-link></div> ${ft`<div class="am-u-flex am-u-flex--column am-u-flex--gap-large"><div class="am-u-flex am-u-flex--column"><am-icon-text am-icon="hdd-network" am-text="${location.hostname}" class="am-u-text-muted"></am-icon-text><am-icon-text am-icon="clock-history" am-text="${m.text("latestActivity")} ${g(m.siteMTime)}" class="am-u-text-muted"></am-icon-text><am-link am-target="${n.system}?section=cache"><am-system-cache-indicator></am-system-cache-indicator></am-link></div><div class="am-u-display-small"><a href="${m.baseIndex||"/"}" class="am-e-button"> ${m.text("inPageEdit")} </a></div><div class="am-f-group am-u-display-small-none"><a href="${m.baseIndex||"/"}" class="am-e-button am-f-group__item"> ${m.text("inPageEdit")} </a><am-modal-toggle am-modal="#am-server-info-modal" class="am-e-button am-f-group__item"> ${m.text("serverInfo")} </am-modal-toggle></div></div><am-modal id="am-server-info-modal"><am-modal-dialog><am-modal-header>${m.text("serverInfo")}</am-modal-header><am-modal-body><am-server-info></am-server-info></am-modal-body></am-modal-dialog></am-modal>`} <div><h2>${m.text("recentlyEditedPages")}</h2><div><am-recently-edited-pages></am-recently-edited-pages></div></div></div></div></section>`}});const ui=({main:e})=>ft`<div class="am-l-inpage"><div class="am-l-inpage__navbar"><nav class="am-c-navbar"><span class="am-c-navbar__group am-u-flex--gap"><a class="am-c-navbar__item" am-bind="inPageContextUrl" am-bind-to="href"><span am-bind="inPageTitle"></span></a><span class="am-e-badge" am-bind="inPageField"></span></span><span class="am-u-flex am-u-flex--gap am-u-flex--align-center"><am-undo-buttons></am-undo-buttons><span class="am-c-navbar__item"><am-submit class="am-e-button" am-form="InPageController::edit" disabled> ${m.text("save")} </am-submit></span><am-link href="${m.baseIndex||"/"}" class="am-c-navbar__item" am-bind="inPageReturnUrl" am-bind-to="am-external"><i class="bi bi-x"></i></am-link></span></nav></div><div class="am-l-inpage__main"><div class="am-l-inpage__content">${e}</div></div></div>`;customElements.define(Bt(n.inpage),class extends ci{constructor(){super(...arguments),this.template=ui,this.partials={main:this.renderMainPartial()}}get pageTitle(){return"InPage"}renderMainPartial(){return"<am-inpage-form></am-inpage-form>"}});const hi=({main:e})=>ft`<div class="am-l-centered"><div class="am-l-centered__navbar"><nav class="am-c-navbar"><a href="${m.baseIndex||"/"}" class="am-c-navbar__item"><am-logo></am-logo></a><a href="${m.baseIndex||"/"}" class="am-c-navbar__item" am-tooltip="${m.text("close")}"><i class="bi bi-x"></i></a></nav></div><div class="am-l-centered__main"><div class="am-l-centered__content">${e}</div></div></div>`;class pi extends ci{constructor(){super(...arguments),this.template=hi,this.partials={main:this.renderMainPartial()}}}customElements.define(Bt(n.login),class extends pi{get pageTitle(){return m.text("signIn")}renderMainPartial(){return ft`<h2>$${m.sitename} &mdash; ${m.text("signIn")}</h2><am-form am-api="SessionController::login" am-focus am-enter><am-form-error></am-form-error><div class="am-c-card"><div class="am-c-card__form"><input class="am-f-input" type="text" name="name-or-email" placeholder="${m.text("usernameOrEmail")}" required /><input class="am-f-input" type="password" name="password" placeholder="${m.text("password")}" required /><div class="am-c-card__form-buttons"><am-link am-target="${n.resetpassword}" class="am-e-button"> ${m.text("forgotPassword")} </am-link><am-submit class="am-e-button am-e-button--primary"> ${m.text("signIn")} </am-submit></div></div></div></am-form>`}});customElements.define(Bt(n.packages),class extends mi{get pageTitle(){return m.text("packagesTitle")}renderMainPartial(){return ft`<am-breadcrumbs-route am-target="${n.packages}" am-text="${this.pageTitle}"></am-breadcrumbs-route><section class="am-l-dashboard__section am-l-dashboard__section--sticky"><div class="am-l-dashboard__content am-l-dashboard__content--row am-u-flex--gap"><am-update-all-packages></am-update-all-packages><am-filter placeholder="packagesFilter"></am-filter></div></section><section class="am-l-dashboard__section"><div class="am-l-dashboard__content"><am-package-list></am-package-list></div></section>`}});const gi=()=>ft`<am-modal id="am-file-import-modal"><am-modal-dialog><am-form am-api="FileController::import" am-event="AutomadFilesChangeOnServer"><am-modal-body><div class="am-c-field"><input class="am-f-input" name="importUrl" type="text" placeholder="URL" /></div></am-modal-body><am-modal-footer><am-modal-close class="am-e-button"> ${m.text("cancel")} </am-modal-close><am-submit class="am-e-button am-e-button--primary"> ${m.text("importFromUrl")} </am-submit></am-modal-footer></am-form></am-modal-dialog></am-modal>`,bi=()=>ft`<am-breadcrumbs-page></am-breadcrumbs-page>`,vi=()=>ft`<section class="am-l-dashboard__section am-l-dashboard__section--sticky"><div class="am-l-dashboard__content am-l-dashboard__content--row"><am-switcher><div class="am-c-menu am-u-display-small-none"><am-switcher-link class="am-c-menu__item" am-section="settings"> ${m.text("fieldsSettings")} </am-switcher-link><am-switcher-link class="am-c-menu__item" am-section="text"> ${m.text("fieldsContent")} </am-switcher-link><am-switcher-link class="am-c-menu__item" am-section="colors"> ${m.text("fieldsColors")} </am-switcher-link><am-switcher-link class="am-c-menu__item" am-section="files"> ${m.text("uploadedFiles")} <span class="am-e-badge"><am-file-count></am-file-count></span></am-switcher-link></div><am-dropdown class="am-u-display-small am-e-button"><span class="am-c-icon-text"><am-switcher-label></am-switcher-label><span class="am-e-dropdown-arrow"></span></span><div class="am-c-dropdown__items"><am-switcher-link class="am-c-dropdown__link" am-section="settings"> ${m.text("fieldsSettings")} </am-switcher-link><am-switcher-link class="am-c-dropdown__link" am-section="text"> ${m.text("fieldsContent")} </am-switcher-link><am-switcher-link class="am-c-dropdown__link" am-section="colors"> ${m.text("fieldsColors")} </am-switcher-link><am-switcher-link class="am-c-dropdown__link" am-section="files"> ${m.text("uploadedFiles")} </am-switcher-link></div></am-dropdown></am-switcher><am-filter placeholder="filterContent"></am-filter><am-private-indicator class="am-u-display-small-none"></am-private-indicator> ${(()=>{let e="";return"/"!=Gt()&&(e=ft`<am-form am-api="PageController::duplicate"><am-submit class="am-c-dropdown__link"><am-icon-text am-icon="files" am-text="${m.text("duplicatePage")}"></am-icon-text></am-submit></am-form><am-modal-toggle class="am-c-dropdown__link" am-modal="#am-move-page-modal"><am-icon-text am-icon="arrows-move" am-text="${m.text("movePage")}"></am-icon-text></am-modal-toggle><am-copy class="am-c-dropdown__link am-c-dropdown__divider" value="${Gt()}"><am-icon-text am-icon="clipboard-plus" am-text="${m.text("copyUrlClipboard")}"></am-icon-text></am-copy><am-form am-api="PageController::delete" am-confirm="${m.text("confirmDeletePage")}"><am-submit class="am-c-dropdown__link"><am-icon-text am-icon="trash3" am-text="${m.text("deletePage")}"></am-icon-text></am-submit></am-form>`),ft`<am-dropdown am-right><span class="am-c-menu__item"><span class="am-u-display-small-none">${m.text("more")}</span><span class="am-u-display-small-none am-e-dropdown-arrow"></span><span class="am-u-display-small am-e-button am-e-button--icon"><i class="bi bi-three-dots-vertical"></i></span></span><div class="am-c-dropdown__items"><am-modal-toggle class="am-c-dropdown__link" am-modal="#${Ha.MODAL_ID}"><am-icon-text am-icon="clock-history" am-text="${m.text("pageHistory")}"></am-icon-text></am-modal-toggle><span class="am-c-dropdown__divider"></span><a href="${m.baseIndex}${Gt()}" class="am-c-dropdown__link"><am-icon-text am-icon="pencil" am-text="${m.text("inPageEdit")}"></am-icon-text></a> ${e} </div></am-dropdown>`})()} </div></section>`;customElements.define(Bt(n.page),class extends mi{get pageTitle(){return Gt()}renderMainPartial(){return m.system.i18n&&"/"===Gt()?ft`${bi()} <section class="am-l-dashboard__section"><div class="am-l-dashboard__content"><am-alert am-icon="globe" am-text="i18nEnabled"></am-alert><am-link am-target="${n.system}?section=i18n" class="am-e-button"> ${m.text("systemI18n")} </am-link></div></section>`:ft`${bi()}${vi()} <section class="am-l-dashboard__section"><div class="am-l-dashboard__content"><am-page-data-form am-api="PageController::data"></am-page-data-form><am-switcher-section name="files"><am-upload></am-upload><div class="am-u-flex am-u-flex--gap"><am-modal-toggle class="am-e-button am-e-button--primary" am-modal="#am-file-import-modal"> ${m.text("importFromUrl")} </am-modal-toggle><am-file-collection-submit class="am-e-button am-e-button--danger" am-form="FileCollectionController::list"> ${m.text("deleteSelected")} </am-file-collection-submit></div><am-file-collection-list-form am-confirm="${m.text("confirmDeleteSelectedFiles")}" am-api="FileCollectionController::list"></am-file-collection-list-form></am-switcher-section></div></section> ${"/"===Gt()?"":ft`<am-modal id="am-move-page-modal"><am-modal-dialog><am-form am-api="PageController::move"><am-modal-header>${m.text("movePage")}</am-modal-header><am-modal-body><div class="am-c-field"><label class="am-c-field__label"> ${m.text("selectTargetMovePage")} </label><am-page-select-tree am-hide-current></am-page-select-tree></div></am-modal-body><am-modal-footer><am-modal-close class="am-e-button"> ${m.text("cancel")} </am-modal-close><am-submit class="am-e-button am-e-button--primary"> ${m.text("movePage")} </am-submit></am-modal-footer></am-form></am-modal-dialog></am-modal>`}${gi()} ${ft`<am-history-modal-form></am-history-modal-form>`}`}});customElements.define(Bt(n.resetpassword),class extends pi{get pageTitle(){return m.text("resetPassword")}renderMainPartial(){return ft`<am-reset-password-form am-api="UserController::resetPassword"></am-reset-password-form>`}});customElements.define(Bt(n.search),class extends mi{get pageTitle(){return m.text("searchTitle")}renderMainPartial(){return ft`<am-breadcrumbs-route am-target="${n.search}" am-text="${this.pageTitle}" am-narrow></am-breadcrumbs-route><section class="am-l-dashboard__section"><div class="am-l-dashboard__content am-l-dashboard__content--narrow"><am-search-form></am-search-form></div></section>`}});customElements.define(Bt(n.setup),class extends pi{get pageTitle(){return"Create User"}renderMainPartial(){return ft`<am-setup-form am-api="UserCollectionController::createFirstUser" am-focus am-enter></am-setup-form>`}});customElements.define(Bt(n.shared),class extends mi{get pageTitle(){return m.text("sharedTitle")}renderMainPartial(){return ft`<am-breadcrumbs-route am-target="${n.shared}" am-text="${this.pageTitle}"></am-breadcrumbs-route> ${ft`<section class="am-l-dashboard__section am-l-dashboard__section--sticky"><div class="am-l-dashboard__content am-l-dashboard__content--row"><am-switcher><div class="am-c-menu am-u-display-small-none"><am-switcher-link class="am-c-menu__item" am-section="settings"> ${m.text("fieldsSettings")} </am-switcher-link><am-switcher-link class="am-c-menu__item" am-section="text"> ${m.text("fieldsContent")} </am-switcher-link><am-switcher-link class="am-c-menu__item" am-section="colors"> ${m.text("fieldsColors")} </am-switcher-link><am-switcher-link class="am-c-menu__item" am-section="files"> ${m.text("uploadedFiles")} <span class="am-e-badge"><am-file-count></am-file-count></span></am-switcher-link></div><am-dropdown class="am-u-display-small am-e-button"><span class="am-c-icon-text"><am-switcher-label></am-switcher-label><span class="am-e-dropdown-arrow"></span></span><div class="am-c-dropdown__items"><am-switcher-link class="am-c-dropdown__link" am-section="settings"> ${m.text("fieldsSettings")} </am-switcher-link><am-switcher-link class="am-c-dropdown__link" am-section="text"> ${m.text("fieldsContent")} </am-switcher-link><am-switcher-link class="am-c-dropdown__link" am-section="colors"> ${m.text("fieldsColors")} </am-switcher-link><am-switcher-link class="am-c-dropdown__link" am-section="files"> ${m.text("uploadedFiles")} </am-switcher-link></div></am-dropdown></am-switcher><am-filter placeholder="filterContent"></am-filter></div></section>`} <section class="am-l-dashboard__section"><div class="am-l-dashboard__content"><am-shared-data-form am-api="SharedController::data"></am-shared-data-form><am-switcher-section name="files"><am-upload></am-upload><div class="am-u-flex am-u-flex--gap"><am-modal-toggle class="am-e-button am-e-button--primary" am-modal="#am-file-import-modal"> ${m.text("importFromUrl")} </am-modal-toggle><am-file-collection-submit class="am-e-button am-e-button--danger" am-form="FileCollectionController::list"> ${m.text("deleteSelected")} </am-file-collection-submit></div><am-file-collection-list-form am-confirm="${m.text("confirmDeleteSelectedFiles")}" am-api="FileCollectionController::list"></am-file-collection-list-form></am-switcher-section></div></section> ${gi()}`}});const fi=()=>ft`<div class="am-u-flex am-u-flex--column am-u-flex--gap-large"><am-form class="am-u-flex am-u-flex--column am-u-flex--gap-large" am-api="ConfigController::update" am-event="AutomadAppStateRequireUpdate" am-auto><input type="hidden" name="type" value="cache" /><div><p>${m.text("systemCacheInfo")}</p><am-cache-enable></am-cache-enable></div><div class="am-cache-settings"><p>${m.text("systemCacheMonitorInfo")}</p><am-cache-monitor></am-cache-monitor><p>${m.text("systemCacheLifetimeInfo")}</p><am-cache-lifetime></am-cache-lifetime></div></am-form><am-form class="am-cache-settings" am-api="CacheController::clear"><p>${m.text("systemCacheClearInfo")}</p><am-submit class="am-e-button am-e-button--primary"> ${m.text("systemCacheClear")} </am-submit></am-form><am-form class="am-cache-settings" am-api="CacheController::purge"><p>${m.text("systemCachePurgeInfo")}</p><am-submit class="am-e-button"> ${m.text("systemCachePurge")} </am-submit></am-form></div>`,xi=()=>ft`<am-form am-api="ConfigController::update" am-event="AutomadAppStateRequireUpdate" am-auto><input type="hidden" name="type" value="debug" /><div><p>${m.text("systemDebugInfo")}</p><am-debug-enable></am-debug-enable></div></am-form>`,yi=()=>ft`<am-form class="am-u-flex am-u-flex--column am-u-flex--gap-large" am-api="ConfigController::update" am-event="AutomadAppStateRequireUpdate" am-auto><input type="hidden" name="type" value="feed" /><div><p>${m.text("systemRssFeedInfo")}</p><am-feed-enable></am-feed-enable></div><div id="am-feed-settings"><p>${m.text("systemRssFeedUrl")}</p><div class="am-f-group"><input class="am-f-input am-u-flex__item-grow am-f-group__item" value="${m.feedURL}" disabled /><am-copy class="am-e-button am-e-button--icon am-f-group__item" value="${m.feedURL}" am-tooltip="${m.text("copyUrlClipboard")}"><i class="bi bi-clipboard"></i></am-copy></div><p>${m.text("systemRssFeedFields")}</p><am-feed-fields></am-feed-fields></div></am-form>`,wi=()=>ft`<am-form am-api="ConfigController::update" am-event="AutomadAppStateRequireUpdate" am-auto><input type="hidden" name="type" value="i18n" /><div><p>${m.text("systemI18nInfo")}</p><am-i18n-enable></am-i18n-enable></div></am-form>`,ki=()=>ft`<am-form am-api="ConfigController::update" am-event="AutomadAppStateRequireUpdate" am-auto><input type="hidden" name="type" value="translation" /><div><p>${m.text("systemLanguageInfo")}</p><am-language-select></am-language-select></div></am-form>`,_i=()=>ft`<am-system-update-form am-api="SystemController::update"></am-system-update-form>`,$i=()=>ft`<div class="am-u-flex am-u-flex--column am-u-flex--gap-large"><am-form am-api="UserController::edit" am-event="AutomadAppStateRequireUpdate" am-watch><am-form-error></am-form-error><span class="am-c-card"><span class="am-c-card__body am-c-card__body--large"> ${m.text("systemUsersInfo")} </span><span class="am-c-card__form am-u-flex am-u-flex--column am-u-flex--gap-large"><span class="am-u-flex am-u-flex--column am-u-flex--gap-large"><am-user-name></am-user-name><am-user-email></am-user-email></span><span class="am-c-card__form-buttons"><am-submit class="am-e-button"><span>${m.text("save")}</span></am-submit><am-modal-toggle class="am-e-button am-e-button--primary" am-modal="#am-change-password-modal"><span> ${m.text("systemUsersChangePassword")} </span></am-modal-toggle></span></span></span></am-form><span class="am-c-card"><span class="am-c-card__body am-c-card__body--large"> ${m.text("systemUsersRegisteredInfo")} </span><span class="am-c-card__form"><span class="am-c-card__form-buttons"><am-modal-toggle class="am-e-button" am-modal="#am-registered-users-modal"><span class="am-c-icon-text"><span class="am-u-flex am-u-flex--align-center am-u-flex--gap"><span> ${m.text("systemUsersRegistered")} </span><span class="am-e-badge"><am-user-count-indicator></am-user-count-indicator></span></span></span></am-modal-toggle></span><span class="am-c-card__form-buttons"><am-modal-toggle class="am-e-button" am-modal="#am-add-user-modal"> ${m.text("systemUsersAdd")} </am-modal-toggle><am-modal-toggle class="am-e-button" am-modal="#am-invite-user-modal"> ${m.text("systemUsersInvite")} </am-modal-toggle></span></span></span></div><!-- Modals --><am-modal id="am-change-password-modal"><am-form class="am-c-modal__dialog" am-api="UserController::changePassword"><am-modal-header> ${m.text("systemUsersChangePassword")} </am-modal-header><am-modal-body><am-form-error></am-form-error><div> ${Qe("am-password",null,{key:"currentPassword",value:"",name:"currentPassword",label:m.text("currentPassword")},[],{}).outerHTML} ${Qe("am-password",null,{key:"newPassword1",value:"",name:"newPassword1",label:m.text("newPassword")},[],{}).outerHTML} ${Qe("am-password",null,{key:"newPassword2",value:"",name:"newPassword2",label:m.text("repeatPassword")},[],{}).outerHTML} </div></am-modal-body><am-modal-footer><am-modal-close class="am-e-button"> ${m.text("close")} </am-modal-close><am-submit class="am-e-button am-e-button--primary"> ${m.text("save")} </am-submit></am-modal-footer></am-form></am-modal><am-modal id="am-registered-users-modal" nofocus><am-modal-dialog><am-modal-header> ${m.text("systemUsersRegistered")} </am-modal-header><am-modal-body><am-delete-users-form am-api="UserCollectionController::edit" am-event="AutomadAppStateRequireUpdate" am-watch></am-delete-users-form></am-modal-body><am-modal-footer><am-modal-close class="am-e-button"> ${m.text("close")} </am-modal-close><am-submit class="am-e-button am-e-button--danger" am-form="UserCollectionController::edit" disabled> ${m.text("deleteSelected")} </am-submit></am-modal-footer></am-modal-dialog></am-modal><am-modal id="am-add-user-modal"><am-form class="am-c-modal__dialog" am-api="UserCollectionController::createUser" am-event="AutomadAppStateRequireUpdate"><am-modal-header> ${m.text("systemUsersAdd")} </am-modal-header><am-modal-body><am-form-error></am-form-error><div> ${Qe("am-input",null,{key:"username",id:"am-field__create-username",value:"",name:"username",label:m.text("username")},[],{required:"",pattern:"^\\S+$","am-error":m.text("systemUsersNameError")}).outerHTML} ${Qe("am-email",null,{key:"email",id:"am-field__create-email",value:"",name:"email",label:m.text("email")},[],{required:"","am-error":m.text("emailRequiredError")}).outerHTML} ${Qe("am-password",null,{key:"password1",id:"am-field__create-password1",value:"",name:"password1",label:m.text("password")},[],{required:""}).outerHTML} ${Qe("am-password",null,{key:"password2",id:"am-field__create-password2",value:"",name:"password2",label:m.text("repeatPassword")},[],{required:""}).outerHTML} </div></am-modal-body><am-modal-footer><am-modal-close class="am-e-button"> ${m.text("close")} </am-modal-close><am-submit class="am-e-button am-e-button--primary"> ${m.text("systemUsersAdd")} </am-submit></am-modal-footer></am-form></am-modal><am-modal id="am-invite-user-modal"><am-form class="am-c-modal__dialog" am-api="UserCollectionController::inviteUser" am-event="AutomadAppStateRequireUpdate"><am-modal-header> ${m.text("systemUsersInvite")} </am-modal-header><am-modal-body><am-form-error></am-form-error><div> ${Qe("am-input",null,{key:"username",id:"am-field__invite-username",value:"",name:"username",label:m.text("username")},[],{required:"",pattern:"^\\S+$","am-error":m.text("systemUsersNameError")}).outerHTML} ${Qe("am-email",null,{key:"email",id:"am-field__invite-email",value:"",name:"email",label:m.text("email")},[],{required:"","am-error":m.text("emailRequiredError")}).outerHTML} </div></am-modal-body><am-modal-footer><am-modal-close class="am-e-button"> ${m.text("close")} </am-modal-close><am-submit class="am-e-button am-e-button--primary"> ${m.text("systemUsersSendInvitation")} </am-submit></am-modal-footer></am-form></am-modal>`,Ci=()=>`<p>${m.text("systemMailInfo")}</p><div class="am-u-flex am-u-flex--column am-u-flex--gap-large"><am-mail-config-form am-api="MailConfigController::save" am-event="AutomadAppStateRequireUpdate"></am-mail-config-form><am-form am-api=MailConfigController::test><am-submit class="am-e-button"> ${m.text("systemMailSendTest")} </am-submit></am-form></div>`;customElements.define(Bt(n.system),class extends mi{constructor(){super(...arguments),this.sectionData=null}get pageTitle(){return m.text("systemTitle")}get menuData(){const e=[];return this.sectionData.forEach((t=>{e.push({title:t.title,section:t.section})})),{overview:{icon:"grid",section:"overview"},items:e}}renderMainPartial(){const e=i("am-switcher-dropdown");return this.sectionData=[{section:"cache",icon:"device-ssd",title:m.text("systemCache"),info:m.text("systemCacheCardInfo"),state:"<am-system-cache-indicator></am-system-cache-indicator>",render:fi,narrowIcon:!0},{section:"users",icon:"person-badge",title:m.text("systemUsers"),info:m.text("systemUsersCardInfo"),state:ft`<span class="am-u-text-muted"> ${m.text("systemUsersRegistered")}: <am-user-count-indicator></am-user-count-indicator></span>`,render:$i,narrowIcon:!0},{section:"feed",icon:"rss",title:m.text("systemRssFeed"),info:m.text("systemRssFeedCardInfo"),state:"<am-system-feed-indicator></am-system-feed-indicator>",render:yi},{section:"mail",icon:"envelope-at",title:m.text("systemMail"),info:m.text("systemMailCardInfo"),state:"<am-system-mail-indicator></am-system-mail-indicator>",render:Ci,narrowIcon:!1},{section:"i18n",icon:"globe",title:m.text("systemI18n"),info:m.text("systemI18nCardInfo"),state:"<am-system-i18n-indicator></am-system-i18n-indicator>",render:wi},{section:"language",icon:"translate",title:m.text("systemLanguage"),info:m.text("systemLanguageCardInfo"),state:ft`<span class="am-u-text-muted"> ${Object.keys(m.languages).find((e=>m.languages[e]==m.system.translation))} </span>`,render:ki},{section:"debug",icon:"bug",title:m.text("systemDebug"),info:m.text("systemDebugCardInfo"),state:"<am-system-debug-indicator></am-system-debug-indicator>",render:xi},{section:"update",icon:"arrow-repeat",title:m.text("systemUpdate"),info:m.text("systemUpdateCardInfo"),state:"<am-system-update-indicator></am-system-update-indicator>",render:_i}],e.data=this.menuData,ft`<am-breadcrumbs-route am-target="${n.system}" am-text="${this.pageTitle}" am-narrow></am-breadcrumbs-route> ${e.outerHTML} <section class="am-l-dashboard__section"><div class="am-l-dashboard__content am-l-dashboard__content--narrow"> ${this.renderSections()}${this.renderOverviewSection()} </div></section>`}renderSections(){let e="";return this.sectionData.forEach((t=>{e+=ft`<am-switcher-section name="${t.section}"> ${t.render()} </am-switcher-section>`})),e}renderOverviewSection(){return ft`<am-switcher-section name="overview"><div class="am-l-grid" style="--min: 17rem;"> ${this.renderOverviewCards(this.sectionData.slice(0,2))} </div><div class="am-l-grid" style="--min: 13rem;"> ${this.renderOverviewCards(this.sectionData.slice(2,8))} </div></am-switcher-section>`}renderOverviewCards(e){let t="";return e.forEach((e=>{t+=ft`<am-switcher-link class="am-c-card am-c-card--hover" am-section="${e.section}"><div class="am-u-flex__item-grow"><span class="am-c-card__icon am-u-display-small-none ${e.narrowIcon?"am-c-card__icon--narrow":""}"><i class="bi bi-${e.icon}"></i></span><div class="am-c-card__title">${e.title}</div><div class="am-c-card__body">${e.info}</div></div> ${e.state?`<div class="am-c-card__state">${e.state}</div>`:""} </am-switcher-link>`})),t}});customElements.define(Bt(n.trash),class extends mi{get pageTitle(){return m.text("trashTitle")}renderMainPartial(){return ft`<am-breadcrumbs-route am-target="${n.trash}" am-text="${this.pageTitle}" am-narrow></am-breadcrumbs-route><section class="am-l-dashboard__section am-l-dashboard__section--sticky"><div class="am-l-dashboard__content am-l-dashboard__content--narrow am-l-dashboard__content--row am-u-flex--gap"><am-filter placeholder="trashFilter"></am-filter><am-form am-api="PageTrashController::clear" am-confirm="${m.text("trashClearConfirm")}"><am-submit class="am-e-button am-e-button--danger"> ${m.text("trashClear")} </am-submit></am-form></div></section><section class="am-l-dashboard__section"><div class="am-l-dashboard__content am-l-dashboard__content--narrow"><am-trash-form></am-trash-form></div></section>`}});class Ti extends x{static toggle(e){const t=null!=e?e:!Ti.open;document.body.classList.toggle("am-body-sidebar-open",t),document.body.classList.toggle("am-u-overflow-hidden",t),Ti.open=t}connectedCallback(){this.setHeight(),setTimeout(this.setHeight.bind(this),0),this.addListener(v(window,"resize",o(this.setHeight.bind(this),200)))}setHeight(){this.style.setProperty("height",`${window.innerHeight}px`)}}Ti.open=!1,customElements.define("am-sidebar",Ti);customElements.define("am-sidebar-toggle",class extends x{connectedCallback(){this.addListener(v(this,"click",(()=>{Ti.toggle()})))}});class Ai extends x{static get observedAttributes(){return["am-section"]}connectedCallback(){this.addListener(v(window,"AutomadSwitcherChange",this.toggle.bind(this))),this.addListener(v(this,"click",this.select.bind(this)))}toggle(){this.classList.toggle("am-active",this.elementAttributes["am-section"]==Li())}select(){m.navigationIsLocked||Ei(this.elementAttributes["am-section"])}}Ai.TAG_NAME="am-switcher-link",customElements.define(Ai.TAG_NAME,Ai);const Li=()=>Vt("section"),Ei=e=>{Kt("section",e),b("AutomadSwitcherChange")};customElements.define("am-switcher",class extends x{connectedCallback(){setTimeout((()=>{this.onChange(),window.dispatchEvent(new Event("AutomadSwitcherChange"))}),0),this.addListener(v(window,"AutomadSwitcherChange",this.onChange.bind(this)))}onChange(){let e=Li();const t=[];r(Ai.TAG_NAME,this).forEach((e=>{t.push(e.getAttribute("am-section"))})),-1==t.indexOf(e)&&Ei(t[0]),l("html").scrollTop=0,Dt.new()}});customElements.define("am-switcher-dropdown",class extends x{set data(e){this.init(e)}connectedCallback(){this.classList.add("am-l-dashboard__section","am-l-dashboard__section--sticky");const e=()=>{this.classList.toggle("am-u-display-none","overview"==Li())};this.addListener(v(window,"AutomadSwitcherChange",e.bind(this))),e()}init(e){const t=i("div",["am-l-dashboard__content","am-l-dashboard__content--row","am-l-dashboard__content--narrow"],{},this),a=i("am-switcher",["am-f-group","am-u-flex__item-grow"],{},t);i("am-switcher-link",["am-f-group__item","am-e-button","am-e-button--icon"],{"am-section":e.overview.section},a).innerHTML=`<i class="bi bi-${e.overview.icon}"></i>`;const s=i("am-dropdown",["am-u-flex__item-grow","am-u-flex"],{},a);i("am-switcher-label",["am-f-group__item","am-u-flex__item-grow","am-f-group__item","am-f-select"],{},s);const n=i("div",["am-c-dropdown__items"],{},s);e.items.forEach((e=>{n.innerHTML+=ft`<am-switcher-link class="am-c-dropdown__link" am-section="${e.section}"> ${e.title} </am-switcher-link>`}))}});customElements.define("am-switcher-label",class extends x{connectedCallback(){const e=()=>`${Ai.TAG_NAME}[am-section="${Li()}"]`;this.addListener(v(window,"AutomadSwitcherChange",(()=>{this.innerHTML=(l(`.am-c-dropdown__items ${e()}`)||l(`.am-c-menu ${e()}`)||l(e())).innerHTML})))}});customElements.define("am-switcher-section",class extends x{static get observedAttributes(){return["name"]}connectedCallback(){this.classList.add("am-c-switcher-section"),this.toggle(),this.addListener(v(window,"AutomadSwitcherChange",this.toggle.bind(this)))}toggle(){this.classList.toggle("am-c-switcher-section--active",this.elementAttributes.name==Li()),l("html").scrollTop=0}});customElements.define("am-cache-enable",class extends x{connectedCallback(){const e=new u("cacheEnabled",{initial:m.system.cache.enabled});this.addListener(v(window,"AutomadAppStateChange",(()=>{e.value=m.system.cache.enabled}))),Qe("am-toggle-large",this,{key:"cacheEnabled",value:m.system.cache.enabled,name:"cacheEnabled",label:m.text("systemCacheEnable")},[],{"am-toggle":".am-cache-settings","am-bind":"cacheEnabled","am-bind-to":"checked"})}});customElements.define("am-cache-lifetime",class extends x{connectedCallback(){const e=new u("cacheLifetime",{initial:m.system.cache.lifetime});this.addListener(v(window,"AutomadAppStateChange",(()=>{e.value=m.system.cache.lifetime}))),nt([{value:3600,text:"1 h"},{value:21600,text:"6 h"},{value:43200,text:"12 h"},{value:86400,text:"24 h"}],`${m.system.cache.lifetime}`,this,"cacheLifetime","",m.text("systemCacheLifetime"),["am-f-select--inline"],{"am-bind":"cacheLifetime","am-bind-to":"value"})}});customElements.define("am-cache-monitor",class extends x{connectedCallback(){const e=new u("cacheMonitorDelay",{initial:m.system.cache.monitorDelay});this.addListener(v(window,"AutomadAppStateChange",(()=>{e.value=m.system.cache.monitorDelay}))),nt([{value:60,text:"1 min"},{value:120,text:"2 min"},{value:300,text:"5 min"},{value:600,text:"10 min"}],`${m.system.cache.monitorDelay}`,this,"cacheMonitorDelay","",m.text("systemCacheMonitor"),["am-f-select--inline"],{"am-bind":"cacheMonitorDelay","am-bind-to":"value"})}});customElements.define("am-debug-enable",class extends x{connectedCallback(){const e=new u("debugEnabled",{initial:m.system.debug});this.addListener(v(window,"AutomadAppStateChange",(()=>{e.value=m.system.debug}))),Qe("am-toggle-large",this,{key:"debugEnabled",value:m.system.debug,name:"debugEnabled",label:m.text("systemDebugEnable")},[],{"am-bind":"debugEnabled","am-bind-to":"checked"})}});customElements.define("am-feed-enable",class extends x{connectedCallback(){const e=new u("feedEnabled",{initial:m.system.feed.enabled});this.addListener(v(window,"AutomadAppStateChange",(()=>{e.value=m.system.feed.enabled}))),Qe("am-toggle-large",this,{key:"feedEnabled",value:m.system.feed.enabled,name:"feedEnabled",label:m.text("systemRssFeedEnable")},[],{"am-bind":"feedEnabled","am-bind-to":"checked","am-toggle":"#am-feed-settings"})}});customElements.define("am-feed-fields",class extends x{connectedCallback(){const e=new u("feedFields",{initial:JSON.stringify(m.system.feed.fields)});this.addListener(v(window,"AutomadAppStateChange",(()=>{e.value=JSON.stringify(m.system.feed.fields)}))),Qe("am-feed-field-select",this,{key:"feedFields",value:JSON.stringify(m.system.feed.fields),name:"feedFields"},[],{"am-bind":"feedFields","am-bind-to":"value"})}});customElements.define("am-i18n-enable",class extends x{connectedCallback(){const e=new u("i18nEnabled",{initial:m.system.i18n});this.addListener(v(window,"AutomadAppStateChange",(()=>{e.value=m.system.i18n}))),Qe("am-toggle-large",this,{key:"i18nEnabled",value:m.system.i18n,name:"i18nEnabled",label:m.text("systemI18nEnable")},[],{"am-bind":"i18nEnabled","am-bind-to":"checked"})}});customElements.define("am-language-select",class extends x{connectedCallback(){const e=[];for(const[t,a]of Object.entries(m.languages))e.push({text:t,value:a});nt(e,m.system.translation,this,"translation","","",["am-f-select--inline"])}});customElements.define("am-user-email",class extends x{connectedCallback(){Qe("am-email",this,{key:"email",value:m.user.email,name:"email",label:m.text("email")},[],{"am-error":m.text("emailRequiredError"),required:""})}});customElements.define("am-user-name",class extends x{connectedCallback(){Qe("am-input",this,{key:"username",value:m.user.name,name:"username",label:m.text("username")},[],{pattern:"^\\S+$",required:"","am-error":m.text("systemUsersNameError")})}});customElements.define("am-alert",class extends x{static get observedAttributes(){return["am-icon","am-text"]}connectedCallback(){const e=this.elementAttributes["am-icon"],t=this.elementAttributes["am-text"];this.classList.add("am-c-alert"),this.innerHTML=ft`<div class="am-c-alert__icon"><i class="bi bi-${e||"fire"}"></i></div><div class="am-c-alert__text">${m.text(t)||t}</div>`}});customElements.define("am-autocomplete-url",class extends ai{get data(){return(()=>{const e=[],t=Object.values(m.pages);return t.sort(((e,t)=>e.lastModified<t.lastModified?1:t.lastModified<e.lastModified?-1:0)),t.forEach((t=>{e.push({value:t.url,title:t.title})})),e})()}createItemElement(e){return i("a",[this.linkClass],{},null,ft`<am-icon-text am-icon="link" am-text="$${e.title}"></am-icon-text>`)}});customElements.define("am-checkbox",class extends x{connectedCallback(){this.render(),this.removeAttribute("name"),this.removeAttribute("checkbox");const e=()=>{this.closest(".am-c-card").classList.toggle("am-c-card--active",l("input",this).checked)};v(this,"input",e,"input"),e()}render(){this.classList.add("am-f-checkbox"),i("label",[],{},this,ft`<input type="checkbox" name="${this.getAttribute("name")}" ${this.hasAttribute("checked")?"checked":""} ${this.hasAttribute("value")?`value="${this.getAttribute("value")}"`:""} /><i class="bi"></i>`),this.removeAttribute("checked"),this.removeAttribute("name"),this.removeAttribute("value")}});customElements.define("am-custom-icon-checkbox",class extends x{get checked(){return l("input",this).checked}connectedCallback(){this.classList.add("am-f-custom-icon-checkbox"),i("label",[],{},this,ft`<input type="checkbox" name="${this.getAttribute("name")}" value="1" ${this.hasAttribute("checked")?"checked":""} /><span><i class="bi bi-${this.getAttribute("am-icon")}"></i></span>`),this.removeAttribute("am-icon"),this.removeAttribute("name"),this.removeAttribute("checked")}});var Si,Pi=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-copy",class extends x{static get observedAttributes(){return["value"]}connectedCallback(){v(this,"click",(()=>Pi(this,void 0,void 0,(function*(){yield navigator.clipboard.writeText(this.elementAttributes.value),At(this.elementAttributes.value)}))))}}),function(e){e.light="light",e.lowContrast="low-contrast",e.dark="dark"}(Si||(Si={}));const Ii=()=>{const e=localStorage.getItem("dashboard-theme");return e||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Si.dark:void 0)},Mi=e=>{const t=l(".am-ui");Object.values(Si).forEach((a=>{t.classList.toggle(a,e===a)}))};customElements.define("am-dashboard-theme-toggle",class extends x{constructor(){super(...arguments),this.renderThemeToggle=(e,t)=>{const a=["am-c-dashboard-theme-toggle__button"];e==Ii()&&a.push("am-c-dashboard-theme-toggle__button--active");const s=`${sa(e.replace("-"," "))} Theme`,n=i("span",a,{"am-tooltip":s},this);n.innerHTML=`<i class="bi bi-${t}"></i>`,v(n,"click",(()=>{setTimeout((()=>{(e=>{localStorage.setItem("dashboard-theme",e),Mi(e),b("AutomadDashboardThemeChange")})(e),this.render()}),400)}))}}connectedCallback(){this.classList.add("am-c-dashboard-theme-toggle"),this.render(),this.addListener(v(window,"AutomadDashboardThemeChange",this.render.bind(this)))}render(){document.documentElement.classList.add("am-u-no-transition"),this.innerHTML="",this.renderThemeToggle(Si.light,"sun-fill"),this.renderThemeToggle(Si.dark,"moon-stars"),this.renderThemeToggle(Si.lowContrast,"shadows"),setTimeout((()=>{document.documentElement.classList.remove("am-u-no-transition")}),800)}});class Ri extends x{connectedCallback(){this.classList.add("am-c-dropdown"),this.classList.toggle("am-c-dropdown--right",this.hasAttribute("am-right")),this.addListener(v(window,"click",(e=>{e.target===this||c(Ri.TAG_NAME,e.target).includes(this)?this.classList.toggle("am-c-dropdown--open"):this.classList.remove("am-c-dropdown--open")})))}}Ri.TAG_NAME="am-dropdown",customElements.define(Ri.TAG_NAME,Ri);customElements.define("am-filter",class extends x{static get observedAttributes(){return["placeholder"]}get targetSelector(){return"section [am-api] .am-c-field:not(am-title), .am-c-card"}connectedCallback(){const e=this.render();this.classList.add("am-c-filter"),v(e,"input",o((()=>{this.filter(e)}),200)),this.addListener(v(window,"AutomadSwitcherChange",(()=>{e.value="",this.filter(e)}))),this.addListener(aa("k",(()=>{e.focus()}))),v(e,"keydown",(t=>{27==t.keyCode&&e.blur()}))}filter(e){const t=e.value.toLowerCase().split(" ");r(this.targetSelector).forEach((e=>{for(var a=!1,i=0;i<t.length;i++)if(-1==e.textContent.toLowerCase().indexOf(t[i])){a=!0;break}e.classList.toggle("am-u-display-none",a)}))}render(){const e=m.text(this.elementAttributes.placeholder),t=i("input",["am-c-filter__input","am-f-input"],{placeholder:e},this),a=i("span",["am-c-filter__key-combo"],{},this);return i("am-key-combo-badge",[],{"am-key":"K"},a),t}});customElements.define("am-icon-text",class extends x{connectedCallback(){const e=this.getAttribute("am-icon"),t=this.getAttribute("am-text");this.removeAttribute("am-icon"),this.removeAttribute("am-text"),e&&t&&(this.classList.add("am-c-icon-text"),i("i",["bi",`bi-${e}`],{},this),i("span",[],{},this).textContent=t)}});var Hi=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-image-picker",class extends x{constructor(){super(...arguments),this.binding=null}static get observedAttributes(){return["am-page","am-label","am-binding-name"]}connectedCallback(){this.binding=p.get(this.elementAttributes["am-binding-name"]),this.init()}init(){return Hi(this,void 0,void 0,(function*(){this.classList.add("am-c-field"),this.elementAttributes["am-label"]&&(i("label",["am-c-field__label"],{},this).textContent=this.elementAttributes["am-label"]);const e=i("div",[],{},this,"<am-spinner></am-spinner>"),{data:t}=yield Pt("ImageCollectionController::list",{url:this.elementAttributes["am-page"]||""});e.innerHTML="";const{images:a}=t;a.length?this.renderGrid(a,e):e.innerHTML=ft`<am-icon-text am-icon="folder-x" am-text="${m.text("noImagesFound")}"></am-icon-text>`}))}renderGrid(e,t){const a=i("div",["am-c-image-picker"],{},t),s=this.elementAttributes["am-page"]?"":"/shared/",n=this.closest("am-modal")||null;e.forEach((e=>{const t=i("img",["am-c-image-picker__image"],{src:e.thumbnail,value:`${s}${e.name}`,"am-tooltip":e.name},a);v(t,"click",(()=>{this.binding.value=t.getAttribute("value"),n&&n.close()}))}))}});customElements.define("am-key-combo-badge",class extends x{static get observedAttributes(){return["am-key"]}connectedCallback(){this.classList.add("am-e-key-combo");const e=ta();this.textContent=`${e} + ${this.elementAttributes["am-key"]}`,this.removeAttribute("am-key")}});customElements.define("am-link",class extends x{static get observedAttributes(){return["am-target","am-external"]}connectedCallback(){v(this,"click",(e=>{if(this.elementAttributes["am-external"]&&(window.location.href=this.elementAttributes["am-external"]),m.navigationIsLocked)return;const t=`${window.location.origin}${m.dashboardURL}/`,a=new URL(this.elementAttributes["am-target"],t);e.stopImmediatePropagation(),m.root.setView(a)}))}});customElements.define("am-logo",class extends x{connectedCallback(){this.innerHTML='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="994px" height="1170px" viewBox="0 0 994 1170" style="enable-background:new 0 0 994 1170" preserveAspectRatio="xMinYMin meet" xml:space="preserve" fill="currentColor"> <path d="M626.1,345.8L60.7,567.5l-57.4-143L269.6,4.7H724l266.7,419.8l-78.5,195.4L626.1,345.8z M876.2,452.9l7.4-18.5\n\t\tl-96.4-151.8l-62.9,24.7L876.2,452.9z M114.1,443.7l620.8-243.4l-63.4-99.9H322.2L110.4,434.4L114.1,443.7z"/> <path d="M300.7,1165.3l-48.3-120.2l-224.6,62.6l-25.7-92.2l307.2-85.6l56.1,139.7h262.8l56.2-139.7l307.4,85.6\n\t\tl-25.7,92.2l-224.9-62.6l-48.3,120.2H300.7z"/> </svg> '}});class Bi extends x{static get observedAttributes(){return["am-page","am-icon","am-text","am-badge"]}connectedCallback(){this.classList.add("am-c-nav__item"),this.classList.toggle("am-c-nav__item--active",(e=>{const t=new RegExp(`/${e}$`,"i");return null!=window.location.pathname.match(t)})(this.elementAttributes["am-page"])),this.innerHTML=this.render(),Bi.observedAttributes.forEach((e=>{this.removeAttribute(e)}))}render(){const e=this.elementAttributes["am-badge"],t=this.elementAttributes["am-icon"],a=this.elementAttributes["am-page"],i=this.elementAttributes["am-text"];return ft`<am-link am-target="${a}" class="am-c-nav__link"><span class="am-c-icon-text"><i class="bi bi-${t}"></i><span>${m.text(i)}</span> ${e?`<${e}></${e}>`:""} </span></am-link>`}}customElements.define("am-nav-item",Bi);var Oi=a(616),Fi=a.n(Oi);const Ni=e=>{const t=Ui(e),a=(e,i)=>{const s=t[e.url]||[],n=[],o=e;return s.sort(((e,t)=>e.index>t.index?1:t.index>e.index?-1:0)),s.forEach((e=>{a(e,n)})),i.push({data:o,nodes:n}),i};return a(m.pages["/"],[])},Ui=e=>{const t={};return e.forEach((e=>{const a=e.parentUrl;a&&(void 0===t[a]&&(t[a]=[]),t[a].push(e))})),t},Di={tree:"am-c-tree",node:"am-c-tree__node",nodeHover:"am-c-tree__node--hover",nodeDragging:"am-c-tree__node--dragging",nodeDropBefore:"am-c-tree__node--drop-before",nodeDropInside:"am-c-tree__node--drop-inside",nodeDropAfter:"am-c-tree__node--drop-after",label:"am-c-tree__label",subnodes:"am-c-tree__subnodes",collapse:"am-c-tree__collapse"};var ji=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};const qi=e=>{e.error&&Tt(e.error),e.reload&&m.reload(),e.redirect&&m.root.setView(e.redirect)},zi=e=>{const t=e.url==Gt()?"am-c-nav__item--active":"",a=m.system.i18n&&"/"===e.url?"globe":m.system.i18n&&"/"===e.parentUrl?"translate":e.private?"eye-slash-fill":"file-earmark-text",i=t?'am-bind="title" am-bind-to="textContent"':"",s=t?'am-bind="publicationState" am-bind-to="am-publication-state"':"";return ft`<span class="am-c-nav__item ${t}" title="${e.url}" am-publication-state="${e.publicationState}" ${s}><am-link class="am-c-nav__link" am-target="${n.page}?url=${encodeURIComponent(e.url)}"><i class="bi bi-${a}"></i><span> ${m.system.i18n&&"/"===e.parentUrl?`${e.url.replace("/","")} &mdash; `:""}<span ${i}>$${e.title}</span></span></am-link></span>`},Gi=e=>ji(void 0,void 0,void 0,(function*(){const{movedNode:t,targetParentNode:a,srcParentNode:i}=e,s=a.data,n=i.data,o=t.data.url,c=[],d=r("sortable-tree-node",l(Ji.TAG_NAME)),u=e=>{d.forEach((t=>{t.setAttribute("draggable",e)}))};if(u("false"),a.subnodesData.forEach((e=>{c.push(e.path)})),s.path!=n.path){const e=m.addNavigationLock(),t=s.url,a=yield Pt("PageController::move",{url:o,targetPage:t,layout:JSON.stringify(c)});return u("true"),m.removeNavigationLock(e),void qi(a)}const h=m.addNavigationLock(),p=s.path,g=yield Pt("PageController::updateIndex",{url:o,parentPath:p,layout:JSON.stringify(c)});u("true"),m.removeNavigationLock(h),qi(g)})),Vi=()=>ji(void 0,void 0,void 0,(function*(){return!m.navigationIsLocked})),Wi=o((e=>{e.target.closest("sortable-tree-node").collapse(!1)}),1200);class Ji extends x{connectedCallback(){this.addListener(v(window,"AutomadAppStateChange",this.init.bind(this))),this.init(),v(this,"dragenter",Wi,"sortable-tree-node")}init(){this.classList.add("am-c-nav"),this.innerHTML="";const e=Object.values(m.pages);i("span",["am-c-nav__label"],{},this,ft`<span class="am-u-flex am-u-flex--gap am-u-flex--align-center"> ${m.text("sidebarPages")} &mdash; ${e.length} </span>`);const t=Gt(),a=Ni(e);if(this.tree=new(Fi())({nodes:a,element:this,initCollapseLevel:1,styles:Di,stateId:"nav",renderLabel:zi,onChange:Gi,confirm:Vi}),t){const e=this.tree.findNode("url",t);null==e||e.reveal(),null==e||e.scrollIntoView({block:"end"})}p.connectElements(this)}disconnectedCallback(){super.disconnectedCallback(),this.tree.destroy()}}Ji.TAG_NAME="am-nav-tree",customElements.define(Ji.TAG_NAME,Ji);class Zi extends x{connectedCallback(){this.value=this.getAttribute("value"),this.removeAttribute("value"),this.render(this.value)}render(e){var t;this.classList.add("am-f-group","am-f-number-unit");const a=null!==(t=null==e?void 0:e.replace(/([^\d\.]+)/g,""))&&void 0!==t?t:"",s=(null==e?void 0:e.replace(/.+?(px|em|rem|%|vh|vw)/g,"$1"))||"px",n=i("input",["am-f-input","am-f-group__item"],{type:"number",step:"1",value:a},this),o=nt([{value:"px"},{value:"%"},{value:"rem"},{value:"em"},{value:"vh"},{value:"vw"}],s,this,null,null,"",["am-f-group__item"]);v(this,"change",(e=>{e.stopPropagation(),this.value=n.value.length>0?n.value+o.value:"",b("change",this)}),"input, select")}}Zi.TAG_NAME="am-number-unit-input",lt.add(Zi.TAG_NAME),customElements.define("am-number-unit-input",Zi);const Ki=e=>{const t=e.private?"eye-slash-fill":"folder2";return ft`<label class="am-c-nav__item"><input type="radio" name="targetPage" value="${e.url}" tabindex="0" /><span class="am-c-nav__link"><am-icon-text am-icon="${t}" am-text="$${e.title}"></am-icon-text></span></label>`};customElements.define("am-page-select-tree",class extends x{get hideCurrent(){return this.hasAttribute("am-hide-current")}connectedCallback(){this.addListener(v(window,"AutomadAppStateChange",this.init.bind(this))),this.init()}init(){this.innerHTML="";const e=this.filterPages(Object.values(m.pages)),t=Ni(e),a=new(Fi())({nodes:t,element:this,initCollapseLevel:1,disableSorting:!0,styles:Di,renderLabel:Ki}),i=a.findNode("url",Gt())||a.findNode("url","/");i.reveal();const s=this.closest(y.TAG_NAME);s&&v(s,"AutomadModalOpen",(()=>{l("input",i.label).checked=!0}))}filterPages(e){if(this.hideCurrent){const t=Gt(),a=new RegExp(`^${t}(/|$)`);return e.filter((e=>null==e.url.match(a)))}return e}});var Yi=function(e,t,a,i){return new(a||(a=Promise))((function(s,n){function o(e){try{r(i.next(e))}catch(e){n(e)}}function l(e){try{r(i.throw(e))}catch(e){n(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}r((i=i.apply(e,t||[])).next())}))};customElements.define("am-root",class extends x{static get observedAttributes(){return["base-index","base-url"]}connectedCallback(){this.init()}setView(e){Ti.toggle(!1),window.history.pushState(null,null,e),this.update()}init(){return Yi(this,void 0,void 0,(function*(){this.classList.add("am-c-root"),this.addListener((()=>{const e=["InvalidStateError","TypeError"];return v(window,"error",(t=>{e.includes(t.error.name)&&(yt().log(t.error),t.preventDefault())}))})()),Mi(Ii()),this.progressBar(10),yield m.bootstrap(this),yield this.update(),this.addListener(v(window,"popstate",(()=>{m.root.update()}))),this.addListener(v(document,"keydown",(e=>{13==e.keyCode&&document.activeElement.click()}))),this.addListener(v(document,"change",(e=>{e.target.classList.add("am-validate")}),"input, textarea, [contenteditable]")),this.validateSession(),Dt.addListeners()}))}update(){return Yi(this,void 0,void 0,(function*(){b("AutomadBeforeUpdateView",window);const e=r("[am-modal-open]");e&&(e.forEach((e=>{e.close()})),yield new Promise((e=>setTimeout(e,250)))),this.progressBar(20),m.isReady=!1,Ut(),p.reset(),Dt.new(),yield m.updateState(),this.progressBar(40);const t=Ht();if(!t)return;const a=i(Bt(t),[],{}).init();this.progressBar(60),yield It(),this.progressBar(80),this.innerHTML="",this.appendChild(a),yield It(),p.connectElements(this),r("input[am-toggle]",this).forEach((e=>{const t=r(e.getAttribute("am-toggle")),a=()=>{t.forEach((t=>{t.classList.toggle("am-u-display-none",!e.checked)}))};v(e,"change AutomadChangeByBinding",a),a()})),m.checkForSystemUpdate(),m.checkForOutdatedPackages(),m.restoreFilterAndScroll(),this.progressBar(100),m.isReady=!0}))}validateSession(){return Yi(this,void 0,void 0,(function*(){const e=()=>Yi(this,void 0,void 0,(function*(){if("visible"===document.visibilityState){const e=yield Pt("SessionController::validate",{csrfTokenValidation:1});403===(e.code||403)&&m.reload(),e.redirect&&this.setView(e.redirect)}}));this.addListener(v(document,"visibilitychange",e.bind(this))),this.addListener(v(window,"focus",e.bind(this)))}))}progressBar(e){this.classList.toggle("am-c-root--loading",e>0&&e<100),e>0?this.style.setProperty("--progress",`${e}%`):setTimeout((()=>{this.style.setProperty("--progress",`${e}%`)}),0)}});customElements.define("am-spinner",class extends x{connectedCallback(){this.classList.add("am-c-spinner")}});customElements.define("am-undo-buttons",class extends x{connectedCallback(){this.classList.add("am-u-flex"),this.render(),this.addListener(v(window,"AutomadUndoStackUpdate",this.render.bind(this)))}render(){this.innerHTML="";const e=ta(),t=i("span",["am-c-navbar__item","am-c-navbar__item--glyph"],{"am-tooltip":`${e} + Z`},this,"↩"),a=i("span",["am-c-navbar__item","am-c-navbar__item--glyph"],{"am-tooltip":`${e} + Y`},this,"↪"),{undo:s,redo:n}=Dt.size;0==s&&t.classList.add("am-u-text-muted"),0==n&&a.classList.add("am-u-text-muted"),v(t,"click",Dt.undoHandler),v(a,"click",Dt.redoHandler)}})}},a={};function i(e){var s=a[e];if(void 0!==s)return s.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=t,e=[],i.O=(t,a,s,n)=>{if(!a){var o=1/0;for(d=0;d<e.length;d++){for(var[a,s,n]=e[d],l=!0,r=0;r<a.length;r++)(!1&n||o>=n)&&Object.keys(i.O).every((e=>i.O[e](a[r])))?a.splice(r--,1):(l=!1,n<o&&(o=n));if(l){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[a,s,n]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={179:0};i.O.j=t=>0===e[t];var t=(t,a)=>{var s,n,[o,l,r]=a,c=0;if(o.some((t=>0!==e[t]))){for(s in l)i.o(l,s)&&(i.m[s]=l[s]);if(r)var d=r(i)}for(t&&t(a);c<o.length;c++)n=o[c],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(d)},a=self.webpackChunkautomad=self.webpackChunkautomad||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),i.nc=void 0;var s=i.O(void 0,[459,777,703,736],(()=>i(4361)));s=i.O(s)})();
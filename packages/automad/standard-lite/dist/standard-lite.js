/* Standard Lite, (c) 2025 Marc Anton Dahmen, MIT license */
var m=(i,e=[],t={},a=null,s=null,r=!1)=>{let n=document.createElement(i);e.forEach(l=>{n.classList.add(l)});for(let[l,o]of Object.entries(t))n.setAttribute(l,o);return a&&(r?a.prepend(n):a.appendChild(n)),s&&(n.innerHTML=s),n},p=(i,e=200)=>{let t;return(...a)=>{clearTimeout(t),t=setTimeout(()=>{i.apply(void 0,a)},e)}},f=i=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",i):i()},y=async(i,e,t,a=()=>{})=>{let s="std-loading";e.classList.add(s);try{let n=await(await fetch(i)).text(),c=new DOMParser().parseFromString(n,"text/html").querySelector(t);e.innerHTML=c.innerHTML,a(),history.pushState(null,"",i)}catch{}e.classList.remove(s)};var b=class{static isOpen=!1};var g=class i extends HTMLElement{static SIDEBAR_ID="std-sidebar";static EVENTS={open:"std.sidebar.open",close:"std.sidebar.close"};static CLS={htmlOpen:"std-has-open-sidebar"};sidebar;constructor(){super()}connectedCallback(){f(()=>{this.sidebar=document.getElementById(i.SIDEBAR_ID),this.sidebar&&(this.setAttribute("aria-expanded","false"),this.setAttribute("aria-controls",i.SIDEBAR_ID),window.addEventListener(i.EVENTS.open,()=>{this.setAttribute("aria-expanded","true")}),window.addEventListener(i.EVENTS.close,()=>{this.setAttribute("aria-expanded","false")}),this.init())})}toggle(e=null){e===null&&(e=!b.isOpen),this.setAttribute("aria-expanded",String(e)),this.sidebar.setAttribute("aria-hidden",String(!e)),document.documentElement.classList.toggle(i.CLS.htmlOpen,e),b.isOpen=e,window.dispatchEvent(new Event(e?i.EVENTS.open:i.EVENTS.close))}open(){this.toggle(!0)}close(){this.toggle(!1)}};var _=class extends g{init(){this.addEventListener("click",this.close.bind(this))}};customElements.define("std-sidebar-backdrop",_);var k=class extends g{init(){let e=()=>{this.toggle(),document.documentElement.style.setProperty("--std-offcanvas-offset-top",`${this.getBoundingClientRect().top}px`)};this.setAttribute("role","button"),this.setAttribute("tabindex","0"),this.setAttribute("aria-label","Open sidebar"),this.addEventListener("click",e),this.addEventListener("keydown",t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e())}),window.addEventListener(g.EVENTS.open,()=>{this.innerHTML='<span class="std-icon-x"></span>'}),window.addEventListener(g.EVENTS.close,()=>{this.innerHTML='<span class="std-icon-menu"></span>'}),window.addEventListener("keydown",t=>{b.isOpen&&t.key=="Escape"&&this.toggle(!1)})}};customElements.define("std-sidebar-toggle",k);var D=i=>new Promise((e,t)=>{let a=new Image;a.src=i,a.onload=()=>{let s=document.createElement("canvas"),r=s.getContext("2d"),n=a.naturalWidth,l=a.naturalHeight;s.width=n,s.height=l,r.drawImage(a,0,0);let o=Math.floor(l*4/5),c=l-o,h=r.getImageData(0,o,n,c).data,P=h.length/4,F=0;for(let v=0;v<h.length;v+=4){let O=h[v],Y=h[v+1],K=h[v+2],J=.299*O+.587*Y+.114*K;F+=J}let q=F/P;e(q>128?"std-has-img-light":"std-has-img-dark")},a.onerror=t});var E=class extends HTMLElement{constructor(){super()}async connectedCallback(){let e=this.getAttribute("preload"),t=await D(e);this.dispatchEvent(new Event("load")),this.parentElement.classList.add(t);let a=m("img",[],{src:this.getAttribute("image"),width:this.getAttribute("width"),height:this.getAttribute("height"),loading:"lazy",alt:this.getAttribute("image").split("/").reverse()[0]},this),s=()=>{this.classList.add("loaded"),this.replaceWith(a)};this.style.backgroundImage=`url(${e})`,a.complete?s():a.addEventListener("load",s)}};customElements.define("std-img-loader",E);var L=class extends HTMLElement{constructor(){super()}connectedCallback(){window.addEventListener("keydown",e=>{if(e.key=="Escape"){e.preventDefault();let t=new URL(window.location.href);t.search="",window.location.href=t.toString()}})}};customElements.define("std-layout-tag-esc",L);var W={tag:"std-tag",loading:"std-loading"},H="std-layout-tag-pagelist",z=class extends HTMLElement{constructor(){super()}connectedCallback(){f(this.init.bind(this))}init(){Array.from(this.querySelectorAll(`.${W.tag}`)).forEach(t=>{t.addEventListener("click",a=>{a.preventDefault(),y(t.href,this,H,this.init.bind(this))})})}};customElements.define(H,z);var N={item:"std-pagelist__item"},A=class extends HTMLElement{constructor(){super()}connectedCallback(){setTimeout(()=>{let e=Array.from(this.children);if(!e)return;let t=p(this.layout.bind(this,e),10);this.addEventListener("load",t,!0),window.addEventListener("resize",t),window.addEventListener("orientationchange",t),t()},0)}layout(e){this.style.removeProperty("grid-auto-rows");let t=this.querySelector(`.${N.item}`).getBoundingClientRect().width,a=this.getBoundingClientRect().width,s=this.calculateMasonryRowHeight(e,t,a);e.forEach(r=>{let n=r.querySelector(`.${N.item}`);if(n){r.style.removeProperty("grid-row-end");let l=parseFloat(window.getComputedStyle(r).getPropertyValue("padding-bottom")),o=Math.round((n.getBoundingClientRect().height+l)/s);r.style.setProperty("grid-row-end",`span ${o}`)}}),this.style.setProperty("grid-auto-rows",`${s}px`)}calculateMasonryRowHeight(e,t,a){let r=Math.ceil(a/t),n=e.length/r*t;return Math.ceil(n/1e4)}};customElements.define("std-masonry",A);var X=()=>navigator.userAgent.toLowerCase().indexOf("mac")!=-1?"\u2318":"Ctrl",S=class extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML=X()}};customElements.define("std-meta-key",S);var U=150,B=10,u={sticky:"std-navbar--sticky",hidden:"std-navbar--hidden",scrolled:"std-navbar--scrolled",htmlSticky:"std-has-sticky-navbar"},M=class extends HTMLElement{get sticky(){return this.getAttribute("sticky")||"scroll"}constructor(){super()}connectedCallback(){setTimeout(this.init.bind(this),0)}init(){if(["disabled"].includes(this.sticky))return;if(document.documentElement.style.setProperty("--std-navbar-height",`${Math.round(this.getBoundingClientRect().height)}px`),window.addEventListener("scroll",p(()=>{this.classList.toggle(u.scrolled,window.scrollY>U)},B)),this.sticky=="always"){this.classList.add(u.sticky),document.documentElement.classList.add(u.htmlSticky);return}let e=0;window.addEventListener("scroll",p(()=>{let{scrollY:t}=window,a=e>t;e!==t&&(a?this.classList.add(u.sticky):setTimeout(()=>{this.classList.remove(u.sticky)},200),this.classList.toggle(u.hidden,!a&&t>U),document.documentElement.classList.toggle(u.htmlSticky,a&&t>U),e=t)},B))}};customElements.define("std-navbar",M);var w={tagActive:"std-tag--active",loading:"std-loading"},C=class extends HTMLElement{constructor(){super()}connectedCallback(){f(this.init.bind(this))}init(){Array.from(this.querySelectorAll("a")).forEach(t=>{t.addEventListener("click",a=>{if(a.preventDefault(),t.classList.contains(w.tagActive)){let s=new URL(t.href);s.searchParams.delete("filter"),this.replace(s.toString()),t.classList.remove(w.tagActive);return}this.replace(t.href),this.querySelector(`.${w.tagActive}`)?.classList.remove(w.tagActive),t.classList.add(w.tagActive)})})}replace(e){let t=this.getAttribute("target"),a=document.getElementById(t);y(e,a,`#${t}`)}};customElements.define("std-pagelist-filters",C);var x={input:"std-search",results:"std-results"},d={trigger:"std-navbar__icon",tooltip:{trigger:"std-tooltip",content:"std-tooltip__content"},search:"std-search",dialog:{dialog:"std-search-dialog",loading:"std-search-dialog--loading"},form:"std-search-form",input:"std-search-input",icon:"std-search-icon",results:"std-search-results",result:{result:"std-search-result",empty:"std-search-result--empty",selected:"std-search-result--selected",title:"std-search-result__title",context:"std-search-result__context"}},G=()=>Math.floor((window.innerHeight-200)/135),Q="title, url, :searchContext, +main, +hero",j=class extends HTMLElement{api;context;selectedIndex=0;constructor(){super()}connectedCallback(){this.classList.add(d.search),this.api=this.getAttribute("src")||"",this.context=this.getAttribute("context")||"",this.render()}render(){let e=m("span",[d.trigger,d.tooltip.trigger],{role:"button",tabindex:"0"},this,`<i class="std-icon-search"></i><span class="${d.tooltip.content}"><std-meta-key></std-meta-key>K</span>`),t=m("dialog",[d.dialog.dialog],{closedby:"any"},document.body),a=m("div",[d.form],{},t);m("label",[],{for:x.input},a,"Search");let s=m("input",[d.input],{type:"text",id:x.input,role:"combobox","aria-haspopup":"listbox","aria-controls":x.results,autocomplete:"off"},a);m("span",[d.icon],{},a,'<i class="std-icon-search"></i>');let r=m("div",[d.results],{role:"listbox",id:x.results},t),n=p(this.getResults.bind(this,s,r,t));s.addEventListener("input",n),window.addEventListener("resize",n),n(),this.initKeyHandlers(t,r,s),r.addEventListener("mouseover",o=>{let c=o.target;c.matches(`.${d.result.result}`)||(c=c.closest(`.${d.result.result}`)),this.selectedIndex=Array.from(r.children).indexOf(c),this.updateSelected(r,s)});let l=()=>{t.showModal(),s.focus()};e.addEventListener("click",l),e.addEventListener("keydown",o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),l())}),t.addEventListener("click",o=>{o.target===t&&t.close()}),window.addEventListener("keydown",o=>{(o.ctrlKey||o.metaKey)&&o.key==="k"&&(o.preventDefault(),l())})}async requestApi(e=[]){let t=new URLSearchParams;t.append("shorten","250"),t.append("limit",G().toString()),t.append("fields",Q),e.forEach(r=>{t.append(r.key,r.value)});let a=await fetch(`${this.api}?${t.toString()}`),{data:s}=await a.json();return Object.values(s)??[]}async getDefaultResults(){let e=await this.requestApi([{key:"type",value:"related"},{key:"context",value:this.context}]);return e.length?e:await this.requestApi()}async getResults(e,t,a){a.classList.add(d.dialog.loading);let s=`<span class="${d.result.result} ${d.result.empty}"><i class="std-icon-empty"></i></span>`,r=e.value.replace(/[^\w\s]+/g," ").trim(),n=r.length<2?await this.getDefaultResults():await this.requestApi([{key:"search",value:r}]);a.classList.remove(d.dialog.loading),t.innerHTML=n.reduce((l,o,c)=>{let h=o[":searchContext"]||o["+hero"]||o["+main"];return l+=`<a id="std-result-${c}" href="${o.url}" class="${d.result.result}" role="link"><span class="${d.result.title}"> ${o.title}</span>${h?`<span class="${d.result.context}">${h}</span>`:""}</a>`,l},"")||s,this.selectedIndex=0,this.updateSelected(t,e)}initKeyHandlers(e,t,a){e.addEventListener("keydown",s=>{let r=t.children.length;switch(s.key){case"ArrowUp":s.preventDefault(),this.selectedIndex=this.selectedIndex>0?this.selectedIndex-1:r-1;break;case"ArrowDown":s.preventDefault(),this.selectedIndex=this.selectedIndex<r-1?this.selectedIndex+1:0;break;case"Enter":window.location.href=t.children[this.selectedIndex]?.href??"";break}this.updateSelected(t,a)})}updateSelected(e,t){let a=e.children[this.selectedIndex];t.setAttribute("aria-activedescendant",`std-result-${this.selectedIndex+1}`),Array.from(e.querySelectorAll(`.${d.result.selected}`)).forEach(s=>{s.classList.remove(d.result.selected)}),a?.classList.add(d.result.selected)}};customElements.define("std-search",j);var V="std-theme",R="std-no-transition",$=()=>{let i=localStorage.getItem(V);return i||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")},T=class extends HTMLElement{constructor(){super()}toggleTheme(){let t=$()==="light"?"dark":"light";localStorage.setItem(V,t),this.applyTheme(t)}applyTheme(e){document.documentElement.classList.add(R),document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(e),this.innerHTML=e==="light"?'<i class="std-icon-dark"></i>':'<i class="std-icon-light"></i>',setTimeout(()=>{document.documentElement.classList.remove(R)},0)}connectedCallback(){this.applyTheme($()),this.addEventListener("click",this.toggleTheme.bind(this))}};customElements.define("std-theme-switcher",T);var I=()=>{let i=document.documentElement;i.classList.toggle("std-has-scrollbar",i.clientWidth<window.innerWidth)};document.addEventListener("DOMContentLoaded",I);window.addEventListener("resize",I);window.addEventListener("load",I);
